"use strict";(self.webpackChunkbiademo=self.webpackChunkbiademo||[]).push([[45],{21045:function(e,t,s){s.r(t),s.d(t,{PlaneModule:function(){return Ze}});var a=s(2694),n=s(86710),i=s(91601),l=s(25917),o=s(92996),r=s(43190),c=s(88002),p=s(5304),h=s(94612),d=s(57057);const u=(0,n.PH)("[Planes SignalR] Load all by post",(0,n.Ky)()),g=(0,n.PH)("[Planes SignalR] Load",(0,n.Ky)()),f=(0,n.PH)("[Planes SignalR] Create",(0,n.Ky)()),b=(0,n.PH)("[Planes SignalR] Update",(0,n.Ky)()),m=(0,n.PH)("[Planes SignalR] Remove",(0,n.Ky)()),v=(0,n.PH)("[Planes SignalR] Multi Remove",(0,n.Ky)()),y=(0,n.PH)("[Planes SignalR] Load all by post success",(0,n.Ky)()),S=(0,n.PH)("[Planes SignalR] Load success",(0,n.Ky)()),C=(0,n.PH)("[Planes SignalR] Failure",(0,n.Ky)()),w=(0,n.PH)("[Planes SignalR] Open dialog edit"),P=(0,n.PH)("[Planes SignalR] Close dialog edit"),A=(0,n.PH)("[Planes SignalR] Open dialog new"),L=(0,n.PH)("[Planes SignalR] Close dialog new");var Z=s(74147),D=s(37716);let x=(()=>{class e extends Z.Z{constructor(e){super(e,"Planes")}}return e.\u0275fac=function(t){return new(t||e)(D.LFG(D.zs3))},e.\u0275prov=D.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const O=(0,s(80273).H)({selectId:e=>e.id,sortComparer:!1}),T=O.getInitialState({totalCount:0,currentPlane:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1,displayEditDialog:!1,displayNewDialog:!1}),j=(0,n.Lq)(T,(0,n.on)(A,e=>Object.assign(Object.assign({},e),{displayNewDialog:!0})),(0,n.on)(L,e=>Object.assign(Object.assign({},e),{displayNewDialog:!1})),(0,n.on)(w,e=>Object.assign(Object.assign({},e),{displayEditDialog:!0})),(0,n.on)(P,e=>Object.assign(Object.assign({},e),{displayEditDialog:!1})),(0,n.on)(u,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!0})),(0,n.on)(g,e=>Object.assign(Object.assign({},e),{loadingGet:!0})),(0,n.on)(y,(e,{result:t,event:s})=>{const a=O.setAll(t.data,e);return a.totalCount=t.totalCount,a.lastLazyLoadEvent=s,a.loadingGetAll=!1,a}),(0,n.on)(S,(e,{plane:t})=>Object.assign(Object.assign({},e),{currentPlane:t,loadingGet:!1})),(0,n.on)(C,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!1,loadingGet:!1})));function M(e,t){return(0,n.UY)({planes:j})(e,t)}const z=(0,n.ZF)("planes-signalr"),E=(0,n.P1)(z,e=>e.planes),G=(0,n.P1)(E,e=>e.totalCount),F=(0,n.P1)(E,e=>e.currentPlane),R=(0,n.P1)(E,e=>e.lastLazyLoadEvent),$=(0,n.P1)(E,e=>e.loadingGet),q=(0,n.P1)(E,e=>e.loadingGetAll),J=(0,n.P1)(E,e=>e.displayEditDialog),U=(0,n.P1)(E,e=>e.displayNewDialog),{selectAll:H}=O.getSelectors(E);var _=s(82762),K=s(42);let N=(()=>{class e{constructor(e,t,s,a){this.actions$=e,this.planeDas=t,this.biaMessageService=s,this.store=a,this.loadAllByPost$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(u),(0,o.j)("event"),(0,r.w)(e=>this.planeDas.getListByPost(e).pipe((0,c.U)(t=>y({result:t,event:e})),(0,p.K)(e=>(this.biaMessageService.showError(),(0,l.of)(C({error:e})))))))),this.load$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(g),(0,o.j)("id"),(0,r.w)(e=>this.planeDas.get(e).pipe((0,c.U)(e=>S({plane:e})),(0,p.K)(e=>(this.biaMessageService.showError(),(0,l.of)(C({error:e})))))))),this.create$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(f),(0,o.j)("plane"),(0,h.b)(e=>(0,l.of)(e).pipe((0,d.M)(this.store.select(R)))),(0,r.w)(([e,t])=>this.planeDas.post(e).pipe((0,c.U)(()=>(this.biaMessageService.showAddSuccess(),(0,_.b)())),(0,p.K)(e=>(this.biaMessageService.showError(),(0,l.of)(C({error:e})))))))),this.update$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(b),(0,o.j)("plane"),(0,h.b)(e=>(0,l.of)(e).pipe((0,d.M)(this.store.select(R)))),(0,r.w)(([e,t])=>this.planeDas.put(e,e.id).pipe((0,c.U)(()=>(this.biaMessageService.showUpdateSuccess(),(0,_.b)())),(0,p.K)(e=>(this.biaMessageService.showError(),(0,l.of)(C({error:e})))))))),this.destroy$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(m),(0,o.j)("id"),(0,h.b)(e=>(0,l.of)(e).pipe((0,d.M)(this.store.select(R)))),(0,r.w)(([e,t])=>this.planeDas.delete(e).pipe((0,c.U)(()=>(this.biaMessageService.showDeleteSuccess(),(0,_.b)())),(0,p.K)(e=>(this.biaMessageService.showError(),(0,l.of)(C({error:e})))))))),this.multiDestroy$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(v),(0,o.j)("ids"),(0,h.b)(e=>(0,l.of)(e).pipe((0,d.M)(this.store.select(R)))),(0,r.w)(([e,t])=>this.planeDas.deletes(e).pipe((0,c.U)(()=>(this.biaMessageService.showDeleteSuccess(),(0,_.b)())),(0,p.K)(e=>(this.biaMessageService.showError(),(0,l.of)(C({error:e}))))))))}}return e.\u0275fac=function(t){return new(t||e)(D.LFG(i.eX),D.LFG(x),D.LFG(K.X),D.LFG(n.yh))},e.\u0275prov=D.Yz7({token:e,factory:e.\u0275fac}),e})();var V=s(88385),Y=s(79090),k=s(40136),Q=s(8340),I=s(49457),B=s(38042),W=s(29206),X=s(28049),ee=s(59142);let te=(()=>{class e{constructor(e,t,s){this.store=e,this.signalRService=t,this.authService=s}initialize(){console.log("%c [PlanesSignalR] Register SignalR : refresh-planes","color: purple; font-weight: bold"),this.signalRService.addMethod("refresh-planes",()=>{this.store.select(R).pipe((0,X.P)()).subscribe(e=>{console.log("%c [PlanesSignalR] RefreshSuccess","color: green; font-weight: bold"),this.store.dispatch(u({event:e}))})}),this.targetedFeature={parentKey:this.authService.getAdditionalInfos().userData.currentSiteId.toString(),featureName:"planes"},this.signalRService.joinGroup(this.targetedFeature)}destroy(){console.log("%c [PlanesSignalR] Unregister refresh-planes","color: purple; font-weight: bold"),this.signalRService.removeMethod("refresh-planes"),this.signalRService.leaveGroup(this.targetedFeature)}}return e.\u0275fac=function(t){return new(t||e)(D.LFG(n.yh),D.LFG(ee.Y),D.LFG(Q.e))},e.\u0275prov=D.Yz7({token:e,factory:e.\u0275fac}),e})();var se=s(81780),ae=s(35618),ne=s(81606),ie=s(76743),le=s(75319),oe=s(45121),re=s(33013),ce=s(3679),pe=s(13928),he=s(4207);let de=(()=>{class e{constructor(e){this.formBuilder=e,this.plane={},this.save=new D.vpe,this.cancel=new D.vpe,this.initForm()}ngOnChanges(e){e.plane&&(this.form.reset(),this.plane&&this.form.patchValue(Object.assign({},this.plane)))}initForm(){this.form=this.formBuilder.group({id:[this.plane.id],msn:[this.plane.msn,ce.kI.required]})}onCancel(){this.form.reset(),this.cancel.next()}onSubmit(){if(this.form.valid){const e=this.form.value;e.id=e.id>0?e.id:0,e.isActive=!!e.isActive&&e.isActive,this.save.emit(e),this.form.reset()}}}return e.\u0275fac=function(t){return new(t||e)(D.Y36(ce.qu))},e.\u0275cmp=D.Xpm({type:e,selectors:[["app-plane-form"]],inputs:{plane:"plane"},outputs:{save:"save",cancel:"cancel"},features:[D.TTD],decls:15,vars:11,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["formControlName","msn","type","text","pInputText","","maxlength","64"],[1,"bia-star-mandatory"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-outlined",3,"label","click"]],template:function(e,t){1&e&&(D.TgZ(0,"form",0),D.NdJ("submit",function(){return t.onSubmit()}),D.TgZ(1,"div",1),D.TgZ(2,"div",2),D.TgZ(3,"span",3),D._UZ(4,"input",4),D.TgZ(5,"label"),D.TgZ(6,"span",5),D._uU(7,"*"),D.qZA(),D._uU(8),D.ALo(9,"translate"),D.qZA(),D.qZA(),D.qZA(),D.qZA(),D.TgZ(10,"div",6),D._UZ(11,"button",7),D.ALo(12,"translate"),D.TgZ(13,"button",8),D.NdJ("click",function(){return t.onCancel()}),D.ALo(14,"translate"),D.qZA(),D.qZA(),D.qZA()),2&e&&(D.Q6J("formGroup",t.form),D.xp6(8),D.Oqu(D.lcZ(9,5,"plane.msn")),D.xp6(3),D.s9C("label",D.lcZ(12,7,"bia.save")),D.Q6J("disabled",!t.form.valid),D.xp6(2),D.s9C("label",D.lcZ(14,9,"bia.cancel")))},directives:[ce._Y,ce.JL,ae.xw,ce.sg,ae.Wh,ae.yH,ce.Fj,ce.JJ,ce.u,pe.o,ce.nD,ae.SQ,he.Hq],pipes:[se.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}"],changeDetection:0}),e})();var ue=s(38583),ge=s(79373);function fe(e,t){1&e&&D._UZ(0,"bia-spinner",3),2&e&&D.Q6J("overlay",!0)}const be=function(){return{minWidth:"50vw"}},me=function(){return{overflow:"auto"}};let ve=(()=>{class e{constructor(e){this.store=e,this.display=!1,this.sub=new le.w,this.displayChange=new D.vpe}ngOnInit(){this.loading$=this.store.select($),this.plane$=this.store.select(F),this.sub.add(this.store.select(J).subscribe(e=>this.display=e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(e){this.store.dispatch(b({plane:e})),this.close()}onCancelled(){this.close()}close(){this.store.dispatch(P())}}return e.\u0275fac=function(t){return new(t||e)(D.Y36(n.yh))},e.\u0275cmp=D.Xpm({type:e,selectors:[["app-plane-edit-dialog"]],outputs:{displayChange:"displayChange"},decls:8,vars:20,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"plane","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(e,t){1&e&&(D.TgZ(0,"p-dialog",0),D.NdJ("visibleChange",function(e){return t.display=e}),D.TgZ(1,"p-header"),D._uU(2),D.ALo(3,"translate"),D.qZA(),D.TgZ(4,"app-plane-form",1),D.NdJ("cancel",function(){return t.onCancelled()})("save",function(e){return t.onSubmitted(e)}),D.ALo(5,"async"),D.qZA(),D.YNc(6,fe,1,1,"bia-spinner",2),D.ALo(7,"async"),D.qZA()),2&e&&(D.Akn(D.DdM(18,be)),D.Q6J("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",D.DdM(19,me)),D.xp6(2),D.hij(" ",D.lcZ(3,12,"plane.edit")," "),D.xp6(2),D.Q6J("plane",D.lcZ(5,14,t.plane$)),D.xp6(2),D.Q6J("ngIf",D.lcZ(7,16,t.loading$)))},directives:[oe.V,re.h4,de,ue.O5,ge.O],pipes:[se.X$,ue.Ov],styles:[""]}),e})();const ye=function(){return{minWidth:"50vw"}},Se=function(){return{overflow:"auto"}};let Ce=(()=>{class e{constructor(e){this.store=e,this.display=!1,this.sub=new le.w,this.displayChange=new D.vpe}ngOnInit(){this.sub.add(this.store.select(U).subscribe(e=>this.display=e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(e){this.store.dispatch(f({plane:e})),this.close()}onCancelled(){this.plane={},this.close()}close(){this.store.dispatch(L())}}return e.\u0275fac=function(t){return new(t||e)(D.Y36(n.yh))},e.\u0275cmp=D.Xpm({type:e,selectors:[["app-plane-new-dialog"]],outputs:{displayChange:"displayChange"},decls:5,vars:15,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"plane","cancel","save"]],template:function(e,t){1&e&&(D.TgZ(0,"p-dialog",0),D.NdJ("visibleChange",function(e){return t.display=e}),D.TgZ(1,"p-header"),D._uU(2),D.ALo(3,"translate"),D.qZA(),D.TgZ(4,"app-plane-form",1),D.NdJ("cancel",function(){return t.onCancelled()})("save",function(e){return t.onSubmitted(e)}),D.qZA(),D.qZA()),2&e&&(D.Akn(D.DdM(13,ye)),D.Q6J("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",D.DdM(14,Se)),D.xp6(2),D.hij(" ",D.lcZ(3,11,"plane.add")," "),D.xp6(2),D.Q6J("plane",t.plane))},directives:[oe.V,re.h4,de],pipes:[se.X$],styles:[""]}),e})(),we=(()=>{class e{constructor(e,t,s,a,n,i){this.store=e,this.authService=t,this.planeDas=s,this.translateService=a,this.biaTranslationService=n,this.planesSignalRService=i,this.flex=!0,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=k.L8,this.pageSize=this.defaultPageSize,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.planesSignalRService.initialize()}ngOnInit(){this.initTableConfiguration(),this.setPermissions(),this.planes$=this.store.select(H),this.totalCount$=this.store.select(G),this.loading$=this.store.select(q)}ngOnDestroy(){this.planesSignalRService.destroy()}onCreate(){this.store.dispatch(A())}onEdit(e){this.store.dispatch(g({id:e})),this.store.dispatch(w())}onDelete(){this.selectedPlanes&&this.store.dispatch(v({ids:this.selectedPlanes.map(e=>e.id)}))}onSelectedElementsChanged(e){this.selectedPlanes=e}onPageSizeChange(e){this.pageSize=e}onLoadLazy(e){this.store.dispatch(u({event:e}))}searchGlobalChanged(e){this.globalSearchValue=e}displayedColumnsChanged(e){this.displayedColumns=e}onToggleSearch(){this.showColSearch=!this.showColSearch}onViewChange(e){this.viewPreference=e}onExportCSV(){const e={};this.columns.map(t=>e[t.value.split(".")[1]]=this.translateService.instant(t.value));const t=Object.assign({columns:e},this.planeListComponent.getLazyLoadMetadata());this.planeDas.getFile(t).subscribe(e=>{I.saveAs(e,this.translateService.instant("app.planes")+".csv")})}setPermissions(){this.canEdit=this.authService.hasPermission(W.y.Plane_Update),this.canDelete=this.authService.hasPermission(W.y.Plane_Delete),this.canAdd=this.authService.hasPermission(W.y.Plane_Create)}initTableConfiguration(){this.biaTranslationService.currentCultureDateFormat$.subscribe(e=>{this.tableConfiguration={columns:[new Y.ML("msn","plane.msn"),Object.assign(new Y.ML("isActive","plane.isActive"),{isSearchable:!1,isSortable:!1,type:Y.d5.Boolean}),Object.assign(new Y.ML("firstFlightDate","plane.firstFlightDate"),{type:Y.d5.Date,formatDate:e.dateFormat}),Object.assign(new Y.ML("firstFlightTime","plane.firstFlightTime"),{isSearchable:!1,isSortable:!1,type:Y.d5.Date,formatDate:e.timeFormat}),Object.assign(new Y.ML("lastFlightDate","plane.lastFlightDate"),{type:Y.d5.Date,formatDate:e.dateTimeFormat}),Object.assign(new Y.ML("capacity","plane.capacity"),{type:Y.d5.Number,filterMode:Y.ZF.Equals})]},this.columns=this.tableConfiguration.columns.map(e=>({key:e.field,value:e.header})),this.displayedColumns=[...this.columns]})}}return e.\u0275fac=function(t){return new(t||e)(D.Y36(n.yh),D.Y36(Q.e),D.Y36(x),D.Y36(se.sK),D.Y36(B.P6),D.Y36(te))},e.\u0275cmp=D.Xpm({type:e,selectors:[["app-planes-index"]],viewQuery:function(e,t){if(1&e&&D.Gf(V.$,5),2&e){let e;D.iGM(e=D.CRH())&&(t.planeListComponent=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&D.ekj("bia-flex",t.flex)},decls:12,vars:29,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canExportCSV","selectedElements","create","exportCSV","delete"],[3,"defaultPageSize","length","columns","columnToDisplays","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canSelectElement","loading","viewPreference","edit","loadLazy","selectedElementsChanged"]],template:function(e,t){1&e&&(D.TgZ(0,"div",0),D.TgZ(1,"div",1),D.TgZ(2,"bia-table-header",2),D.NdJ("create",function(){return t.onCreate()})("exportCSV",function(){return t.onExportCSV()})("delete",function(){return t.onDelete()}),D.ALo(3,"translate"),D.qZA(),D.TgZ(4,"bia-table-controller",3),D.NdJ("displayedColumnsChange",function(e){return t.displayedColumnsChanged(e)})("filter",function(e){return t.searchGlobalChanged(e)})("pageSizeChange",function(e){return t.onPageSizeChange(e)})("toggleSearch",function(){return t.onToggleSearch()})("viewChange",function(e){return t.onViewChange(e)}),D.ALo(5,"async"),D.qZA(),D.TgZ(6,"bia-table",4),D.NdJ("edit",function(e){return t.onEdit(e)})("loadLazy",function(e){return t.onLoadLazy(e)})("selectedElementsChanged",function(e){return t.onSelectedElementsChanged(e)}),D.ALo(7,"async"),D.ALo(8,"async"),D.ALo(9,"async"),D.qZA(),D.qZA(),D.qZA(),D._UZ(10,"app-plane-edit-dialog"),D._UZ(11,"app-plane-new-dialog")),2&e&&(D.xp6(2),D.Q6J("headerTitle",D.lcZ(3,19,"plane.listOf"))("canAdd",t.canAdd)("canExportCSV",!0)("selectedElements",t.selectedPlanes),D.xp6(2),D.Q6J("defaultPageSize",t.defaultPageSize)("length",D.lcZ(5,21,t.totalCount$))("columns",t.columns)("columnToDisplays",t.displayedColumns),D.xp6(2),D.Q6J("elements",D.lcZ(7,23,t.planes$))("totalRecord",D.lcZ(8,25,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canEdit)("canSelectElement",t.canDelete)("loading",D.lcZ(9,27,t.loading$))("viewPreference",t.viewPreference))},directives:[ae.xw,ae.yH,ne.l,ie.B,V.$,ve,Ce],pipes:[se.X$,ue.Ov],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),e})();var Pe=s(84594),Ae=s(16249);const Le=[{path:"",data:{breadcrumb:null,permission:W.y.Plane_List_Access},component:we,canActivate:[Ae.n]},{path:"**",redirectTo:""}];let Ze=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=D.oAB({type:e}),e.\u0275inj=D.cJS({providers:[te],imports:[[Pe.m,a.Bz.forChild(Le),n.Aw.forFeature("planes-signalr",M),i.sQ.forFeature([N])]]}),e})()}}]);
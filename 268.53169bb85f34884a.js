(self.webpackChunkBIADemo=self.webpackChunkBIADemo||[]).push([[268],{6249:(E,S,n)=>{"use strict";n.d(S,{n:()=>C});var h=n(1564),s=n(2340),f=n(2994),g=n(5e3);let C=(()=>{class y{constructor(T){this.authService=T}canActivate(T,L){return this.authService.hasPermissionObs(T.data.permission).pipe((0,f.b)(c=>{!0!==c&&(window.location.href=s.N.urlErrorPage+"?num=403")}))}}return y.\u0275fac=function(T){return new(T||y)(g.LFG(h.e))},y.\u0275prov=g.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},2762:(E,S,n)=>{"use strict";n.d(S,{b:()=>s});const s=(0,n(5094).PH)("[Bia] Success the refresh of the list will be done by signalR.")},2566:(E,S,n)=>{"use strict";n.d(S,{p:()=>M});var h=n(6517),s=n(5094),f=n(5424),g=n(1086),C=n(373),y=n(7545),m=n(4850),T=n(7221),L=n(4147),p=n(5e3);let c=(()=>{class v extends L.Z{constructor(x){super(x,"Roles")}}return v.\u0275fac=function(x){return new(x||v)(p.LFG(p.zs3))},v.\u0275prov=p.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})();var A=n(6875),t=n(42);let b=(()=>{class v{constructor(x,G,F){this.actions$=x,this.roleDas=G,this.biaMessageService=F,this.loadAll$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(A.E.loadAll),(0,C.j)("teamTypeId"),(0,y.w)(q=>this.roleDas.getList({endpoint:"allOptions?teamTypeId="+q}).pipe((0,m.U)(Z=>A.E.loadAllSuccess({roles:null==Z?void 0:Z.sort((tt,z)=>tt.display.localeCompare(z.display))})),(0,T.K)(Z=>(this.biaMessageService.showError(),(0,g.of)(A.E.failure({error:Z}))))))))}}return v.\u0275fac=function(x){return new(x||v)(p.LFG(h.eX),p.LFG(c),p.LFG(t.X))},v.\u0275prov=p.Yz7({token:v,factory:v.\u0275fac}),v})(),M=(()=>{class v{}return v.\u0275fac=function(x){return new(x||v)},v.\u0275mod=p.oAB({type:v}),v.\u0275inj=p.cJS({providers:[],imports:[[s.Aw.forFeature("domain-role-options",f.ll),h.sQ.forFeature([b])]]}),v})()},5424:(E,S,n)=>{"use strict";n.d(S,{wA:()=>c,ll:()=>T});var h=n(5685),s=n(5094),f=n(6875);const g=(0,h.H)({selectId:t=>t.id,sortComparer:!1}),C=g.getInitialState({}),y=(0,s.Lq)(C,(0,s.on)(f.E.loadAllSuccess,(t,{roles:b})=>g.setAll(b,t)));function T(t,b){return(0,s.UY)({roleOptions:y})(t,b)}const L=(0,s.ZF)("domain-role-options"),p=(0,s.P1)(L,t=>t.roleOptions),{selectAll:c}=g.getSelectors(p)},6875:(E,S,n)=>{"use strict";n.d(S,{E:()=>s});var s,f,h=n(5094);(f=s||(s={})).loadAll=(0,h.PH)("[Domain Role Options] Load all",(0,h.Ky)()),f.loadAllSuccess=(0,h.PH)("[Domain Role Options] Load all success",(0,h.Ky)()),f.failure=(0,h.PH)("[Domain Role Options] Failure",(0,h.Ky)())},3268:(E,S,n)=>{"use strict";n.r(S),n.d(S,{NotificationModule:()=>Je});var c,e,h=n(4490),s=n(5094),f=n(6517),g=n(1086),C=n(373),y=n(7545),m=n(4850),T=n(7221),L=n(1406),p=n(7168);(e=c||(c={})).loadAllByPost=(0,s.PH)("[Notifications] Load all by post",(0,s.Ky)()),e.load=(0,s.PH)("[Notifications] Load",(0,s.Ky)()),e.setUnread=(0,s.PH)("[Notifications] Set Unread",(0,s.Ky)()),e.create=(0,s.PH)("[Notifications] Create",(0,s.Ky)()),e.update=(0,s.PH)("[Notifications] Update",(0,s.Ky)()),e.remove=(0,s.PH)("[Notifications] Remove",(0,s.Ky)()),e.multiRemove=(0,s.PH)("[Notifications] Multi Remove",(0,s.Ky)()),e.loadAllByPostSuccess=(0,s.PH)("[Notifications] Load all by post success",(0,s.Ky)()),e.loadSuccess=(0,s.PH)("[Notifications] Load success",(0,s.Ky)()),e.failure=(0,s.PH)("[Notifications] Failure",(0,s.Ky)());var A=n(4147),t=n(5e3);let b=(()=>{class e extends A.Z{constructor(i){super(i,"Notifications")}setUnread(i){return this.get({endpoint:"setUnread",id:i})}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(t.zs3))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var M=n(5685);const v=(0,M.H)({selectId:e=>e.id,sortComparer:!1}),I=v.getInitialState({totalCount:0,currentNotification:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1}),x=(0,s.Lq)(I,(0,s.on)(c.loadAllByPost,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!0})),(0,s.on)(c.load,e=>Object.assign(Object.assign({},e),{loadingGet:!0})),(0,s.on)(c.loadAllByPostSuccess,(e,{result:r,event:i})=>{const o=v.setAll(r.data,e);return o.totalCount=r.totalCount,o.lastLazyLoadEvent=i,o.loadingGetAll=!1,o}),(0,s.on)(c.loadSuccess,(e,{notification:r})=>(r.data=JSON.parse(r.jData),Object.assign(Object.assign({},e),{currentNotification:r,loadingGet:!1}))),(0,s.on)(c.failure,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!1,loadingGet:!1})));function F(e,r){return(0,s.UY)({notifications:x})(e,r)}const q=(0,s.ZF)("notifications"),Z=(0,s.P1)(q,e=>e.notifications),tt=(0,s.P1)(Z,e=>e.totalCount),z=(0,s.P1)(Z,e=>e.currentNotification),Y=(0,s.P1)(Z,e=>e.lastLazyLoadEvent),Ct=(0,s.P1)(Z,e=>e.loadingGet),_t=(0,s.P1)(Z,e=>e.loadingGetAll),{selectAll:Nt}=v.getSelectors(Z);var Q=n(2762),W=n(42);let et=(()=>{class e{constructor(i,o,a,l){this.actions$=i,this.notificationDas=o,this.biaMessageService=a,this.store=l,this.loadAllByPost$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.loadAllByPost),(0,C.j)("event"),(0,y.w)(d=>this.notificationDas.getListItemsByPost({event:d}).pipe((0,m.U)(u=>c.loadAllByPostSuccess({result:u,event:d})),(0,T.K)(u=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:u})))))))),this.load$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.load),(0,C.j)("id"),(0,y.w)(d=>this.notificationDas.get({id:d}).pipe((0,m.U)(u=>c.loadSuccess({notification:u})),(0,T.K)(u=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:u})))))))),this.setUnread$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.setUnread),(0,C.j)("id"),(0,y.w)(d=>this.notificationDas.setUnread(d).pipe((0,m.U)(u=>c.loadSuccess({notification:u})),(0,T.K)(u=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:u})))))))),this.create$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.create),(0,C.j)("notification"),(0,L.b)(d=>(0,g.of)(d).pipe((0,p.M)(this.store.select(Y)))),(0,y.w)(([d,u])=>this.notificationDas.post({item:d}).pipe((0,m.U)(()=>(this.biaMessageService.showAddSuccess(),e.useSignalR?(0,Q.b)():c.loadAllByPost({event:u}))),(0,T.K)(N=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:N})))))))),this.update$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.update),(0,C.j)("notification"),(0,L.b)(d=>(0,g.of)(d).pipe((0,p.M)(this.store.select(Y)))),(0,y.w)(([d,u])=>this.notificationDas.put({item:d,id:d.id}).pipe((0,m.U)(()=>(this.biaMessageService.showUpdateSuccess(),e.useSignalR?(0,Q.b)():c.loadAllByPost({event:u}))),(0,T.K)(N=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:N})))))))),this.destroy$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.remove),(0,C.j)("id"),(0,L.b)(d=>(0,g.of)(d).pipe((0,p.M)(this.store.select(Y)))),(0,y.w)(([d,u])=>this.notificationDas.delete({id:d}).pipe((0,m.U)(()=>(this.biaMessageService.showDeleteSuccess(),e.useSignalR?(0,Q.b)():c.loadAllByPost({event:u}))),(0,T.K)(N=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:N})))))))),this.multiDestroy$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(c.multiRemove),(0,C.j)("ids"),(0,L.b)(d=>(0,g.of)(d).pipe((0,p.M)(this.store.select(Y)))),(0,y.w)(([d,u])=>this.notificationDas.deletes({ids:d}).pipe((0,m.U)(()=>(this.biaMessageService.showDeleteSuccess(),e.useSignalR?(0,Q.b)():c.loadAllByPost({event:u}))),(0,T.K)(N=>(this.biaMessageService.showError(),(0,g.of)(c.failure({error:N}))))))))}}return e.useSignalR=!1,e.\u0275fac=function(i){return new(i||e)(t.LFG(f.eX),t.LFG(b),t.LFG(W.X),t.LFG(s.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var R=n(2654),ht=n(8385),_=n(9157),it=n(136),ot=n(1564),Lt=n(9441),k=n(8042),P=n(9206),nt=n(7224),xt=n(7145),Zt=n(8928);let It=(()=>{class e{constructor(i,o,a){this.store=i,this.signalRService=o,this.authService=a}initialize(){this.store.select(Zt.qX).subscribe(i=>{this.myTeams=i}),console.log("%c [Notifications] Register SignalR : refresh-notification","color: purple; font-weight: bold"),this.signalRService.addMethod("refresh-notification",i=>{const o=JSON.parse(i);this.IsInMyDisplay(o)&&this.store.select(Y).pipe((0,nt.P)()).subscribe(a=>{console.log("%c [Notifications] RefreshSuccess","color: green; font-weight: bold"),this.store.dispatch(c.loadAllByPost({event:a}))})}),this.signalRService.addMethod("refresh-notifications-several",i=>{JSON.parse(i).some(a=>this.IsInMyDisplay(a))&&this.store.select(Y).pipe((0,nt.P)()).subscribe(a=>{console.log("%c [Notifications] RefreshSuccess","color: green; font-weight: bold"),this.store.dispatch(c.loadAllByPost({event:a}))})}),this.targetedFeature={featureName:"notifications"},this.signalRService.joinGroup(this.targetedFeature)}IsInMyDisplay(i){const o=this.authService.getAdditionalInfos(),a=!i.notifiedUsers||0===i.notifiedUsers.length||i.notifiedUsers.some(d=>d.id===o.userInfo.id),l=!i.notifiedTeams||0===i.notifiedTeams.length||i.notifiedTeams.some(d=>this.myTeams.some(u=>(u.id===d.team.id||0==d.team.id)&&(!(d.roles&&d.roles.length>0)||d.roles.some(N=>u.roles.some(ft=>ft.id===N.id)))));return a&&l}destroy(){console.log("%c [Notifications] Unregister SignalR : refresh-notification","color: purple; font-weight: bold"),this.signalRService.removeMethod("refresh-notification"),this.signalRService.removeMethod("refresh-notification"),this.signalRService.leaveGroup(this.targetedFeature)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(s.yh),t.LFG(xt.Y),t.LFG(ot.e))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var B,Dt=n(6468),wt=n(6053);!function(e){e.loadAll=(0,s.PH)("[Domain Language Options] Load all"),e.loadAllSuccess=(0,s.PH)("[Domain Language Options] Load all success",(0,s.Ky)()),e.failure=(0,s.PH)("[Domain Language Options] Failure",(0,s.Ky)())}(B||(B={}));const at=(0,M.H)({selectId:e=>e.id,sortComparer:!1}),Et=at.getInitialState({}),Ft=(0,s.Lq)(Et,(0,s.on)(B.loadAllSuccess,(e,{languages:r})=>at.setAll(r,e)));function Ut(e,r){return(0,s.UY)({languageOptions:Ft})(e,r)}const Mt=(0,s.ZF)("domain-language-options"),gt=(0,s.P1)(Mt,e=>e.languageOptions),{selectAll:Rt}=at.getSelectors(gt);var $;!function(e){e.loadAll=(0,s.PH)("[Domain Notification Type Options] Load all"),e.loadAllSuccess=(0,s.PH)("[Domain Notification Type Options] Load all success",(0,s.Ky)()),e.failure=(0,s.PH)("[Domain Notification Type Options] Failure",(0,s.Ky)())}($||($={}));const st=(0,M.H)({selectId:e=>e.id,sortComparer:!1}),Pt=st.getInitialState({}),Bt=(0,s.Lq)(Pt,(0,s.on)($.loadAllSuccess,(e,{notificationTypes:r})=>st.setAll(r,e)));function $t(e,r){return(0,s.UY)({notificationTypeOptions:Bt})(e,r)}const jt=(0,s.ZF)("domain-notification-type-options"),mt=(0,s.P1)(jt,e=>e.notificationTypeOptions),{selectAll:Gt}=st.getSelectors(mt);var Yt=n(5424),Jt=n(6875);const H="domain-team-options";var j;!function(e){e.loadAll=(0,s.PH)("["+H+"] Load all"),e.loadAllSuccess=(0,s.PH)("["+H+"] Load all success",(0,s.Ky)()),e.failure=(0,s.PH)("["+H+"] Failure",(0,s.Ky)())}(j||(j={}));const rt=(0,M.H)({selectId:e=>e.id,sortComparer:!1}),zt=rt.getInitialState({}),Ht=(0,s.Lq)(zt,(0,s.on)(j.loadAllSuccess,(e,{teams:r})=>rt.setAll(r,e)));function Kt(e,r){return(0,s.UY)({teamOptions:Ht})(e,r)}const Qt=(0,s.ZF)(H),vt=(0,s.P1)(Qt,e=>e.teamOptions),{selectAll:Wt}=rt.getSelectors(vt);var kt=n(5863),Xt=n(6048),X=n(4529);let lt=(()=>{class e{constructor(i){this.store=i,this.notificationTypeOptions$=this.store.select(Gt),this.roleOptions$=this.store.select(Yt.wA),this.userOptions$=this.store.select(kt.yp),this.languageOptions$=this.store.select(Rt),this.teamOptions$=this.store.select(Wt),this.dictOptionDtos$=(0,wt.aj)([this.notificationTypeOptions$,this.roleOptions$,this.userOptions$]).pipe((0,m.U)(o=>[new X.b("type",o[0]),new X.b("notifiedRoles",o[1]),new X.b("notifiedUsers",o[2]),new X.b("createdBy",o[2])]))}loadAllOptions(){this.store.dispatch($.loadAll()),this.store.dispatch(Jt.E.loadAll({teamTypeId:it.k0.All})),this.store.dispatch(Xt.d.loadAll()),this.store.dispatch(B.loadAll()),this.store.dispatch(j.loadAll())}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(s.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Vt=n(1307),V=n(7171),U=n(277),qt=n(1606),te=n(6743),D=n(9808);let ee=(()=>{class e{constructor(i,o,a,l,d,u,N,ft,ze){this.store=i,this.router=o,this.activatedRoute=a,this.authService=l,this.notificationDas=d,this.translateService=u,this.biaTranslationService=N,this.notificationsSignalRService=ft,this.notificationOptionsService=ze,this.useSignalR=!0,this.useView=!0,this.useRefreshAtLanguageChange=!0,this.flex=!0,this.sub=new R.w,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=it.L8,this.pageSize=this.defaultPageSize,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.tableStateKey=this.useView?"notificationsGrid":void 0}ngOnInit(){this.parentIds=[],this.sub=new R.w,this.initTableConfiguration(),this.setPermissions(),this.notifications$=this.store.select(Nt),this.totalCount$=this.store.select(tt),this.loading$=this.store.select(_t),this.OnDisplay(),this.useRefreshAtLanguageChange&&this.sub.add(this.biaTranslationService.currentCulture$.pipe((0,Vt.T)(1)).subscribe(i=>{this.onLoadLazy(this.notificationListComponent.getLazyLoadMetadata())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.OnHide()}OnDisplay(){this.useView&&this.store.dispatch((0,Dt.Tx)()),this.useSignalR&&(this.notificationsSignalRService.initialize(),et.useSignalR=!0)}OnHide(){this.useSignalR&&(et.useSignalR=!1,this.notificationsSignalRService.destroy())}onCreate(){this.router.navigate(["./create"],{relativeTo:this.activatedRoute})}onEdit(i){this.router.navigate(["./"+i+"/edit"],{relativeTo:this.activatedRoute})}onDetail(i){this.router.navigate(["./"+i+"/detail"],{relativeTo:this.activatedRoute})}onDelete(){this.selectedNotifications&&this.canDelete&&this.store.dispatch(c.multiRemove({ids:this.selectedNotifications.map(i=>i.id)}))}onSelectedElementsChanged(i){this.selectedNotifications=i}onPageSizeChange(i){this.pageSize=i}onLoadLazy(i){const o=Object.assign({parentIds:this.parentIds},i);this.store.dispatch(c.loadAllByPost({event:o}))}searchGlobalChanged(i){this.globalSearchValue=i}displayedColumnsChanged(i){this.displayedColumns=i}onToggleSearch(){this.showColSearch=!this.showColSearch}onViewChange(i){this.viewPreference=i}onExportCSV(){const i={};this.notificationListComponent.getPrimeNgTable().columns.map(a=>i[a.field]=this.translateService.instant(a.header));const o=Object.assign({parentIds:this.parentIds,columns:i},this.notificationListComponent.getLazyLoadMetadata());this.notificationDas.getFile(o).subscribe(a=>{Lt.saveAs(a,this.translateService.instant("app.notifications")+".csv")})}setPermissions(){this.canEdit=this.authService.hasPermission(P.y.Notification_Update),this.canDelete=this.authService.hasPermission(P.y.Notification_Delete),this.canAdd=this.authService.hasPermission(P.y.Notification_Create)}initTableConfiguration(){this.sub.add(this.biaTranslationService.currentCultureDateFormat$.subscribe(i=>{this.tableConfiguration={columns:[new _.kc("titleTranslated","notification.title"),new _.kc("descriptionTranslated","notification.description"),Object.assign(new _.kc("type","notification.type.title"),{type:_.d5.OneToMany}),Object.assign(new _.kc("read","notification.read"),{isSearchable:!1,type:_.d5.Boolean}),Object.assign(new _.kc("createdDate","notification.createdDate"),{type:_.d5.Date,formatDate:i.dateFormat}),Object.assign(new _.kc("createdBy","notification.createdBy"),{type:_.d5.OneToMany}),Object.assign(new _.kc("notifiedUsers","notification.notifiedUsers"),{type:_.d5.ManyToMany}),Object.assign(new _.kc("notifiedTeams","notification.notifiedTeams"),{type:_.d5.ManyToMany}),new _.kc("jData","notification.jData")]},this.columns=this.tableConfiguration.columns.map(o=>({key:o.field,value:o.header})),this.displayedColumns=[...this.columns]}))}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(s.yh),t.Y36(h.F0),t.Y36(h.gz),t.Y36(ot.e),t.Y36(b),t.Y36(V.sK),t.Y36(k.P6),t.Y36(It),t.Y36(lt))},e.\u0275cmp=t.Xpm({type:e,selectors:[["bia-notifications-index"]],viewQuery:function(i,o){if(1&i&&t.Gf(ht.$,5),2&i){let a;t.iGM(a=t.CRH())&&(o.notificationListComponent=a.first)}},hostVars:2,hostBindings:function(i,o){2&i&&t.ekj("bia-flex",o.flex)},decls:10,vars:32,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canDelete","canExportCSV","selectedElements","create","exportCSV","delete"],[3,"defaultPageSize","length","columns","columnToDisplays","tableStateKey","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"bia-table-header",2),t.NdJ("create",function(){return o.onCreate()})("exportCSV",function(){return o.onExportCSV()})("delete",function(){return o.onDelete()}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"bia-table-controller",3),t.NdJ("displayedColumnsChange",function(l){return o.displayedColumnsChanged(l)})("filter",function(l){return o.searchGlobalChanged(l)})("pageSizeChange",function(l){return o.onPageSizeChange(l)})("toggleSearch",function(){return o.onToggleSearch()})("viewChange",function(l){return o.onViewChange(l)}),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"bia-table",4),t.NdJ("clickRow",function(l){return o.onDetail(l)})("loadLazy",function(l){return o.onLoadLazy(l)})("selectedElementsChanged",function(l){return o.onSelectedElementsChanged(l)}),t.ALo(7,"async"),t.ALo(8,"async"),t.ALo(9,"async"),t.qZA()()()),2&i&&(t.xp6(2),t.Q6J("headerTitle",t.lcZ(3,22,"notification.listOf"))("canAdd",o.canAdd)("canDelete",o.canDelete)("canExportCSV",!0)("selectedElements",o.selectedNotifications),t.xp6(2),t.Q6J("defaultPageSize",o.defaultPageSize)("length",t.lcZ(5,24,o.totalCount$))("columns",o.columns)("columnToDisplays",o.displayedColumns)("tableStateKey",o.tableStateKey),t.xp6(2),t.Q6J("elements",t.lcZ(7,26,o.notifications$))("totalRecord",t.lcZ(8,28,o.totalCount$))("columnToDisplays",o.displayedColumns)("pageSize",o.pageSize)("configuration",o.tableConfiguration)("showColSearch",o.showColSearch)("globalSearchValue",o.globalSearchValue)("canClickRow",o.canEdit)("canSelectElement",o.canDelete)("loading",t.lcZ(9,30,o.loading$))("viewPreference",o.viewPreference)("tableStateKey",o.tableStateKey))},directives:[U.xw,U.yH,qt.l,te.B,ht.$],pipes:[V.X$,D.Ov],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),e})();var ie=n(6135),O=n(3075),ct=n(1466),w=n(6244),oe=n(422),yt=n(3725),ne=n(1424),bt=n(845),ae=n(9783),se=n(4036),re=n(1208),le=n(5652),ce=n(4851),de=n(4119),pe=n(6526),ue=n(3407);function fe(e,r){if(1&e){const i=t.EpF();t.ynx(0,29),t.TgZ(1,"p-tabPanel",4)(2,"div",30),t._UZ(3,"input",31),t.TgZ(4,"div",5)(5,"div",6)(6,"span",7)(7,"input",32),t.NdJ("change",function(){const l=t.CHM(i).index;return t.oxw().changeTranslation(l)}),t.qZA(),t.TgZ(8,"label")(9,"span",9),t._uU(10,"*"),t.qZA(),t._uU(11),t.ALo(12,"translate"),t.qZA()()()(),t.TgZ(13,"div",5)(14,"div",6)(15,"span",7)(16,"input",33),t.NdJ("change",function(){const l=t.CHM(i).index;return t.oxw().changeTranslation(l)}),t.qZA(),t.TgZ(17,"label")(18,"span",9),t._uU(19,"*"),t.qZA(),t._uU(20),t.ALo(21,"translate"),t.qZA()()()()(),t.TgZ(22,"div",11)(23,"button",34),t.NdJ("click",function(){const l=t.CHM(i).index;return t.oxw().removeTranslation(l)}),t.ALo(24,"translate"),t.qZA()()(),t.BQk()}if(2&e){const i=r.$implicit,o=r.index,a=t.oxw();t.xp6(1),t.Q6J("header",a.labelTranslation(i.value.languageId)),t.xp6(1),t.Q6J("formGroupName",o),t.xp6(9),t.Oqu(t.lcZ(12,5,"notification.title")),t.xp6(9),t.Oqu(t.lcZ(21,7,"notification.description")),t.xp6(3),t.s9C("label",t.lcZ(24,9,"bia.translation.delete"))}}function he(e,r){1&e&&t._UZ(0,"i",38)}const J=function(){return{width:"100%"}};function ge(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"p-tabPanel",35),t.YNc(1,he,1,0,"ng-template",20),t.TgZ(2,"div",5)(3,"div",6)(4,"span",7)(5,"p-dropdown",36),t.NdJ("onChange",function(){return t.CHM(i),t.oxw().onSelectionLanguage()}),t.qZA(),t.TgZ(6,"label")(7,"span",9),t._uU(8,"*"),t.qZA(),t._uU(9),t.ALo(10,"translate"),t.qZA()()()(),t.TgZ(11,"div",11)(12,"button",37),t.NdJ("click",function(){return t.CHM(i),t.oxw().addTranslation()}),t.ALo(13,"translate"),t.qZA()()()}if(2&e){const i=t.oxw();t.xp6(5),t.Akn(t.DdM(10,J)),t.Q6J("options",i.missingLanguageOptions),t.xp6(4),t.Oqu(t.lcZ(10,6,"bia.translation.language")),t.xp6(3),t.s9C("label",t.lcZ(13,8,"bia.translation.add")),t.Q6J("disabled",!i.selectionLanguage)}}function me(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"tr")(1,"th"),t._uU(2,"Team"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Roles"),t.qZA(),t.TgZ(5,"th")(6,"i",39),t.NdJ("click",function(){return t.CHM(i),t.oxw().addNewRow()}),t.ALo(7,"translate"),t.qZA()()()}2&e&&(t.xp6(6),t.s9C("pTooltip",t.lcZ(7,1,"bia.add")))}function ve(e,r){if(1&e){const i=t.EpF();t.ynx(0,40),t.TgZ(1,"tr",30)(2,"td")(3,"p-celleditor"),t._UZ(4,"p-dropdown",41),t.qZA()(),t.TgZ(5,"td")(6,"p-celleditor"),t._UZ(7,"p-multiSelect",42),t.qZA()(),t.TgZ(8,"td")(9,"i",43),t.NdJ("click",function(){const l=t.CHM(i).rowIndex;return t.oxw().onDeleteRow(l)}),t.ALo(10,"translate"),t.qZA()()(),t.BQk()}if(2&e){const i=r.rowIndex,o=t.oxw();t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Akn(t.DdM(12,J)),t.Q6J("options",o.teamOptions)("showClear",!0),t.xp6(3),t.Akn(t.DdM(13,J)),t.Q6J("options",o.roleOptions)("virtualScroll",!0),t.xp6(2),t.s9C("pTooltip",t.lcZ(10,10,"bia.delete"))}}const Tt=function(){return{width:"100%"}};let At=(()=>{class e{constructor(i){this.formBuilder=i,this.notification={},this.save=new t.vpe,this.cancel=new t.vpe,this.missingTranslation=!1,this.selectionLanguage=!1,this.initForm()}ngOnChanges(i){if(this.notification&&(this.form.reset(),this.notification)){this.form.patchValue(Object.assign({},this.notification));const o=new O.Oe([]);this.notification.notifiedTeams.forEach(a=>{o.push(this.formBuilder.group({team:[a.team,O.kI.required],roles:[a.roles],teamTypeId:[a.teamTypeId]}))}),this.form.setControl("notifiedTeams",o),this.notificationTranslations.clear(),this.notification.notificationTranslations&&(this.notification.notificationTranslations.forEach(a=>{this.notificationTranslations.push(this.createTranslation(a))}),this.computeMissingTranslation())}}initForm(){const i={id:[this.notification.id],title:[this.notification.title,O.kI.required],description:[this.notification.description,O.kI.required],type:[this.notification.type,O.kI.required],read:[this.notification.read],createdDate:[this.notification.createdDate,O.kI.required],createdBy:[],notifiedUsers:[this.notification.notifiedUsers],jData:[this.notification.jData],notificationTranslations:this.formBuilder.array([]),languageToAdd:[],notifiedTeams:this.formBuilder.array([])};this.form=this.formBuilder.group(i),this.notificationTranslations=this.form.get("notificationTranslations")}createNotifiedTeams(){return this.formBuilder.group({team:[null,O.kI.required],roles:[],dtoState:[w.e.Added]})}get notifiedTeams(){return this.form.get("notifiedTeams")}addNewRow(){this.notifiedTeams.push(this.createNotifiedTeams())}onDeleteRow(i){this.notifiedTeams.removeAt(i)}onSelectionLanguage(){this.selectionLanguage=!0}createTranslation(i){return this.formBuilder.group({id:i.id,dtoState:i.dtoState,languageId:i.languageId,description:[i.description,O.kI.required],title:[i.title,O.kI.required]})}addTranslation(){this.notificationTranslations.push(this.createTranslation({id:0,languageId:this.form.value.languageToAdd.id,title:"",description:"",dtoState:w.e.Added})),this.computeMissingTranslation()}addAllTranslation(){this.missingLanguageOptions.forEach(i=>this.notificationTranslations.push(this.createTranslation({id:0,languageId:i.id,title:"",description:"",dtoState:w.e.Added}))),this.computeMissingTranslation()}removeTranslation(i){this.notificationTranslations.removeAt(i),this.computeMissingTranslation()}changeTranslation(i){this.notificationTranslations.at(i).value.dtoState===w.e.Unchanged&&(this.notificationTranslations.at(i).value.dtoState=w.e.Modified),this.computeMissingTranslation()}computeMissingTranslation(){this.missingLanguageOptions=this.languageOptions.filter(i=>!this.notificationTranslations.value.find(o=>o.languageId===i.id)&&!it.Nf.find(o=>o===i.id)),this.missingTranslation=this.missingLanguageOptions.length>0}labelTranslation(i){var o;return null===(o=this.languageOptions.find(a=>a.id===i))||void 0===o?void 0:o.display}onCancel(){this.form.reset(),this.cancel.next()}onSubmit(){var i,o,a;if(this.form.valid){const l=this.form.value;l.id=l.id>0?l.id:0,l.read=!!l.read&&l.read,l.createdBy=ct.P.Clone(l.createdBy),l.notifiedUsers=ct.P.Differential(l.notifiedUsers,null===(i=this.notification)||void 0===i?void 0:i.notifiedUsers),l.type=Object.assign({},l.type),l.notificationTranslations=e.DifferentialTranslation(l.notificationTranslations,null===(o=this.notification)||void 0===o?void 0:o.notificationTranslations),l.notifiedTeams=e.DifferentialNotificationTeam(l.notifiedTeams,null===(a=this.notification)||void 0===a?void 0:a.notifiedTeams),this.save.emit(l),this.form.reset()}}lang(i){console.log(i)}static DifferentialTranslation(i,o){let a=[];if(o&&Array.isArray(o)){const l=o.filter(d=>!i||!i.map(u=>u.id).includes(d.id)).map(d=>Object.assign(Object.assign({},d),{dtoState:w.e.Deleted}));l&&(a=a.concat(l))}if(i&&Array.isArray(i)){const l=null==i?void 0:i.filter(d=>d.dtoState===w.e.Added||d.dtoState===w.e.Modified);l&&(a=a.concat(l))}return a}static DifferentialNotificationTeam(i,o){let a=[];if(o&&Array.isArray(o)){const l=o.filter(d=>!i||!i.map(u=>u.team.id).includes(d.team.id)).map(d=>Object.assign(Object.assign({},d),{dtoState:w.e.Deleted}));l&&l.length>0&&(a=a.concat(l))}if(i&&Array.isArray(i)){const l=i.filter(d=>!o||!o.map(u=>u.team.id).includes(d.team.id)).map(d=>Object.assign(Object.assign({},d),{dtoState:w.e.Added}));l&&l.length>0&&(a=a.concat(l))}if(i&&Array.isArray(i)&&o&&Array.isArray(o)){const d=i.filter(u=>o.some(N=>N.team.id==u.team.id)).map(u=>Object.assign(Object.assign({},u),{roles:ct.P.Differential(u.roles,o.filter(N=>N.team.id==u.team.id)[0].roles)})).filter(u=>u.roles.length>0).map(u=>Object.assign(Object.assign({},u),{dtoState:w.e.Modified}));d&&d.length>0&&(a=a.concat(d))}return a}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(O.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["bia-notification-form"]],inputs:{notification:"notification",teamOptions:"teamOptions",userOptions:"userOptions",roleOptions:"roleOptions",notificationTypeOptions:"notificationTypeOptions",languageOptions:"languageOptions"},outputs:{save:"save",cancel:"cancel"},features:[t.TTD],decls:87,vars:70,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center","fxFlex","100"],["fxLayout","column","fxLayoutAlign","top","fxFlex","50"],[3,"legend"],[3,"header"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["formControlName","title","type","text","pInputText","","maxlength","64",2,"width","100%"],[1,"bia-star-mandatory"],["formControlName","description","type","text","pInputText","","maxlength","256",2,"width","100%"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","button",3,"label","disabled","click"],["formArrayName","notificationTranslations",4,"ngFor","ngForOf"],["header","+",4,"ngIf"],["placeholder","\xa0","formControlName","type","optionLabel","display","datakey","id",3,"options"],["binary","true","formControlName","read",3,"label"],["biaLocale","","formControlName","createdDate","placeholder","\xa0","dateFormat","yy-mm-dd",3,"showButtonBar","inputStyle"],["fxFlex","100"],["styleClass","p-datatable-striped",3,"value","responsive"],["pTemplate","header"],["pTemplate","body"],["placeholder","\xa0","formControlName","createdBy","optionLabel","display","datakey","id",3,"options","showClear"],["defaultLabel","\xa0","formControlName","notifiedUsers","optionLabel","display","datakey","id",3,"options","virtualScroll"],["fxFlex","90"],[2,"left","5px","top","-20px","font-size","12px","color","#00839b"],["formControlName","jData","rows","5","autoResize","autoResize","pInputTextarea","",2,"width","100%",3,"cols"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-outlined",3,"label","click"],["formArrayName","notificationTranslations"],[3,"formGroupName"],["formControlName","languageId","type","hidden"],["formControlName","title","type","text","pInputText","","maxlength","64",2,"width","100%",3,"change"],["formControlName","description","type","text","pInputText","","maxlength","256",2,"width","100%",3,"change"],["pButton","","type","button",3,"label","click"],["header","+"],["placeholder","\xa0","formControlName","languageToAdd","optionLabel","display","datakey","id",3,"options","onChange"],["pButton","","type","button",1,"ui-button-secondary",3,"label","disabled","click"],[1,"pi","pi-plus"],["tooltipPosition","left",1,"pi","pi-plus","bia-mat-tiny-fab","bia-pointer",3,"pTooltip","click"],["formArrayName","notifiedTeams"],["placeholder","\xa0","formControlName","team","optionLabel","display","datakey","id",3,"options","showClear"],["defaultLabel","\xa0","formControlName","roles","optionLabel","display","datakey","id","appendTo","body",3,"options","virtualScroll"],["tooltipPosition","left",1,"pi","pi-trash","bia-mat-tiny-fab","bia-pointer",3,"pTooltip","click"]],template:function(i,o){1&i&&(t.TgZ(0,"form",0),t.NdJ("submit",function(){return o.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"p-fieldset",3),t.ALo(4,"translate"),t.TgZ(5,"p-tabView")(6,"p-tabPanel",4),t.ALo(7,"translate"),t.TgZ(8,"div",5)(9,"div",6)(10,"span",7),t._UZ(11,"input",8),t.TgZ(12,"label")(13,"span",9),t._uU(14,"*"),t.qZA(),t._uU(15),t.ALo(16,"translate"),t.qZA()()()(),t.TgZ(17,"div",5)(18,"div",6)(19,"span",7),t._UZ(20,"input",10),t.TgZ(21,"label")(22,"span",9),t._uU(23,"*"),t.qZA(),t._uU(24),t.ALo(25,"translate"),t.qZA()()()(),t.TgZ(26,"div",11)(27,"button",12),t.NdJ("click",function(){return o.addAllTranslation()}),t.ALo(28,"translate"),t.qZA()()(),t.YNc(29,fe,25,11,"ng-container",13),t.YNc(30,ge,14,11,"p-tabPanel",14),t.qZA()(),t.TgZ(31,"div",5)(32,"div",6)(33,"span",7),t._UZ(34,"p-dropdown",15),t.TgZ(35,"label")(36,"span",9),t._uU(37,"*"),t.qZA(),t._uU(38),t.ALo(39,"translate"),t.qZA()()()(),t.TgZ(40,"div",5)(41,"div",6),t._UZ(42,"p-checkbox",16),t.ALo(43,"translate"),t.qZA()(),t.TgZ(44,"div",5)(45,"div",6)(46,"span",7),t._UZ(47,"p-calendar",17),t.TgZ(48,"label")(49,"span",9),t._uU(50,"*"),t.qZA(),t._uU(51),t.ALo(52,"translate"),t.qZA()()()()(),t.TgZ(53,"div",2)(54,"div",5)(55,"div",18)(56,"p-fieldset",3),t.ALo(57,"translate"),t.TgZ(58,"p-table",19),t.YNc(59,me,8,3,"ng-template",20),t.YNc(60,ve,11,14,"ng-template",21),t.qZA()()()(),t.TgZ(61,"div",5)(62,"div",6)(63,"span",7),t._UZ(64,"p-dropdown",22),t.TgZ(65,"label"),t._uU(66),t.ALo(67,"translate"),t.qZA()()()(),t.TgZ(68,"div",5)(69,"div",6)(70,"span",7),t._UZ(71,"p-multiSelect",23),t.TgZ(72,"label"),t._uU(73),t.ALo(74,"translate"),t.qZA()()()(),t.TgZ(75,"div",5)(76,"div",24)(77,"span",25),t._uU(78),t.ALo(79,"translate"),t.qZA(),t.TgZ(80,"span",7),t._UZ(81,"textarea",26),t.qZA()()()()(),t.TgZ(82,"div",11),t._UZ(83,"button",27),t.ALo(84,"translate"),t.TgZ(85,"button",28),t.NdJ("click",function(){return o.onCancel()}),t.ALo(86,"translate"),t.qZA()()()),2&i&&(t.Q6J("formGroup",o.form),t.xp6(3),t.s9C("legend",t.lcZ(4,37,"bia.translation.translatedFields")),t.xp6(3),t.s9C("header",t.lcZ(7,39,"translation.defaultLanguage")),t.xp6(9),t.Oqu(t.lcZ(16,41,"notification.title")),t.xp6(9),t.Oqu(t.lcZ(25,43,"notification.description")),t.xp6(3),t.s9C("label",t.lcZ(28,45,"bia.translation.addAll")),t.Q6J("disabled",!o.missingTranslation),t.xp6(2),t.Q6J("ngForOf",o.notificationTranslations.controls),t.xp6(1),t.Q6J("ngIf",(null==o.missingLanguageOptions?null:o.missingLanguageOptions.length)>0),t.xp6(4),t.Akn(t.DdM(65,J)),t.Q6J("options",o.notificationTypeOptions),t.xp6(4),t.Oqu(t.lcZ(39,47,"notification.type.title")),t.xp6(4),t.s9C("label",t.lcZ(43,49,"notification.read")),t.xp6(5),t.Akn(t.DdM(66,Tt)),t.Q6J("showButtonBar",!0)("inputStyle",t.DdM(67,Tt)),t.xp6(4),t.Oqu(t.lcZ(52,51,"notification.createdDate")),t.xp6(5),t.s9C("legend",t.lcZ(57,53,"notification.notifiedTeams")),t.xp6(2),t.Q6J("value",o.notifiedTeams.controls)("responsive",!0),t.xp6(6),t.Akn(t.DdM(68,J)),t.Q6J("options",o.userOptions)("showClear",!0),t.xp6(2),t.Oqu(t.lcZ(67,55,"notification.createdBy")),t.xp6(5),t.Akn(t.DdM(69,J)),t.Q6J("options",o.userOptions)("virtualScroll",!0),t.xp6(2),t.Oqu(t.lcZ(74,57,"notification.notifiedUsers")),t.xp6(5),t.Oqu(t.lcZ(79,59,"notification.jData")),t.xp6(3),t.Q6J("cols",60),t.xp6(2),t.s9C("label",t.lcZ(84,61,"bia.save")),t.Q6J("disabled",!o.form.valid),t.xp6(2),t.s9C("label",t.lcZ(86,63,"bia.cancel")))},directives:[O._Y,O.JL,U.xw,O.sg,U.Wh,U.yH,oe.p,yt.xf,yt.x4,O.Fj,O.JJ,O.u,ne.o,O.nD,U.SQ,bt.Hq,D.sg,O.CE,O.x0,D.O5,ae.jx,se.Lt,re.XZ,le.f,ce.iA,de.u,pe.NU,ue.g],pipes:[V.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}"]}),e})(),ye=(()=>{class e{constructor(i,o,a,l,d){this.store=i,this.router=o,this.activatedRoute=a,this.notificationOptionsService=l,this.biaTranslationService=d,this.sub=new R.w}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(i=>{this.notificationOptionsService.loadAllOptions()}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(i){this.store.dispatch(c.create({notification:i})),this.router.navigate(["../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../"],{relativeTo:this.activatedRoute})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(s.yh),t.Y36(h.F0),t.Y36(h.gz),t.Y36(lt),t.Y36(k.P6))},e.\u0275cmp=t.Xpm({type:e,selectors:[["bia-notification-new"]],decls:6,vars:15,consts:[[3,"notificationTypeOptions","roleOptions","userOptions","teamOptions","languageOptions","cancel","save"]],template:function(i,o){1&i&&(t.TgZ(0,"bia-notification-form",0),t.NdJ("cancel",function(){return o.onCancelled()})("save",function(l){return o.onSubmitted(l)}),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async"),t.ALo(5,"async"),t.qZA()),2&i&&t.Q6J("notificationTypeOptions",t.lcZ(1,5,o.notificationOptionsService.notificationTypeOptions$))("roleOptions",t.lcZ(2,7,o.notificationOptionsService.roleOptions$))("userOptions",t.lcZ(3,9,o.notificationOptionsService.userOptions$))("teamOptions",t.lcZ(4,11,o.notificationOptionsService.teamOptions$))("languageOptions",t.lcZ(5,13,o.notificationOptionsService.languageOptions$))},directives:[At],pipes:[D.Ov],styles:[""]}),e})(),dt=(()=>{class e{constructor(i){this.store=i,this.sub=new R.w,this.InitSub(),this.loading$=this.store.select(Ct),this.notification$=this.store.select(z)}get currentNotification(){var i;return(null===(i=this._currentNotification)||void 0===i?void 0:i.id)===this._currentNotificationId?this._currentNotification:null}get currentNotificationId(){return this._currentNotificationId}set currentNotificationId(i){this._currentNotificationId=Number(i),this.store.dispatch(c.load({id:i}))}get currentNotificationData(){return this._currentNotification.jData}InitSub(){this.sub=new R.w,this.sub.add(this.store.select(z).subscribe(i=>{i&&(this._currentNotification=i)}))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(s.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var pt=n(9373);function be(e,r){1&e&&t._UZ(0,"bia-spinner",2),2&e&&t.Q6J("overlay",!0)}let Te=(()=>{class e{constructor(i,o,a,l,d,u){this.store=i,this.router=o,this.activatedRoute=a,this.notificationOptionsService=l,this.notificationService=d,this.biaTranslationService=u,this.displayChange=new t.vpe,this.sub=new R.w}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(i=>{this.notificationOptionsService.loadAllOptions()}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(i){this.store.dispatch(c.update({notification:i})),this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(s.yh),t.Y36(h.F0),t.Y36(h.gz),t.Y36(lt),t.Y36(dt),t.Y36(k.P6))},e.\u0275cmp=t.Xpm({type:e,selectors:[["bia-notification-edit"]],outputs:{displayChange:"displayChange"},decls:9,vars:21,consts:[[3,"notification","notificationTypeOptions","roleOptions","userOptions","teamOptions","languageOptions","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(i,o){1&i&&(t.TgZ(0,"bia-notification-form",0),t.NdJ("cancel",function(){return o.onCancelled()})("save",function(l){return o.onSubmitted(l)}),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async"),t.ALo(5,"async"),t.ALo(6,"async"),t.qZA(),t.YNc(7,be,1,1,"bia-spinner",1),t.ALo(8,"async")),2&i&&(t.Q6J("notification",t.lcZ(1,7,o.notificationService.notification$))("notificationTypeOptions",t.lcZ(2,9,o.notificationOptionsService.notificationTypeOptions$))("roleOptions",t.lcZ(3,11,o.notificationOptionsService.roleOptions$))("userOptions",t.lcZ(4,13,o.notificationOptionsService.userOptions$))("teamOptions",t.lcZ(5,15,o.notificationOptionsService.teamOptions$))("languageOptions",t.lcZ(6,17,o.notificationOptionsService.languageOptions$)),t.xp6(7),t.Q6J("ngIf",t.lcZ(8,19,o.notificationService.loading$)))},directives:[At,D.O5,pt.O],pipes:[D.Ov],styles:[""]}),e})();var K=n(6249),Ae=n(466);function Oe(e,r){1&e&&t._UZ(0,"bia-spinner",1),2&e&&t.Q6J("overlay",!0)}let Se=(()=>{class e{constructor(i,o,a,l,d){this.store=i,this.route=o,this.notificationService=a,this.layoutService=l,this.biaTranslationService=d,this.sub=new R.w}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(i=>{this.notificationService.currentNotificationId=this.route.snapshot.params.notificationId})),this.sub.add(this.store.select(z).subscribe(i=>{(null==i?void 0:i.title)&&(this.route.data.pipe((0,nt.P)()).subscribe(o=>{o.breadcrumb=i.title}),this.layoutService.refreshBreadcrumb())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(s.yh),t.Y36(h.gz),t.Y36(dt),t.Y36(Ae.N),t.Y36(k.P6))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(i,o){1&i&&(t._UZ(0,"router-outlet"),t.YNc(1,Oe,1,1,"bia-spinner",0),t.ALo(2,"async")),2&i&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,o.notificationService.loading$)))},directives:[h.lC,D.O5,pt.O],pipes:[D.Ov],styles:[""]}),e})();var Ot=n(8832),St=n(3460),Ce=n(3931);let _e=(()=>{class e extends A.Z{constructor(i){super(i,"NotificationTypes")}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(t.zs3))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ne=(()=>{class e{constructor(i,o,a){this.actions$=i,this.notificationTypeDas=o,this.biaMessageService=a,this.loadAll$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)($.loadAll),(0,y.w)(()=>this.notificationTypeDas.getList({endpoint:"allOptions"}).pipe((0,m.U)(l=>$.loadAllSuccess({notificationTypes:null==l?void 0:l.sort((d,u)=>d.display.localeCompare(u.display))})),(0,T.K)(l=>(this.biaMessageService.showError(),(0,g.of)($.failure({error:l}))))))))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(f.eX),t.LFG(_e),t.LFG(W.X))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})(),Le=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[s.Aw.forFeature("domain-notification-type-options",$t),f.sQ.forFeature([Ne])]]}),e})();var xe=n(3836);function Ze(e,r){if(1&e&&(t.TgZ(0,"div",9)(1,"div")(2,"b"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._UZ(5,"br"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div")(9,"b"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t._UZ(12,"br"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"div")(16,"b"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"br"),t._uU(20),t.ALo(21,"date"),t.qZA(),t.TgZ(22,"div")(23,"b"),t._uU(24),t.ALo(25,"translate"),t.qZA(),t._UZ(26,"br"),t._uU(27),t.qZA()()),2&e){const i=t.oxw().ngIf;t.xp6(3),t.Oqu(t.lcZ(4,8,"notification.title")),t.xp6(3),t.Oqu(t.lcZ(7,10,i.titleTranslated)),t.xp6(4),t.Oqu(t.lcZ(11,12,"notification.description")),t.xp6(3),t.hij("",t.lcZ(14,14,i.descriptionTranslated)," "),t.xp6(4),t.Oqu(t.lcZ(18,16,"notification.createdDate")),t.xp6(3),t.Oqu(t.xi3(21,18,i.createdDate,"short")),t.xp6(4),t.Oqu(t.lcZ(25,21,"notification.type.title")),t.xp6(3),t.Oqu(i.type.display)}}function Ie(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(i);const a=t.oxw().ngIf;return t.oxw().onSetUnread(a.id)}),t.ALo(1,"translate"),t.qZA()}2&e&&t.s9C("label",t.lcZ(1,1,"notification.setUnread"))}function De(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(i);const a=t.oxw().ngIf;return t.oxw().onAction(a)}),t.ALo(1,"translate"),t.qZA()}if(2&e){const i=t.oxw().ngIf;let o;t.Q6J("label",t.lcZ(1,1,null!==(o=null==i.data?null:i.data.display)&&void 0!==o?o:"notification.action"))}}function we(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){return t.CHM(i),t.oxw(2).onEdit()}),t.ALo(1,"translate"),t.qZA()}2&e&&t.s9C("label",t.lcZ(1,1,"bia.edit"))}function Ee(e,r){if(1&e){const i=t.EpF();t.ynx(0),t.YNc(1,Ze,28,23,"div",2),t.TgZ(2,"div",3),t.YNc(3,Ie,2,3,"button",4),t._UZ(4,"span"),t.TgZ(5,"div",5),t._UZ(6,"bia-notification-team-warning",6),t.YNc(7,De,2,3,"button",7),t.YNc(8,we,2,3,"button",4),t.TgZ(9,"button",8),t.NdJ("click",function(){return t.CHM(i),t.oxw().onCancelled()}),t.ALo(10,"translate"),t.qZA()()(),t.BQk()}if(2&e){const i=r.ngIf,o=t.oxw();t.xp6(1),t.Q6J("ngIf",i&&i.id),t.xp6(2),t.Q6J("ngIf",i.read),t.xp6(3),t.Q6J("notification",i),t.xp6(1),t.Q6J("ngIf",o.canAction(i)),t.xp6(1),t.Q6J("ngIf",o.canEdit),t.xp6(1),t.s9C("label",t.lcZ(10,6,"bia.cancel"))}}function Fe(e,r){1&e&&t._UZ(0,"bia-spinner",11),2&e&&t.Q6J("overlay",!0)}let Ue=(()=>{class e{constructor(i,o,a,l,d){this.store=i,this.router=o,this.activatedRoute=a,this.authService=l,this.notificationService=d,this.displayChange=new t.vpe,this.sub=new R.w}ngOnInit(){this.notification$=this.notificationService.notification$,this.canEdit=this.authService.hasPermission(P.y.Notification_Update)}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(i){this.store.dispatch(c.update({notification:i})),this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}onEdit(){this.router.navigate(["../edit"],{relativeTo:this.activatedRoute})}canAction(i){return!(!i.data||!i.data.route)}onAction(i){if(i.data){let o=i.data;o.route&&((null==o?void 0:o.teams)&&o.teams.forEach(a=>{this.authService.changeCurrentTeamId(a.teamTypeId,a.team.id),a.roles&&this.authService.changeCurrentRoleIds(a.teamTypeId,a.team.id,a.roles.map(l=>l.id))}),this.router.navigate(i.data.route))}}onSetUnread(i){this.store.dispatch(c.setUnread({id:i}))}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(s.yh),t.Y36(h.F0),t.Y36(h.gz),t.Y36(ot.e),t.Y36(dt))},e.\u0275cmp=t.Xpm({type:e,selectors:[["bia-notification-detail"]],outputs:{displayChange:"displayChange"},decls:4,vars:6,consts:[[4,"ngIf"],[3,"overlay",4,"ngIf"],["fxLayout","column","fxLayoutWrap","","fxLayoutAlign","space-evenly",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center"],["pButton","","type","button","class","p-button-secondary",3,"label","click",4,"ngIf"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],[3,"notification"],["pButton","","type","button","class","p-button-primary",3,"label","click",4,"ngIf"],["pButton","","type","button",1,"p-button-secondary",3,"label","click"],["fxLayout","column","fxLayoutWrap","","fxLayoutAlign","space-evenly"],["pButton","","type","button",1,"p-button-primary",3,"label","click"],[3,"overlay"]],template:function(i,o){1&i&&(t.YNc(0,Ee,11,8,"ng-container",0),t.ALo(1,"async"),t.YNc(2,Fe,1,1,"bia-spinner",1),t.ALo(3,"async")),2&i&&(t.Q6J("ngIf",t.lcZ(1,2,o.notification$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,o.loading$)))},directives:[D.O5,U.xw,U.Wh,bt.Hq,U.SQ,xe.t,pt.O],pipes:[D.Ov,V.X$,D.uU],styles:[""]}),e})(),Me=(()=>{class e extends A.Z{constructor(i){super(i,"Languages")}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(t.zs3))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Re=(()=>{class e{constructor(i,o,a){this.actions$=i,this.languageDas=o,this.biaMessageService=a,this.loadAll$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(B.loadAll),(0,y.w)(()=>this.languageDas.getList({endpoint:"allOptions"}).pipe((0,m.U)(l=>B.loadAllSuccess({languages:null==l?void 0:l.sort((d,u)=>d.display.localeCompare(u.display))})),(0,T.K)(l=>(this.biaMessageService.showError(),(0,g.of)(B.failure({error:l}))))))))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(f.eX),t.LFG(Me),t.LFG(W.X))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})(),Pe=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[s.Aw.forFeature("domain-language-options",Ut),f.sQ.forFeature([Re])]]}),e})();var Be=n(2566);let $e=(()=>{class e extends A.Z{constructor(i){super(i,"Teams")}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(t.zs3))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ut=n(6375);let je=(()=>{class e{constructor(i,o,a){this.actions$=i,this.teamDas=o,this.biaMessageService=a,this.loadAll$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(j.loadAll),(0,y.w)(()=>this.teamDas.getList({endpoint:"allOptions",offlineMode:ut.d.isModeEnabled}).pipe((0,m.U)(l=>j.loadAllSuccess({teams:null==l?void 0:l.sort((d,u)=>d.display.localeCompare(u.display))})),(0,T.K)(l=>((!0!==ut.d.isModeEnabled||!0===ut.d.isServerAvailable(l))&&this.biaMessageService.showError(),(0,g.of)(j.failure({error:l}))))))))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(f.eX),t.LFG($e),t.LFG(W.X))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})(),Ge=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[s.Aw.forFeature(H,Kt),f.sQ.forFeature([je])]]}),e})();const Ye=[{path:"",data:{breadcrumb:null,permission:P.y.Notification_List_Access,InjectComponent:ee},component:St.e,canActivate:[K.n],children:[{path:"create",data:{breadcrumb:"bia.add",canNavigate:!1,permission:P.y.Notification_Create,title:"notification.add",InjectComponent:ye},component:Ot._,canActivate:[K.n]},{path:":notificationId",data:{breadcrumb:"",canNavigate:!0},component:Se,canActivate:[K.n],children:[{path:"edit",data:{breadcrumb:"bia.edit",canNavigate:!0,permission:P.y.Notification_Update,title:"notification.edit",InjectComponent:Te},component:St.e,canActivate:[K.n]},{path:"detail",data:{breadcrumb:"bia.detail",canNavigate:!0,permission:P.y.Notification_Read,title:"notification.detail",InjectComponent:Ue},component:Ot._,canActivate:[K.n]},{path:"",redirectTo:"edit"}]}]},{path:"**",redirectTo:""}];let Je=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[ie.m,O.UX,h.Bz.forChild(Ye),s.Aw.forFeature("notifications",F),f.sQ.forFeature([et]),Le,Ce.U,Pe,Be.p,Ge]]}),e})()},4529:(E,S,n)=>{"use strict";n.d(S,{b:()=>h});class h{constructor(f,g){this.key=f,this.value=g}}},9441:function(E,S){var s;void 0!==(s=function(){"use strict";function g(p,c,A){var t=new XMLHttpRequest;t.open("GET",p),t.responseType="blob",t.onload=function(){L(t.response,c,A)},t.onerror=function(){console.error("could not download file")},t.send()}function C(p){var c=new XMLHttpRequest;c.open("HEAD",p,!1);try{c.send()}catch(A){}return 200<=c.status&&299>=c.status}function y(p){try{p.dispatchEvent(new MouseEvent("click"))}catch(A){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),p.dispatchEvent(c)}}var m="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,T=m.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),L=m.saveAs||("object"!=typeof window||window!==m?function(){}:"download"in HTMLAnchorElement.prototype&&!T?function(p,c,A){var t=m.URL||m.webkitURL,b=document.createElement("a");b.download=c=c||p.name||"download",b.rel="noopener","string"==typeof p?(b.href=p,b.origin===location.origin?y(b):C(b.href)?g(p,c,A):y(b,b.target="_blank")):(b.href=t.createObjectURL(p),setTimeout(function(){t.revokeObjectURL(b.href)},4e4),setTimeout(function(){y(b)},0))}:"msSaveOrOpenBlob"in navigator?function(p,c,A){if(c=c||p.name||"download","string"!=typeof p)navigator.msSaveOrOpenBlob(function f(p,c){return void 0===c?c={autoBom:!1}:"object"!=typeof c&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(p.type)?new Blob(["\ufeff",p],{type:p.type}):p}(p,A),c);else if(C(p))g(p,c,A);else{var t=document.createElement("a");t.href=p,t.target="_blank",setTimeout(function(){y(t)})}}:function(p,c,A,t){if((t=t||open("","_blank"))&&(t.document.title=t.document.body.innerText="downloading..."),"string"==typeof p)return g(p,c,A);var b="application/octet-stream"===p.type,M=/constructor/i.test(m.HTMLElement)||m.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||b&&M||T)&&"undefined"!=typeof FileReader){var I=new FileReader;I.onloadend=function(){var F=I.result;F=v?F:F.replace(/^data:[^;]*;/,"data:attachment/file;"),t?t.location.href=F:location=F,t=null},I.readAsDataURL(p)}else{var x=m.URL||m.webkitURL,G=x.createObjectURL(p);t?t.location=G:location.href=G,t=null,setTimeout(function(){x.revokeObjectURL(G)},4e4)}});m.saveAs=L.saveAs=L,E.exports=L}.apply(S,[]))&&(E.exports=s)}}]);
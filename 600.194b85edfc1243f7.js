(self.webpackChunkBIADemo=self.webpackChunkBIADemo||[]).push([[600],{6249:(D,O,o)=>{"use strict";o.d(O,{n:()=>I});var c=o(1564),v=o(2340),f=o(2994),u=o(5e3);let I=(()=>{class e{constructor(s){this.authService=s}canActivate(s,h){return this.authService.hasPermissionObs(s.data.permission).pipe((0,f.b)(d=>{!0!==d&&(window.location.href=v.N.urlErrorPage+"?num=403")}))}}return e.\u0275fac=function(s){return new(s||e)(u.LFG(c.e))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},2762:(D,O,o)=>{"use strict";o.d(O,{b:()=>v});const v=(0,o(5094).PH)("[Bia] Success the refresh of the list will be done by signalR.")},459:(D,O,o)=>{"use strict";o.d(O,{V:()=>f});var c=o(5e3),v=o(3569);let f=(()=>{class u{constructor(){this.crudItem={},this.save=new c.vpe,this.cancel=new c.vpe}onCancel(){this.cancel.next()}onSave(e){this.save.emit(e)}}return u.\u0275fac=function(e){return new(e||u)},u.\u0275cmp=c.Xpm({type:u,selectors:[["bia-crud-item-form"]],inputs:{crudItem:"crudItem",fields:"fields",dictOptionDtos:"dictOptionDtos"},outputs:{save:"save",cancel:"cancel"},decls:1,vars:3,consts:[[3,"element","fields","dictOptionDtos","save","cancel"]],template:function(e,b){1&e&&(c.TgZ(0,"bia-form",0),c.NdJ("save",function(h){return b.onSave(h)})("cancel",function(){return b.onCancel()}),c.qZA()),2&e&&c.Q6J("element",b.crudItem)("fields",b.fields)("dictOptionDtos",b.dictOptionDtos)},directives:[v.E],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}"]}),u})()},9238:(D,O,o)=>{"use strict";o.d(O,{M:()=>ee});var c=o(3075),v=o(1564),f=o(1466),u=o(6320),I=o(9157),e=o(5e3),b=o(42),s=o(7171),h=o(9808),_=o(4851),d=o(9783),g=o(7605),p=o(8786),T=o(2081);function S(i,C){1&i&&(e.TgZ(0,"th",10),e._UZ(1,"p-tableHeaderCheckbox"),e.qZA())}function L(i,C){if(1&i&&(e.TgZ(0,"th",13),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"p-sortIcon",14),e.qZA()),2&i){const a=e.oxw().$implicit;e.Q6J("pSortableColumn",a.field),e.xp6(1),e.hij(" ",e.lcZ(2,3,null==a?null:a.header)," "),e.xp6(2),e.Q6J("field",a.field)}}function n(i,C){if(1&i&&(e.TgZ(0,"th",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const a=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==a?null:a.header)," ")}}function A(i,C){if(1&i&&(e.ynx(0),e.YNc(1,L,4,5,"th",11),e.YNc(2,n,3,3,"th",12),e.BQk()),2&i){const a=C.$implicit;e.xp6(1),e.Q6J("ngIf",!0===(null==a?null:a.isSortable)),e.xp6(1),e.Q6J("ngIf",!0!==(null==a?null:a.isSortable))}}function R(i,C){1&i&&e._UZ(0,"th")}function P(i,C){if(1&i&&(e.TgZ(0,"th",19),e._UZ(1,"bia-table-filter",20),e.qZA()),2&i){const a=C.$implicit;e.oxw(3);const l=e.MAs(1);e.Q6J("ngSwitch",a.field),e.xp6(1),e.Q6J("col",a)("table",l)}}function K(i,C){if(1&i&&(e.TgZ(0,"tr",16),e.YNc(1,R,1,0,"th",17),e.YNc(2,P,2,3,"th",18),e.qZA()),2&i){const a=e.oxw().$implicit,l=e.oxw(2);e.xp6(1),e.Q6J("ngIf",l.canSelectElement),e.xp6(1),e.Q6J("ngForOf",a)}}function B(i,C){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,S,2,0,"th",7),e.YNc(2,A,3,2,"ng-container",8),e.qZA(),e.YNc(3,K,3,2,"tr",9)),2&i){const a=C.$implicit,l=e.oxw(2);e.xp6(1),e.Q6J("ngIf",l.canSelectElement),e.xp6(1),e.Q6J("ngForOf",a),e.xp6(1),e.Q6J("ngIf",l.showColSearch)}}function F(i,C){if(1&i&&e._UZ(0,"p-tableCheckbox",25),2&i){const a=e.oxw(2).$implicit;e.Q6J("value",a)}}function U(i,C){1&i&&e._UZ(0,"i",26)}function W(i,C){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,F,1,1,"p-tableCheckbox",23),e.YNc(2,U,1,0,"i",24),e.qZA()),2&i){const a=e.oxw().$implicit,l=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!0!==l.isFooter(a)&&a.id>0),e.xp6(1),e.Q6J("ngIf",!0===l.isFooter(a))}}function Z(i,C){1&i&&e.GkF(0)}const z=function(i,C){return{field:i,form:C}};function x(i,C){if(1&i&&e.YNc(0,Z,1,0,"ng-container",34),2&i){const a=e.oxw(3).$implicit,l=e.oxw(3);e.Q6J("ngTemplateOutlet",l.specificInputTemplate)("ngTemplateOutletContext",e.WLB(2,z,a,l.form))}}function y(i,C){if(1&i){const a=e.EpF();e.TgZ(0,"bia-table-input",32),e.NdJ("valueChange",function(){return e.CHM(a),e.oxw(5).onChange()})("complexInput",function(E){return e.CHM(a),e.oxw(5).onComplexInput(E)}),e.YNc(1,x,1,5,"ng-template",33),e.qZA()}if(2&i){const a=e.oxw(2).$implicit,l=e.oxw(3);e.Q6J("field",a)("form",l.form)("dictOptionDtos",l.dictOptionDtos)}}function t(i,C){1&i&&e.GkF(0)}const r=function(i,C){return{field:i,data:C}};function m(i,C){if(1&i&&e.YNc(0,t,1,0,"ng-container",34),2&i){const a=e.oxw(4).$implicit,l=e.oxw().$implicit,E=e.oxw(2);e.Q6J("ngTemplateOutlet",E.specificOutputTemplate)("ngTemplateOutletContext",e.WLB(2,r,a,E.getCellData(l,a)))}}function M(i,C){if(1&i&&(e.ynx(0),e.TgZ(1,"bia-table-output",35),e.YNc(2,m,1,5,"ng-template",36),e.qZA(),e.BQk()),2&i){const a=e.oxw(3).$implicit,l=e.oxw().$implicit,E=e.oxw(2);e.xp6(1),e.Q6J("field",a)("data",E.getCellData(l,a))}}function N(i,C){if(1&i&&e.YNc(0,M,3,2,"ng-container",17),2&i){const a=e.oxw(3).$implicit,l=e.oxw(2);e.Q6J("ngIf",!0!==l.isFooter(a))}}function J(i,C){if(1&i&&(e.YNc(0,y,2,3,"ng-template",30),e.YNc(1,N,1,1,"ng-template",null,31,e.W1O)),2&i){const a=e.MAs(2),l=e.oxw().$implicit;e.Q6J("ngIf",!0===l.isEditable)("ngIfElse",a)}}function V(i,C){1&i&&(e.TgZ(0,"label"),e._uU(1,"-"),e.qZA())}function $(i,C){if(1&i&&e.YNc(0,V,2,0,"label",17),2&i){const a=e.oxw(2).$implicit;e.Q6J("ngIf",!0===a.isEditable)}}function j(i,C){1&i&&e.GkF(0)}function Y(i,C){if(1&i&&e.YNc(0,j,1,0,"ng-container",34),2&i){const a=e.oxw(3).$implicit,l=e.oxw().$implicit,E=e.oxw(2);e.Q6J("ngTemplateOutlet",E.specificOutputTemplate)("ngTemplateOutletContext",e.WLB(2,r,a,E.getCellData(l,a)))}}function Q(i,C){if(1&i&&(e.TgZ(0,"bia-table-output",35),e.YNc(1,Y,1,5,"ng-template",36),e.qZA()),2&i){const a=e.oxw(2).$implicit,l=e.oxw().$implicit,E=e.oxw(2);e.Q6J("field",a)("data",E.getCellData(l,a))}}function H(i,C){if(1&i&&(e.YNc(0,$,1,1,"ng-template",30),e.YNc(1,Q,2,2,"ng-template",null,37,e.W1O)),2&i){const a=e.MAs(2),l=e.oxw(2).$implicit,E=e.oxw(2);e.Q6J("ngIf",!0===E.isFooter(l))("ngIfElse",a)}}function G(i,C){if(1&i){const a=e.EpF();e.TgZ(0,"td",27),e.NdJ("click",function(){e.CHM(a);const E=e.oxw().$implicit;return e.oxw(2).initEditableRow(E)}),e.TgZ(1,"p-cellEditor"),e.YNc(2,J,3,2,"ng-template",28),e.YNc(3,H,3,2,"ng-template",29),e.qZA()()}}function X(i,C){if(1&i){const a=e.EpF();e.TgZ(0,"tr",21),e.NdJ("focusout",function(){return e.CHM(a),e.oxw(2).onFocusout()})("keyup.enter",function(){return e.CHM(a),e.oxw(2).initEditableRow(null)})("keyup.escape",function(){return e.CHM(a),e.oxw(2).cancel()}),e.YNc(1,W,3,2,"td",17),e.YNc(2,G,4,0,"td",22),e.qZA()}if(2&i){const a=C.$implicit,l=C.columns,E=e.oxw(2);e.Q6J("pSelectableRow",!0!==E.isFooter(a)?a:null)("pEditableRow",a),e.xp6(1),e.Q6J("ngIf",E.canSelectElement),e.xp6(1),e.Q6J("ngForOf",l)}}function k(i,C){if(1&i&&(e.TgZ(0,"tr")(1,"td",38),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const a=C.$implicit;e.xp6(1),e.uIk("colspan",a.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"bia.NoRecordsFound")," ")}}function q(i,C){if(1&i){const a=e.EpF();e.TgZ(0,"p-table",2,3),e.NdJ("onFilter",function(){return e.CHM(a),e.oxw().onFilter()})("onLazyLoad",function(E){return e.CHM(a),e.oxw().onLoadLazy(E)})("onStateSave",function(E){return e.CHM(a),e.oxw().onStateSave(E)})("selectionChange",function(){return e.CHM(a),e.oxw().onSelectionChange()}),e.ALo(2,"async"),e.YNc(3,B,4,3,"ng-template",4),e.YNc(4,X,3,4,"ng-template",5),e.YNc(5,k,4,4,"ng-template",6),e.qZA()}if(2&i){const a=e.oxw();e.Q6J("autoLayout",!0)("reorderableColumns",!0)("columns",a.displayedColumns)("value",a.elements)("paginator",a.paginator)("rows",a.pageSize)("totalRecords",a.totalRecord)("lazy",!0)("loading",a.loading&&null!==e.lcZ(2,14,a.showLoading$))("stateStorage","session")("stateKey",a.tableStateKey)("lazyLoadOnInit",a.getLazyLoadOnInit())("sortField",a.sortFieldValue)("sortOrder",a.sortOrderValue)}}let ee=(()=>{class i extends u.l{constructor(a,l,E,w){super(a,l,E,w),this.formBuilder=a,this.authService=l,this.biaMessageService=E,this.translateService=w}initForm(){this.form=this.formBuilder.group(this.formFields())}formFields(){let a={id:[this.element.id]};for(let l of this.configuration.columns)a[l.field]=l.isRequired?[this.element[l.field],c.kI.required]:[this.element[l.field]];return a}onSubmit(){if(this.form.valid){const a=this.form.value;a.id=a.id>0?a.id:0;for(let l of this.configuration.columns)switch(l.type){case I.d5.Boolean:Reflect.set(a,l.field,!!a[l.field]&&a[l.field]);break;case I.d5.ManyToMany:Reflect.set(a,l.field,f.P.Differential(Reflect.get(a,l.field),this.element?Reflect.get(this.element,l.field):void 0));break;case I.d5.OneToMany:Reflect.set(a,l.field,f.P.Clone(a[l.field]))}this.save.emit(a),this.form.reset()}}}return i.\u0275fac=function(a){return new(a||i)(e.Y36(c.qu),e.Y36(v.e),e.Y36(b.X),e.Y36(s.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["bia-crud-item-table"]],features:[e.qOj],decls:2,vars:2,consts:[[1,"bia-calc-form",3,"formGroup"],["editMode","row","dataKey","id","styleClass","p-datatable-striped",3,"autoLayout","reorderableColumns","columns","value","paginator","rows","totalRecords","lazy","loading","stateStorage","stateKey","lazyLoadOnInit","sortField","sortOrder","onFilter","onLazyLoad","onStateSave","selectionChange",4,"ngIf"],["editMode","row","dataKey","id","styleClass","p-datatable-striped",3,"autoLayout","reorderableColumns","columns","value","paginator","rows","totalRecords","lazy","loading","stateStorage","stateKey","lazyLoadOnInit","sortField","sortOrder","onFilter","onLazyLoad","onStateSave","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","bia-table-select-col",4,"ngIf"],[4,"ngFor","ngForOf"],["class","searchTR",4,"ngIf"],[1,"bia-table-select-col"],["pReorderableColumn","",3,"pSortableColumn",4,"ngIf"],["pReorderableColumn","",4,"ngIf"],["pReorderableColumn","",3,"pSortableColumn"],[3,"field"],["pReorderableColumn",""],[1,"searchTR"],[4,"ngIf"],["pReorderableColumn","",3,"ngSwitch",4,"ngFor","ngForOf"],["pReorderableColumn","",3,"ngSwitch"],[3,"col","table"],[3,"pSelectableRow","pEditableRow","focusout","keyup.enter","keyup.escape"],[3,"click",4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["class","pi pi-plus",4,"ngIf"],[3,"value"],[1,"pi","pi-plus"],[3,"click"],["pTemplate","input"],["pTemplate","output"],[3,"ngIf","ngIfElse"],["isNotEditable",""],[3,"field","form","dictOptionDtos","valueChange","complexInput"],["pTemplate","specificInput"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"field","data"],["pTemplate","specificOutput"],["editRow",""],[1,"app-empty-message"]],template:function(a,l){1&a&&(e.TgZ(0,"form",0),e.YNc(1,q,6,16,"p-table",1),e.qZA()),2&a&&(e.Q6J("formGroup",l.form),e.xp6(1),e.Q6J("ngIf",l.configuration))},directives:[c._Y,c.JL,c.sg,h.O5,_.iA,d.jx,_.Mo,h.sg,_.Af,_.lQ,_.fz,h.RF,g.f,_.Ei,_.D$,_.UA,_.YL,p.P,h.tP,T.T],pipes:[h.Ov,s.X$],styles:["[_nghost-%COMP%]{flex-direction:column}[_nghost-%COMP%]     p-table .searchTR .p-float-label .p-inputtext{padding-top:2px!important}.app-empty-message[_ngcontent-%COMP%]{text-align:center!important}table[_ngcontent-%COMP%]{width:100%}.bia-table-select-col[_ngcontent-%COMP%]{width:60px}"]}),i})()},956:(D,O,o)=>{"use strict";o.d(O,{U:()=>f});var c=o(6135),v=o(5e3);let f=(()=>{class u{}return u.\u0275fac=function(e){return new(e||u)},u.\u0275mod=v.oAB({type:u}),u.\u0275inj=v.cJS({imports:[[c.m]]}),u})()},4394:(D,O,o)=>{"use strict";o.d(O,{B:()=>c});class c{constructor({featureName:f,fieldsConfig:u,storeKey:I="feature-"+f,useCalcMode:e=!1,useSignalR:b=!1,useView:s=!1,tableStateKey:h=f+"Grid",useViewTeamWithTypeId:_=null,usePopup:d=!0,useOfflineMode:g=!1,optionFilter:p}){this.featureName=f,this.fieldsConfig=u,this.storeKey=I,this.useCalcMode=e,this.useSignalR=b,this.useView=s,this.tableStateKey=h,this.useViewTeamWithTypeId=_,this.usePopup=d,this.useOfflineMode=g,this.optionFilter=p}}},7358:(D,O,o)=>{"use strict";o.d(O,{O:()=>v});var c=o(5e3);let v=(()=>{class f{constructor(){}loadAllOptions(I){}}return f.\u0275fac=function(I){return new(I||f)},f.\u0275prov=c.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},3248:(D,O,o)=>{"use strict";o.d(O,{z:()=>I});var c=o(5094),v=o(7224),f=o(7145),u=o(5e3);let I=(()=>{class e{constructor(s){this.injector=s,this.store=this.injector.get(c.yh),this.signalRService=this.injector.get(f.Y)}initialize(s){this.targetedFeature=s.getSignalRTargetedFeature(),console.log("%c ["+s.getConsoleLabel()+"] Register SignalR : "+s.getSignalRRefreshEvent(),"color: purple; font-weight: bold"),this.signalRService.addMethod(s.getSignalRRefreshEvent(),()=>{s.lastLazyLoadEvent$.pipe((0,v.P)()).subscribe(h=>{console.log("%c ["+s.getConsoleLabel()+"] RefreshSuccess","color: green; font-weight: bold"),s.loadAllByPost(h)})}),this.signalRService.joinGroup(this.targetedFeature)}destroy(){console.log("%c [CrudItems] Unregister SignalR : refresh-crud-items","color: purple; font-weight: bold"),this.signalRService.removeMethod("refresh-crud-items"),this.signalRService.leaveGroup(this.targetedFeature)}}return e.\u0275fac=function(s){return new(s||e)(u.LFG(u.zs3))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},9362:(D,O,o)=>{"use strict";o.d(O,{c:()=>I});var c=o(4147),v=o(3248),f=o(5e3),u=o(7358);let I=(()=>{class e{constructor(s,h,_){this.dasService=s,this.signalRService=h,this.optionsService=_,setTimeout(()=>this.InitSub())}capitalizeFirstLetter(s){return s.charAt(0).toUpperCase()+s.slice(1)}getParentIds(){return[]}getParentKey(){return this.getParentIds().map(s=>s.toString()).join("-")}getFeatureName(){return"crud-items"}getSignalRTargetedFeature(){return{parentKey:this.getParentKey(),featureName:this.getFeatureName()}}getConsoleLabel(){return this.capitalizeFirstLetter(this.getFeatureName().replace(/-./g,s=>s[1].toUpperCase()))}getSignalRRefreshEvent(){return"refresh-"+this.getFeatureName()}get currentCrudItem(){var s;return(null===(s=this._currentCrudItem)||void 0===s?void 0:s.id)===this._currentCrudItemId?this._currentCrudItem:null}get currentCrudItemId(){return this._currentCrudItemId}set currentCrudItemId(s){this._currentCrudItemId=s,this.load(s)}InitSub(){this.crudItem$.subscribe(s=>{s&&(this._currentCrudItem=s)})}}return e.\u0275fac=function(s){return new(s||e)(f.LFG(c.Z),f.LFG(v.z),f.LFG(u.O))},e.\u0275prov=f.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},9517:(D,O,o)=>{"use strict";o.d(O,{G:()=>d});var c=o(5e3),v=o(5094),f=o(2654),u=o(4490),I=o(8042),e=o(9362),b=o(459),s=o(9808),h=o(9373);function _(g,p){1&g&&c._UZ(0,"bia-spinner",2),2&g&&c.Q6J("overlay",!0)}let d=(()=>{class g{constructor(T,S){this.injector=T,this.crudItemService=S,this.displayChange=new c.vpe,this.sub=new f.w,this.store=this.injector.get(v.yh),this.router=this.injector.get(u.F0),this.activatedRoute=this.injector.get(u.gz),this.biaTranslationService=this.injector.get(I.P6)}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(T=>{this.crudItemService.optionsService.loadAllOptions(this.crudConfiguration.optionFilter)}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(T){this.crudItemService.update(T),this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}}return g.\u0275fac=function(T){return new(T||g)(c.Y36(c.zs3),c.Y36(e.c))},g.\u0275cmp=c.Xpm({type:g,selectors:[["bia-crud-item-edit"]],outputs:{displayChange:"displayChange"},decls:5,vars:10,consts:[[3,"crudItem","fields","dictOptionDtos","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(T,S){1&T&&(c.TgZ(0,"bia-crud-item-form",0),c.NdJ("cancel",function(){return S.onCancelled()})("save",function(n){return S.onSubmitted(n)}),c.ALo(1,"async"),c.ALo(2,"async"),c.qZA(),c.YNc(3,_,1,1,"bia-spinner",1),c.ALo(4,"async")),2&T&&(c.Q6J("crudItem",c.lcZ(1,4,S.crudItemService.crudItem$))("fields",S.crudConfiguration.fieldsConfig.columns)("dictOptionDtos",c.lcZ(2,6,S.crudItemService.optionsService.dictOptionDtos$)),c.xp6(3),c.Q6J("ngIf",c.lcZ(4,8,S.crudItemService.loadingGet$)))},directives:[b.V,s.O5,h.O],pipes:[s.Ov],styles:[""]}),g})()},3004:(D,O,o)=>{"use strict";o.d(O,{m:()=>s});var c=o(2654),v=o(4490),f=o(9362),u=o(5e3),I=o(9808),e=o(9373);function b(h,_){1&h&&u._UZ(0,"bia-spinner",1),2&h&&u.Q6J("overlay",!0)}let s=(()=>{class h{constructor(d,g){this.injector=d,this.crudItemService=g,this.sub=new c.w,this.route=this.injector.get(v.gz)}ngOnInit(){this.crudItemService.currentCrudItemId=this.route.snapshot.params.crudItemId}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}}return h.\u0275fac=function(d){return new(d||h)(u.Y36(u.zs3),u.Y36(f.c))},h.\u0275cmp=u.Xpm({type:h,selectors:[["bia-cruditem-item"]],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(d,g){1&d&&(u._UZ(0,"router-outlet"),u.YNc(1,b,1,1,"bia-spinner",0),u.ALo(2,"async")),2&d&&(u.xp6(1),u.Q6J("ngIf",u.lcZ(2,1,g.crudItemService.loadingGet$)))},directives:[v.lC,I.O5,e.O],pipes:[I.Ov],styles:[""]}),h})()},6161:(D,O,o)=>{"use strict";o.d(O,{J:()=>h});var c=o(5094),v=o(4490),f=o(8042),u=o(2654),I=o(9362),e=o(5e3),b=o(459),s=o(9808);let h=(()=>{class _{constructor(g,p){this.injector=g,this.crudItemService=p,this.sub=new u.w,this.store=this.injector.get(c.yh),this.router=this.injector.get(v.F0),this.activatedRoute=this.injector.get(v.gz),this.biaTranslationService=this.injector.get(f.P6)}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(g=>{this.crudItemService.optionsService.loadAllOptions(this.crudConfiguration.optionFilter)}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(g){this.crudItemService.create(g),this.router.navigate(["../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../"],{relativeTo:this.activatedRoute})}}return _.\u0275fac=function(g){return new(g||_)(e.Y36(e.zs3),e.Y36(I.c))},_.\u0275cmp=e.Xpm({type:_,selectors:[["bia-crud-item-new"]],decls:2,vars:4,consts:[[3,"fields","dictOptionDtos","cancel","save"]],template:function(g,p){1&g&&(e.TgZ(0,"bia-crud-item-form",0),e.NdJ("cancel",function(){return p.onCancelled()})("save",function(S){return p.onSubmitted(S)}),e.ALo(1,"async"),e.qZA()),2&g&&e.Q6J("fields",p.crudConfiguration.fieldsConfig.columns)("dictOptionDtos",e.lcZ(1,2,p.crudItemService.optionsService.dictOptionDtos$))},directives:[b.V],pipes:[s.Ov],styles:[""]}),_})()},2338:(D,O,o)=>{"use strict";o.d(O,{t:()=>z});var c=o(5094),v=o(2654),f=o(8385),u=o(136),I=o(4490),e=o(9441),s=o(7171),h=o(8042),_=o(6468),d=o(9238),g=o(1307),p=o(2198),T=o(9362),S=o(6375),L=o(1564),n=o(5e3),A=o(277),R=o(1606),P=o(6743),K=o(9783),B=o(4119),F=o(9808);function U(x,y){if(1&x){const t=n.EpF();n.TgZ(0,"div",7)(1,"i",8),n.NdJ("click",function(){n.CHM(t);const m=n.oxw();return m.useClacModeChange(!m.crudConfiguration.useCalcMode)}),n.ALo(2,"translate"),n.qZA(),n.TgZ(3,"i",9),n.NdJ("click",function(){n.CHM(t);const m=n.oxw();return m.useViewChange(!m.crudConfiguration.useView)}),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"i",10),n.NdJ("click",function(){n.CHM(t);const m=n.oxw();return m.useSignalRChange(!m.crudConfiguration.useSignalR)}),n.ALo(6,"translate"),n.qZA()()}if(2&x){const t=n.oxw();n.xp6(1),n.Tol(t.crudConfiguration.useCalcMode?"enable":"disabled"),n.s9C("pTooltip",n.lcZ(2,9,"bia.useCalcMode")),n.xp6(2),n.Tol(t.crudConfiguration.useView?"enable":"disabled"),n.s9C("pTooltip",n.lcZ(4,11,"bia.useView")),n.xp6(2),n.Tol(t.crudConfiguration.useSignalR?"enable":"disabled"),n.s9C("pTooltip",n.lcZ(6,13,"bia.useSignalR"))}}function W(x,y){if(1&x){const t=n.EpF();n.TgZ(0,"bia-table",11),n.NdJ("clickRow",function(m){return n.CHM(t),n.oxw().onClickRow(m)})("loadLazy",function(m){return n.CHM(t),n.oxw().onLoadLazy(m)})("selectedElementsChanged",function(m){return n.CHM(t),n.oxw().onSelectedElementsChanged(m)})("stateSave",function(m){return n.CHM(t),n.oxw().onStateSave(m)}),n.ALo(1,"async"),n.ALo(2,"async"),n.ALo(3,"async"),n.qZA()}if(2&x){const t=n.oxw();n.Q6J("elements",n.lcZ(1,13,t.crudItems$))("totalRecord",n.lcZ(2,15,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.crudConfiguration.fieldsConfig)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canClickRow",t.canEdit)("canSelectElement",t.canDelete)("loading",n.lcZ(3,17,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)("sortFieldValue",t.sortFieldValue)}}function Z(x,y){if(1&x){const t=n.EpF();n.TgZ(0,"bia-crud-item-table",12),n.NdJ("loadLazy",function(m){return n.CHM(t),n.oxw().onLoadLazy(m)})("selectedElementsChanged",function(m){return n.CHM(t),n.oxw().onSelectedElementsChanged(m)})("stateSave",function(m){return n.CHM(t),n.oxw().onStateSave(m)})("save",function(m){return n.CHM(t),n.oxw().onSave(m)}),n.ALo(1,"async"),n.ALo(2,"async"),n.ALo(3,"async"),n.ALo(4,"async"),n.qZA()}if(2&x){const t=n.oxw();n.Q6J("elements",n.lcZ(1,15,t.crudItems$))("dictOptionDtos",n.lcZ(2,17,t.crudItemService.optionsService.dictOptionDtos$))("totalRecord",n.lcZ(3,19,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.crudConfiguration.fieldsConfig)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canEdit)("canAdd",t.canAdd)("canSelectElement",t.canDelete)("loading",n.lcZ(4,21,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)("sortFieldValue",t.sortFieldValue)}}let z=(()=>{class x{constructor(t,r){this.injector=t,this.crudItemService=r,this.useRefreshAtLanguageChange=!1,this.flex=!0,this.sub=new v.w,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=u.L8,this.pageSize=this.defaultPageSize,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.sortFieldValue="",this.isLoadAllOptionsSubsribe=!1,this.showAdvancedFilter=!1,this.haveAdvancedFilter=!1,this.store=this.injector.get(c.yh),this.router=this.injector.get(I.F0),this.activatedRoute=this.injector.get(I.gz),this.translateService=this.injector.get(s.sK),this.biaTranslationService=this.injector.get(h.P6),this.authService=this.injector.get(L.e)}get crudItemListComponent(){return this.crudConfiguration.useCalcMode?this.crudItemTableComponent:this.biaTableComponent}useViewChange(t){this.crudConfiguration.useView=t,this.useViewConfig(!0)}useClacModeChange(t){this.crudConfiguration.useCalcMode=t,this.useClacModeConfig(!0)}useSignalRChange(t){this.crudConfiguration.useSignalR=t,this.useSignalRConfig(!0)}usePopupChange(t){this.crudConfiguration.usePopup=t,this.usePopupConfig(!0)}useViewConfig(t){this.tableStateKey=this.crudConfiguration.useView?this.crudConfiguration.tableStateKey:void 0,this.useViewTeamWithTypeId=this.crudConfiguration.useView?this.crudConfiguration.useViewTeamWithTypeId:null,this.crudConfiguration.useView&&(t&&setTimeout(()=>{var r;(null===(r=this.crudItemListComponent)||void 0===r?void 0:r.table)&&this.crudItemListComponent.table.saveState()}),this.store.dispatch((0,_.Tx)()))}useClacModeConfig(t){this.crudConfiguration.useCalcMode&&!this.isLoadAllOptionsSubsribe&&(this.isLoadAllOptionsSubsribe=!0,this.sub.add(this.biaTranslationService.currentCulture$.subscribe(r=>{this.crudItemService.optionsService.loadAllOptions(this.crudConfiguration.optionFilter)})))}usePopupConfig(t){var r;t&&this.applyDynamicComponent(null===(r=this.activatedRoute.routeConfig)||void 0===r?void 0:r.children)}applyDynamicComponent(t){t&&t.forEach(r=>{r.data&&r.data.dynamicComponent&&(r.component=r.data.dynamicComponent()),this.applyDynamicComponent(r.children)})}useSignalRConfig(t){this.crudConfiguration.useSignalR?(this.crudItemService.signalRService.initialize(this.crudItemService),this.onLoadLazy(this.crudItemListComponent.getLazyLoadMetadata())):t&&this.crudItemService.signalRService.destroy()}ngOnInit(){this.sub=new v.w,this.initTableConfiguration(),this.sub.add(this.authService.authInfo$.subscribe(t=>{t&&this.setPermissions()})),this.crudItems$=this.crudItemService.crudItems$,this.totalCount$=this.crudItemService.totalCount$,this.loading$=this.crudItemService.loadingGetAll$,this.OnDisplay(),this.useRefreshAtLanguageChange&&this.sub.add(this.biaTranslationService.currentCulture$.pipe((0,g.T)(1)).subscribe(t=>{this.onLoadLazy(this.crudItemListComponent.getLazyLoadMetadata())})),this.crudConfiguration.useOfflineMode&&S.d.isModeEnabled&&this.sub.add(this.injector.get(S.d).syncCompleted$.pipe((0,g.T)(1),(0,p.h)(t=>!0===t)).subscribe(()=>{this.onLoadLazy(this.crudItemListComponent.getLazyLoadMetadata())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.OnHide()}OnDisplay(){this.useViewConfig(!1),this.useClacModeConfig(!1),this.useSignalRConfig(!1),this.usePopupConfig(!1)}OnHide(){this.crudConfiguration.useSignalR&&this.crudItemService.signalRService.destroy()}onCreate(){this.crudConfiguration.useCalcMode||this.router.navigate(["create"],{relativeTo:this.activatedRoute})}onClickRow(t){this.onEdit(t)}onEdit(t){this.crudConfiguration.useCalcMode||this.router.navigate([t,"edit"],{relativeTo:this.activatedRoute})}onChange(){this.crudConfiguration.useCalcMode&&this.crudItemTableComponent.onChange()}onComplexInput(t){this.crudConfiguration.useCalcMode&&this.crudItemTableComponent.onComplexInput(t)}onSave(t){this.crudConfiguration.useCalcMode&&(t.id>0?this.canEdit&&this.crudItemService.update(t):this.canAdd&&this.crudItemService.create(t))}onDelete(){this.selectedCrudItems&&this.canDelete&&this.crudItemService.multiRemove(this.selectedCrudItems.map(t=>t.id))}onSelectedElementsChanged(t){this.selectedCrudItems=t}onPageSizeChange(t){this.pageSize=t}onLoadLazy(t){const r=Object.assign({advancedFilter:this.crudConfiguration.fieldsConfig.advancedFilter,parentIds:this.crudItemService.getParentIds().map(m=>m.toString())},t);this.crudItemService.loadAllByPost(r)}searchGlobalChanged(t){this.globalSearchValue=t}displayedColumnsChanged(t){this.displayedColumns=t}onToggleSearch(){this.showColSearch=!this.showColSearch}onViewChange(t){this.viewPreference=t,this.updateAdvancedFilterByView(t)}onStateSave(t){this.viewPreference=t,this.tableState=t}onExportCSV(){const t={};this.crudItemListComponent.getPrimeNgTable().columns.map(m=>t[m.field]=this.translateService.instant(m.header));const r=Object.assign({parentIds:this.crudItemService.getParentIds().map(m=>m.toString()),columns:t},this.crudItemListComponent.getLazyLoadMetadata());this.crudItemService.dasService.getFile(r).subscribe(m=>{e.saveAs(m,this.translateService.instant("app.crudItems")+".csv")})}setPermissions(){this.canEdit=!0,this.canDelete=!0,this.canAdd=!0}initTableConfiguration(){this.columns=this.crudConfiguration.fieldsConfig.columns.map(t=>({key:t.field,value:t.header})),this.displayedColumns=[...this.columns],this.sortFieldValue=this.columns[0].key,this.defaultViewPref={first:0,rows:this.defaultPageSize,sortField:this.sortFieldValue,sortOrder:1,filters:{},columnOrder:this.crudConfiguration.fieldsConfig.columns.map(t=>t.field),advancedFilter:void 0}}onFilter(t){this.crudConfiguration.fieldsConfig.advancedFilter=t,this.crudItemListComponent.table.saveState(),this.checkHaveAdvancedFilter(),this.onLoadLazy(this.crudItemListComponent.getLazyLoadMetadata())}checkHaveAdvancedFilter(){this.haveAdvancedFilter=!1}updateAdvancedFilterByView(t){if(t){const r=JSON.parse(t);r&&(this.crudConfiguration.fieldsConfig.advancedFilter=r.advancedFilter,this.checkHaveAdvancedFilter())}else this.crudConfiguration.fieldsConfig.advancedFilter={},this.checkHaveAdvancedFilter()}onCloseFilter(){this.showAdvancedFilter=!1}onOpenFilter(){this.showAdvancedFilter=!0}}return x.\u0275fac=function(t){return new(t||x)(n.Y36(n.zs3),n.Y36(T.c))},x.\u0275cmp=n.Xpm({type:x,selectors:[["bia-crud-items-index"]],viewQuery:function(t,r){if(1&t&&(n.Gf(f.$,5),n.Gf(d.M,5)),2&t){let m;n.iGM(m=n.CRH())&&(r.biaTableComponent=m.first),n.iGM(m=n.CRH())&&(r.crudItemTableComponent=m.first)}},hostVars:2,hostBindings:function(t,r){2&t&&n.ekj("bia-flex",r.flex)},decls:9,vars:19,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canDelete","canExportCSV","selectedElements","create","exportCSV","delete"],[3,"defaultPageSize","length","columns","columnToDisplays","tableStateKey","tableState","defaultViewPref","useViewTeamWithTypeId","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],["pTemplate","customControl"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","sortFieldValue","clickRow","loadLazy","selectedElementsChanged","stateSave",4,"ngIf"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","sortFieldValue","loadLazy","selectedElementsChanged","stateSave","save",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px",1,"bia-table-controller-container"],["tooltipPosition","top",1,"pi","pi-table","bia-pointer",3,"pTooltip","click"],["tooltipPosition","top",1,"pi","pi-eye","bia-pointer",3,"pTooltip","click"],["tooltipPosition","top",1,"pi","pi-sync","bia-pointer",3,"pTooltip","click"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","sortFieldValue","clickRow","loadLazy","selectedElementsChanged","stateSave"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","sortFieldValue","loadLazy","selectedElementsChanged","stateSave","save"]],template:function(t,r){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"bia-table-header",2),n.NdJ("create",function(){return r.onCreate()})("exportCSV",function(){return r.onExportCSV()})("delete",function(){return r.onDelete()}),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"bia-table-controller",3),n.NdJ("displayedColumnsChange",function(M){return r.displayedColumnsChanged(M)})("filter",function(M){return r.searchGlobalChanged(M)})("pageSizeChange",function(M){return r.onPageSizeChange(M)})("toggleSearch",function(){return r.onToggleSearch()})("viewChange",function(M){return r.onViewChange(M)}),n.ALo(5,"async"),n.YNc(6,U,7,15,"ng-template",4),n.qZA(),n.YNc(7,W,4,19,"bia-table",5),n.YNc(8,Z,5,23,"bia-crud-item-table",6),n.qZA()()),2&t&&(n.xp6(2),n.Q6J("headerTitle",n.lcZ(3,15,"crudItem.listOf"))("canAdd",r.canAdd&&!r.crudConfiguration.useCalcMode)("canDelete",r.canDelete)("canExportCSV",!0)("selectedElements",r.selectedCrudItems),n.xp6(2),n.Q6J("defaultPageSize",r.defaultPageSize)("length",n.lcZ(5,17,r.totalCount$))("columns",r.columns)("columnToDisplays",r.displayedColumns)("tableStateKey",r.tableStateKey)("tableState",r.tableState)("defaultViewPref",r.defaultViewPref)("useViewTeamWithTypeId",r.useViewTeamWithTypeId),n.xp6(3),n.Q6J("ngIf",!r.crudConfiguration.useCalcMode),n.xp6(1),n.Q6J("ngIf",r.crudConfiguration.useCalcMode))},directives:[A.xw,A.yH,R.l,P.B,K.jx,A.SQ,B.u,F.O5,f.$,d.M],pipes:[s.X$,F.Ov],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),x})()},9441:function(D,O){var v;void 0!==(v=function(){"use strict";function u(_,d,g){var p=new XMLHttpRequest;p.open("GET",_),p.responseType="blob",p.onload=function(){h(p.response,d,g)},p.onerror=function(){console.error("could not download file")},p.send()}function I(_){var d=new XMLHttpRequest;d.open("HEAD",_,!1);try{d.send()}catch(g){}return 200<=d.status&&299>=d.status}function e(_){try{_.dispatchEvent(new MouseEvent("click"))}catch(g){var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),_.dispatchEvent(d)}}var b="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,s=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=b.saveAs||("object"!=typeof window||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(_,d,g){var p=b.URL||b.webkitURL,T=document.createElement("a");T.download=d=d||_.name||"download",T.rel="noopener","string"==typeof _?(T.href=_,T.origin===location.origin?e(T):I(T.href)?u(_,d,g):e(T,T.target="_blank")):(T.href=p.createObjectURL(_),setTimeout(function(){p.revokeObjectURL(T.href)},4e4),setTimeout(function(){e(T)},0))}:"msSaveOrOpenBlob"in navigator?function(_,d,g){if(d=d||_.name||"download","string"!=typeof _)navigator.msSaveOrOpenBlob(function f(_,d){return void 0===d?d={autoBom:!1}:"object"!=typeof d&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(_.type)?new Blob(["\ufeff",_],{type:_.type}):_}(_,g),d);else if(I(_))u(_,d,g);else{var p=document.createElement("a");p.href=_,p.target="_blank",setTimeout(function(){e(p)})}}:function(_,d,g,p){if((p=p||open("","_blank"))&&(p.document.title=p.document.body.innerText="downloading..."),"string"==typeof _)return u(_,d,g);var T="application/octet-stream"===_.type,S=/constructor/i.test(b.HTMLElement)||b.safari,L=/CriOS\/[\d]+/.test(navigator.userAgent);if((L||T&&S||s)&&"undefined"!=typeof FileReader){var n=new FileReader;n.onloadend=function(){var P=n.result;P=L?P:P.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=P:location=P,p=null},n.readAsDataURL(_)}else{var A=b.URL||b.webkitURL,R=A.createObjectURL(_);p?p.location=R:location.href=R,p=null,setTimeout(function(){A.revokeObjectURL(R)},4e4)}});b.saveAs=h.saveAs=h,D.exports=h}.apply(O,[]))&&(D.exports=v)}}]);
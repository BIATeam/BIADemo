"use strict";(self.webpackChunkbiademo=self.webpackChunkbiademo||[]).push([[408],{16249:function(e,t,i){i.d(t,{n:function(){return r}});var n=i(8340),s=i(92340),o=i(68307),a=i(37716);let r=(()=>{class e{constructor(e){this.authService=e}canActivate(e,t){return this.authService.hasPermissionObs(e.data.permission).pipe((0,o.b)(e=>{!0!==e&&(window.location.href=s.N.urlErrorPage+"?num=403")}))}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(n.e))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},9716:function(e,t,i){i.d(t,{P:function(){return l}});var n=i(75319),s=i(41464),o=i(99147),a=i(37716),r=i(86710);let l=(()=>{class e{constructor(e){this.store=e,this.sub=new n.w,this.InitSub(),this.loading$=this.store.select(s.gc)}get currentSite(){var e;return(null===(e=this._currentSite)||void 0===e?void 0:e.id)===this._currentSiteId?this._currentSite:null}get currentSiteId(){return this._currentSiteId}set currentSiteId(e){this._currentSiteId=Number(e),this.store.dispatch((0,o.zD)({id:e}))}InitSub(){this.sub=new n.w,this.sub.add(this.store.select(s.WQ).subscribe(e=>{e&&(this._currentSite=e)}))}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(r.yh))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},17408:function(e,t,i){i.r(t),i.d(t,{SiteModule:function(){return xe}});var n=i(2694),s=i(86710),o=i(91601),a=i(25917),r=i(92996),l=i(43190),c=i(88002),u=i(5304),d=i(94612),p=i(57057),h=i(99147),f=i(74147),g=i(37716);let b=(()=>{class e extends f.Z{constructor(e){super(e,"sites")}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(g.zs3))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),m=(()=>{class e extends f.Z{constructor(e){super(e,"sites")}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(g.zs3))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=i(41464),y=i(42);let S=(()=>{class e{constructor(e,t,i,n,s){this.actions$=e,this.siteDas=t,this.siteInfoDas=i,this.biaMessageService=n,this.store=s,this.loadAllByPost$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(h.rF),(0,r.j)("event"),(0,l.w)(e=>this.siteInfoDas.getListByPost(e).pipe((0,c.U)(t=>(0,h.ni)({result:t,event:e})),(0,u.K)(e=>(this.biaMessageService.showError(),(0,a.of)((0,h.Rn)({error:e})))))))),this.load$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(h.zD),(0,r.j)("id"),(0,l.w)(e=>this.siteDas.get(e).pipe((0,c.U)(e=>(0,h.T4)({site:e})),(0,u.K)(e=>(this.biaMessageService.showError(),(0,a.of)((0,h.Rn)({error:e})))))))),this.create$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(h.Ue),(0,r.j)("site"),(0,d.b)(e=>(0,a.of)(e).pipe((0,p.M)(this.store.select(v.yG)))),(0,l.w)(([e,t])=>this.siteDas.post(e).pipe((0,c.U)(()=>(this.biaMessageService.showAddSuccess(),(0,h.rF)({event:t}))),(0,u.K)(e=>(this.biaMessageService.showError(),(0,a.of)((0,h.Rn)({error:e})))))))),this.update$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(h.Vx),(0,r.j)("site"),(0,d.b)(e=>(0,a.of)(e).pipe((0,p.M)(this.store.select(v.yG)))),(0,l.w)(([e,t])=>this.siteDas.put(e,e.id).pipe((0,c.U)(()=>(this.biaMessageService.showUpdateSuccess(),(0,h.rF)({event:t}))),(0,u.K)(e=>(this.biaMessageService.showError(),(0,a.of)((0,h.Rn)({error:e})))))))),this.destroy$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(h.Od),(0,r.j)("id"),(0,d.b)(e=>(0,a.of)(e).pipe((0,p.M)(this.store.select(v.yG)))),(0,l.w)(([e,t])=>this.siteDas.delete(e).pipe((0,c.U)(()=>(this.biaMessageService.showDeleteSuccess(),(0,h.rF)({event:t}))),(0,u.K)(e=>(this.biaMessageService.showError(),(0,a.of)((0,h.Rn)({error:e})))))))),this.multiDestroy$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(h.v),(0,r.j)("ids"),(0,d.b)(e=>(0,a.of)(e).pipe((0,p.M)(this.store.select(v.yG)))),(0,l.w)(([e,t])=>this.siteDas.deletes(e).pipe((0,c.U)(()=>(this.biaMessageService.showDeleteSuccess(),(0,h.rF)({event:t}))),(0,u.K)(e=>(this.biaMessageService.showError(),(0,a.of)((0,h.Rn)({error:e}))))))))}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(o.eX),g.LFG(b),g.LFG(m),g.LFG(y.X),g.LFG(s.yh))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac}),e})();var x=i(79090),w=i(40136),C=i(8340),Z=i(29206),A=i(71585),F=i(43590),L=i(35618),O=i(4207),M=i(99287),T=i(96516),P=i(3679),q=i(81780);const J=["template"],z=function(){return{width:"100%"}};function I(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",1),g.TgZ(1,"button",2),g.NdJ("click",function(){return g.CHM(e),g.oxw().onClose()}),g.ALo(2,"translate"),g.qZA(),g.TgZ(3,"div",3),g.TgZ(4,"h1"),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.qZA(),g.TgZ(7,"div",4),g.TgZ(8,"div",5),g.TgZ(9,"span",6),g.TgZ(10,"p-autoComplete",7),g.NdJ("ngModelChange",function(t){return g.CHM(e),g.oxw().userSelected=t})("completeMethod",function(t){return g.CHM(e),g.oxw().onSearchUsers(t)}),g.qZA(),g.TgZ(11,"label"),g._uU(12),g.ALo(13,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(14,"div",8),g.TgZ(15,"button",9),g.NdJ("click",function(){return g.CHM(e),g.oxw().onReset()}),g.ALo(16,"translate"),g.qZA(),g.TgZ(17,"button",10),g.NdJ("click",function(){return g.CHM(e),g.oxw().onFilter()}),g.ALo(18,"translate"),g.qZA(),g.qZA(),g.qZA()}if(2&e){const e=g.oxw();g.s9C("fxFlex",e.fxFlexValue),g.Q6J("hidden",e.hidden),g.xp6(1),g.s9C("pTooltip",g.lcZ(2,15,"msg.showFilters")),g.xp6(4),g.Oqu(g.lcZ(6,17,"bia.filters")),g.xp6(5),g.Akn(g.DdM(25,z)),g.Q6J("multiple",!1)("ngModel",e.userSelected)("suggestions",e.userOptions)("size",30)("minLength",2)("inputStyle",g.DdM(26,z)),g.xp6(2),g.Oqu(g.lcZ(13,19,"site.selectUser")),g.xp6(3),g.s9C("label",g.lcZ(16,21,"bia.reset")),g.xp6(2),g.s9C("label",g.lcZ(18,23,"bia.filter"))}}let N=(()=>{class e{constructor(e){this.viewContainerRef=e,this.hidden=!1,this.closeFilter=new g.vpe,this.searchUsers=new g.vpe,this.filter=new g.vpe}ngOnInit(){this.viewContainerRef.createEmbeddedView(this.template)}onClose(){this.closeFilter.emit()}onReset(){this.userSelected={},this.onFilter()}onFilter(){this.filter.emit({userId:this.userSelected?this.userSelected.id:0})}onSearchUsers(e){this.searchUsers.emit(e.query)}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(g.s_b))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-site-filter"]],viewQuery:function(e,t){if(1&e&&g.Gf(J,7),2&e){let e;g.iGM(e=g.CRH())&&(t.template=e.first)}},inputs:{fxFlexValue:"fxFlexValue",userOptions:"userOptions",hidden:"hidden"},outputs:{closeFilter:"closeFilter",searchUsers:"searchUsers",filter:"filter"},decls:2,vars:0,consts:[["template",""],[1,"app-search-filter",3,"hidden","fxFlex"],["type","button","icon","pi pi-times","pButton","",1,"p-button-rounded","p-button-text","flat",3,"pTooltip","click"],["fxLayout","row","fxLayoutAlign","stretch center",1,"header"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-filter-container"],[1,"p-float-label"],["field","display",3,"multiple","ngModel","suggestions","size","minLength","inputStyle","ngModelChange","completeMethod"],["fxLayout","row","fxLayoutAlign","space-around"],["pButton","","fxFlex","33",1,"p-button-outlined",3,"label","click"],["pButton","","fxFlex","33",3,"label","click"]],template:function(e,t){1&e&&g.YNc(0,I,19,27,"ng-template",null,0,g.W1O)},directives:[L.yH,O.Hq,M.u,L.xw,L.Wh,T.Qc,P.JJ,P.On],pipes:[q.X$],styles:['h3[_ngcontent-%COMP%]{margin-bottom:0}.app-filter-container[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.app-search-filter[_ngcontent-%COMP%]{margin:-15px 35px -15px -35px}.app-search-filter[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{position:absolute}.pi[_ngcontent-%COMP%]   pi-clear[_ngcontent-%COMP%]{margin-left:12px;margin-right:9px}.header[_ngcontent-%COMP%]{position:relative;top:30px;margin-bottom:15px;margin-left:20px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:"raleway-thin",serif;font-size:36px;font-weight:200;margin:0}']}),e})();var _=i(33013),D=i(81606),E=i(38583),k=i(83473);function U(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",10),g.NdJ("click",function(){return g.CHM(e),g.oxw(2).toggleFilter()}),g.ALo(1,"translate"),g.qZA()}2&e&&g.s9C("pTooltip",g.lcZ(1,1,"msg.showFilters"))}function G(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",11),g.NdJ("click",function(){return g.CHM(e),g.oxw(2).toggleFilter()}),g.ALo(1,"translate"),g.qZA()}2&e&&g.s9C("pTooltip",g.lcZ(1,1,"msg.showFilters"))}function B(e,t){if(1&e&&(g.ynx(0),g.YNc(1,U,2,3,"button",8),g.YNc(2,G,2,3,"button",9),g.BQk()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",!1===e.showFilter&&!1===e.haveFilter),g.xp6(1),g.Q6J("ngIf",!1===e.showFilter&&!0===e.haveFilter)}}function Q(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",function(){return g.CHM(e),g.oxw().onDelete()}),g.ALo(1,"translate"),g.qZA()}if(2&e){const e=g.oxw();g.s9C("label",g.lcZ(1,2,"bia.delete")),g.Q6J("disabled",0===e.nbSelectedElements)}}function $(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",13),g.NdJ("click",function(){return g.CHM(e),g.oxw().edit.emit()}),g.ALo(1,"translate"),g.qZA()}if(2&e){const e=g.oxw();g.s9C("label",g.lcZ(1,2,"site.edit")),g.Q6J("disabled",1!==e.nbSelectedElements)}}function H(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",14),g.NdJ("click",function(){return g.CHM(e),g.oxw().onBack()}),g.ALo(1,"translate"),g.qZA()}2&e&&g.s9C("label",g.lcZ(1,1,"bia.back"))}function j(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",15),g.NdJ("click",function(){return g.CHM(e),g.oxw().exportCSV.emit()}),g.qZA()}}function Y(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",16),g.NdJ("click",function(){return g.CHM(e),g.oxw().onCreate()}),g.ALo(1,"translate"),g.qZA()}2&e&&g.s9C("label",g.lcZ(1,1,"bia.add"))}let V=(()=>{class e extends D.l{constructor(){super(...arguments),this.canEdit=!1,this.edit=new g.vpe}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=g.n5z(e)))(i||e)}}(),e.\u0275cmp=g.Xpm({type:e,selectors:[["app-site-table-header"]],inputs:{canEdit:"canEdit"},outputs:{edit:"edit"},features:[g._Bn([_.YP]),g.qOj],decls:13,vars:7,consts:[["fxLayout","row","fxLayoutAlign","space-between",1,"header"],["fxLayout","row","fxLayoutGap","8px","fxLayoutAlign","stretch center"],[4,"ngIf"],["pButton","",3,"disabled","label","click",4,"ngIf"],["pButton","","class","p-button-outlined",3,"disabled","label","click",4,"ngIf"],["pButton","","class","p-button-outlined",3,"label","click",4,"ngIf"],["pButton","","class","p-button-outlined","label","CSV",3,"click",4,"ngIf"],["pButton","",3,"label","click",4,"ngIf"],["type","button","icon","pi pi-filter","class","p-button-outlined flat","pButton","",3,"pTooltip","click",4,"ngIf"],["type","button","icon","pi pi-filter","pButton","",3,"pTooltip","click",4,"ngIf"],["type","button","icon","pi pi-filter","pButton","",1,"p-button-outlined","flat",3,"pTooltip","click"],["type","button","icon","pi pi-filter","pButton","",3,"pTooltip","click"],["pButton","",3,"disabled","label","click"],["pButton","",1,"p-button-outlined",3,"disabled","label","click"],["pButton","",1,"p-button-outlined",3,"label","click"],["pButton","","label","CSV",1,"p-button-outlined",3,"click"],["pButton","",3,"label","click"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.YNc(2,B,3,2,"ng-container",2),g.YNc(3,Q,2,4,"button",3),g.YNc(4,$,2,4,"button",4),g.qZA(),g.TgZ(5,"div",1),g.TgZ(6,"h1"),g._uU(7),g.qZA(),g.qZA(),g.TgZ(8,"div",1),g.YNc(9,H,2,3,"button",5),g.YNc(10,j,1,0,"button",6),g.YNc(11,Y,2,3,"button",7),g.qZA(),g.qZA(),g._UZ(12,"p-confirmDialog")),2&e&&(g.xp6(2),g.Q6J("ngIf",t.showBtnFilter),g.xp6(1),g.Q6J("ngIf",t.canDelete),g.xp6(1),g.Q6J("ngIf",t.canEdit),g.xp6(3),g.Oqu(t.headerTitle),g.xp6(2),g.Q6J("ngIf",t.canBack),g.xp6(1),g.Q6J("ngIf",t.canExportCSV),g.xp6(1),g.Q6J("ngIf",t.canAdd))},directives:[L.xw,L.Wh,L.SQ,E.O5,k.Q,O.Hq,M.u],pipes:[q.X$],styles:['.header[_ngcontent-%COMP%]{margin-bottom:15px;margin-top:15px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:"raleway-thin",serif;font-size:36px;font-weight:200;margin:0;line-height:24px}',""]}),e})();var R=i(76743),W=i(88385),K=i(75319),X=i(45121),ee=i(13928);let te=(()=>{class e{constructor(e){this.formBuilder=e,this.site={},this.save=new g.vpe,this.cancel=new g.vpe,this.initForm()}ngOnChanges(e){e.site&&(this.form.reset(),this.site&&this.form.patchValue(Object.assign({},this.site)))}initForm(){this.form=this.formBuilder.group({id:[this.site.id],title:[this.site.title,P.kI.required]})}onCancel(){this.form.reset(),this.cancel.next()}onSubmit(){if(this.form.valid){const e=this.form.value;e.id=e.id>0?e.id:0,this.save.emit(e),this.form.reset()}}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(P.qu))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-site-form"]],inputs:{site:"site"},outputs:{save:"save",cancel:"cancel"},features:[g.TTD],decls:15,vars:11,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["formControlName","title","type","text","pInputText","","maxlength","255"],[1,"bia-star-mandatory"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-outlined",3,"label","click"]],template:function(e,t){1&e&&(g.TgZ(0,"form",0),g.NdJ("submit",function(){return t.onSubmit()}),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"span",3),g._UZ(4,"input",4),g.TgZ(5,"label"),g.TgZ(6,"span",5),g._uU(7,"*"),g.qZA(),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(10,"div",6),g._UZ(11,"button",7),g.ALo(12,"translate"),g.TgZ(13,"button",8),g.NdJ("click",function(){return t.onCancel()}),g.ALo(14,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Q6J("formGroup",t.form),g.xp6(8),g.Oqu(g.lcZ(9,5,"site.title")),g.xp6(3),g.s9C("label",g.lcZ(12,7,"bia.save")),g.Q6J("disabled",!t.form.valid),g.xp6(2),g.s9C("label",g.lcZ(14,9,"bia.cancel")))},directives:[P._Y,P.JL,L.xw,P.sg,L.Wh,L.yH,P.Fj,P.JJ,P.u,ee.o,P.nD,L.SQ,O.Hq],pipes:[q.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e})();var ie=i(79373);function ne(e,t){1&e&&g._UZ(0,"bia-spinner",3),2&e&&g.Q6J("overlay",!0)}const se=function(){return{minWidth:"50vw"}},oe=function(){return{overflow:"auto"}};let ae=(()=>{class e{constructor(e){this.store=e,this.display=!1,this.sub=new K.w,this.displayChange=new g.vpe}ngOnInit(){this.loading$=this.store.select(v.gc),this.site$=this.store.select(v.WQ),this.sub.add(this.store.select(v.de).subscribe(e=>this.display=e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(e){this.store.dispatch((0,h.Vx)({site:e})),this.close()}onCancelled(){this.close()}close(){this.store.dispatch((0,h.iC)())}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(s.yh))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-site-edit-dialog"]],outputs:{displayChange:"displayChange"},decls:8,vars:20,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"site","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(e,t){1&e&&(g.TgZ(0,"p-dialog",0),g.NdJ("visibleChange",function(e){return t.display=e}),g.TgZ(1,"p-header"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"app-site-form",1),g.NdJ("cancel",function(){return t.onCancelled()})("save",function(e){return t.onSubmitted(e)}),g.ALo(5,"async"),g.qZA(),g.YNc(6,ne,1,1,"bia-spinner",2),g.ALo(7,"async"),g.qZA()),2&e&&(g.Akn(g.DdM(18,se)),g.Q6J("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",g.DdM(19,oe)),g.xp6(2),g.hij(" ",g.lcZ(3,12,"site.edit")," "),g.xp6(2),g.Q6J("site",g.lcZ(5,14,t.site$)),g.xp6(2),g.Q6J("ngIf",g.lcZ(7,16,t.loading$)))},directives:[X.V,_.h4,te,E.O5,ie.O],pipes:[q.X$,E.Ov],styles:[""]}),e})();const re=function(){return{minWidth:"50vw"}},le=function(){return{overflow:"auto"}};let ce=(()=>{class e{constructor(e){this.store=e,this.display=!1,this.sub=new K.w,this.displayChange=new g.vpe}ngOnInit(){this.sub.add(this.store.select(v.HM).subscribe(e=>this.display=e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(e){this.store.dispatch((0,h.Ue)({site:e})),this.close()}onCancelled(){this.site={},this.close()}close(){this.store.dispatch((0,h.fe)())}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(s.yh))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-site-new-dialog"]],outputs:{displayChange:"displayChange"},decls:5,vars:15,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"site","cancel","save"]],template:function(e,t){1&e&&(g.TgZ(0,"p-dialog",0),g.NdJ("visibleChange",function(e){return t.display=e}),g.TgZ(1,"p-header"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"app-site-form",1),g.NdJ("cancel",function(){return t.onCancelled()})("save",function(e){return t.onSubmitted(e)}),g.qZA(),g.qZA()),2&e&&(g.Akn(g.DdM(13,re)),g.Q6J("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",g.DdM(14,le)),g.xp6(2),g.hij(" ",g.lcZ(3,11,"site.add")," "),g.xp6(2),g.Q6J("site",t.site))},directives:[X.V,_.h4,te],pipes:[q.X$],styles:[""]}),e})(),ue=(()=>{class e{constructor(e,t,i,n){this.store=e,this.authService=t,this.router=i,this.route=n,this.flex=!0,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=w.L8,this.pageSize=this.defaultPageSize,this.showFilter=!1,this.haveFilter=!1,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.canManageMembers=!1}ngOnInit(){this.initTableConfiguration(),this.setPermissions(),this.initUsers(),this.initSites(),this.initTotalCount(),this.initLoading()}onCreate(){this.store.dispatch((0,h.xc)())}onEdit(){this.selectedSites&&1===this.selectedSites.length&&(this.store.dispatch((0,h.zD)({id:this.selectedSites[0].id})),this.store.dispatch((0,h.zN)()))}onDelete(){this.selectedSites&&this.store.dispatch((0,h.v)({ids:this.selectedSites.map(e=>e.id)}))}onSelectedElementsChanged(e){this.selectedSites=e}onManageMember(e){e&&e>0&&this.router.navigate(["/sites",e,"members"])}onPageSizeChange(e){this.pageSize=e}onLoadLazy(e){this.lastLazyLoadEvent=e;const t=Object.assign({userId:this.advancedFilter&&this.advancedFilter.userId>0?this.advancedFilter.userId:0},e);this.store.dispatch((0,h.rF)({event:t}))}onSearchUsers(e){this.store.dispatch((0,A.Cq)({filter:e}))}onFilter(e){this.advancedFilter=e,this.haveFilter=this.advancedFilter&&this.advancedFilter.userId>0,this.onLoadLazy(this.lastLazyLoadEvent)}searchGlobalChanged(e){this.globalSearchValue=e}displayedColumnsChanged(e){this.displayedColumns=e}onCloseFilter(){this.showFilter=!1}onOpenFilter(){this.showFilter=!0}onToggleSearch(){this.showColSearch=!this.showColSearch}toSiteListVM(e){return{id:e.id,title:e.title,siteAdmin:e.siteAdmins?e.siteAdmins.map(e=>`${e.userLastName} ${e.userFirstName}`).join(", "):""}}onViewChange(e){this.updateAdvancedFilterByView(e),this.viewPreference=e}updateAdvancedFilterByView(e){let t={},i=!1;if(e&&e!==w.cp){const n=JSON.parse(e);n&&n.advancedFilter&&(t=n.advancedFilter,i=this.advancedFilter&&this.advancedFilter.userId>0)}this.advancedFilter=t,this.haveFilter=i}setPermissions(){this.canEdit=this.authService.hasPermission(Z.y.Site_Update),this.canDelete=this.authService.hasPermission(Z.y.Site_Delete),this.canAdd=this.authService.hasPermission(Z.y.Site_Create),this.canManageMembers=this.authService.hasPermission(Z.y.Member_List_Access)}initTableConfiguration(){this.tableConfiguration={columns:[new x.ML("title","site.title"),Object.assign(new x.ML("siteAdmin","site.admins"),{})]},this.columns=this.tableConfiguration.columns.map(e=>({key:e.field,value:e.header})),this.displayedColumns=this.columns}initLoading(){this.loading$=this.store.select(v.JV)}initTotalCount(){this.totalCount$=this.store.select(v.Gz)}initSites(){this.sites$=this.store.select(v.FN).pipe((0,c.U)(e=>e.map(e=>this.toSiteListVM(e))))}initUsers(){this.userOptions$=this.store.select(F.yp)}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(s.yh),g.Y36(C.e),g.Y36(n.F0),g.Y36(n.gz))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-sites-index"]],hostVars:2,hostBindings:function(e,t){2&e&&g.ekj("bia-flex",t.flex)},decls:15,vars:38,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],[3,"hidden","fxFlexValue","userOptions","searchUsers","filter","closeFilter"],["fxFlex","100"],[3,"headerTitle","haveFilter","showFilter","showBtnFilter","canAdd","canEdit","selectedElements","create","openFilter","delete","edit"],[3,"defaultPageSize","length","columns","columnToDisplays","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canSelectElement","loading","viewPreference","advancedFilter","edit","loadLazy","selectedElementsChanged"]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"div",0),g.TgZ(2,"app-site-filter",1),g.NdJ("searchUsers",function(e){return t.onSearchUsers(e)})("filter",function(e){return t.onFilter(e)})("closeFilter",function(){return t.onCloseFilter()}),g.ALo(3,"async"),g.qZA(),g.TgZ(4,"div",2),g.TgZ(5,"app-site-table-header",3),g.NdJ("create",function(){return t.onCreate()})("openFilter",function(){return t.onOpenFilter()})("delete",function(){return t.onDelete()})("edit",function(){return t.onEdit()}),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"bia-table-controller",4),g.NdJ("displayedColumnsChange",function(e){return t.displayedColumnsChanged(e)})("filter",function(e){return t.searchGlobalChanged(e)})("pageSizeChange",function(e){return t.onPageSizeChange(e)})("toggleSearch",function(){return t.onToggleSearch()})("viewChange",function(e){return t.onViewChange(e)}),g.ALo(8,"async"),g.qZA(),g.TgZ(9,"bia-table",5),g.NdJ("edit",function(e){return t.onManageMember(e)})("loadLazy",function(e){return t.onLoadLazy(e)})("selectedElementsChanged",function(e){return t.onSelectedElementsChanged(e)}),g.ALo(10,"async"),g.ALo(11,"async"),g.ALo(12,"async"),g.qZA(),g.qZA(),g.qZA(),g._UZ(13,"app-site-edit-dialog"),g._UZ(14,"app-site-new-dialog"),g.qZA()),2&e&&(g.xp6(2),g.Q6J("hidden",!t.showFilter)("fxFlexValue",25)("userOptions",g.lcZ(3,26,t.userOptions$)),g.xp6(3),g.Q6J("headerTitle",g.lcZ(6,28,"site.listOf"))("haveFilter",t.haveFilter)("showFilter",t.showFilter)("showBtnFilter",!0)("canAdd",t.canAdd)("canEdit",t.canEdit)("selectedElements",t.selectedSites),g.xp6(2),g.Q6J("defaultPageSize",t.defaultPageSize)("length",g.lcZ(8,30,t.totalCount$))("columns",t.columns)("columnToDisplays",t.displayedColumns),g.xp6(2),g.Q6J("elements",g.lcZ(10,32,t.sites$))("totalRecord",g.lcZ(11,34,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canManageMembers)("canSelectElement",t.canDelete)("loading",g.lcZ(12,36,t.loading$))("viewPreference",t.viewPreference)("advancedFilter",t.advancedFilter))},directives:[L.xw,N,L.yH,V,R.B,W.$,ae,ce],pipes:[E.Ov,q.X$],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),e})();var de=i(84594),pe=i(16249),he=i(49277),fe=i(9716),ge=i(30466),be=i(28049);function me(e,t){1&e&&g._UZ(0,"bia-spinner",1),2&e&&g.Q6J("overlay",!0)}let ve=(()=>{class e{constructor(e,t,i,n){this.store=e,this.route=t,this.siteService=i,this.layoutService=n,this.sub=new K.w}ngOnInit(){this.siteService.currentSiteId=this.route.snapshot.params.siteId,this.sub.add(this.store.select(v.WQ).subscribe(e=>{(null==e?void 0:e.title)&&(this.route.data.pipe((0,be.P)()).subscribe(t=>{t.breadcrumb=e.title}),this.layoutService.refreshBreadcrumb())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(s.yh),g.Y36(n.gz),g.Y36(fe.P),g.Y36(ge.N))},e.\u0275cmp=g.Xpm({type:e,selectors:[["ng-component"]],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(e,t){1&e&&(g._UZ(0,"router-outlet"),g.YNc(1,me,1,1,"bia-spinner",0),g.ALo(2,"async")),2&e&&(g.xp6(1),g.Q6J("ngIf",g.lcZ(2,1,t.siteService.loading$)))},directives:[n.lC,E.O5,ie.O],pipes:[E.Ov],styles:[""]}),e})();var ye=i(62439);const Se=[{path:"",data:{breadcrumb:null,permission:Z.y.Site_List_Access},component:ue,canActivate:[pe.n]},{path:":siteId",data:{breadcrumb:"",canNavigate:!1},component:ve,canActivate:[pe.n],children:[{path:"members",data:{breadcrumb:"app.members",canNavigate:!0,permission:Z.y.Member_List_Access},loadChildren:()=>i.e(883).then(i.bind(i,79883)).then(e=>e.MemberModule)}]},{path:"**",redirectTo:""}];let xe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[de.m,ye.U,he.a,n.Bz.forChild(Se),s.Aw.forFeature("sites",v.ll),o.sQ.forFeature([S])]]}),e})()},41464:function(e,t,i){i.d(t,{FN:function(){return y},WQ:function(){return h},de:function(){return m},HM:function(){return v},yG:function(){return f},gc:function(){return g},JV:function(){return b},Gz:function(){return p},ll:function(){return c}});var n=i(80273),s=i(86710),o=i(99147);const a=(0,n.H)({selectId:e=>e.id,sortComparer:!1}),r=a.getInitialState({totalCount:0,currentSite:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1,displayEditDialog:!1,displayNewDialog:!1}),l=(0,s.Lq)(r,(0,s.on)(o.xc,e=>Object.assign(Object.assign({},e),{displayNewDialog:!0})),(0,s.on)(o.fe,e=>Object.assign(Object.assign({},e),{displayNewDialog:!1})),(0,s.on)(o.zN,e=>Object.assign(Object.assign({},e),{displayEditDialog:!0})),(0,s.on)(o.iC,e=>Object.assign(Object.assign({},e),{displayEditDialog:!1})),(0,s.on)(o.rF,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!0})),(0,s.on)(o.zD,e=>Object.assign(Object.assign({},e),{loadingGet:!0})),(0,s.on)(o.ni,(e,{result:t,event:i})=>{const n=a.setAll(t.data,e);return n.currentSite={},n.totalCount=t.totalCount,n.lastLazyLoadEvent=i,n.loadingGetAll=!1,n}),(0,s.on)(o.T4,(e,{site:t})=>Object.assign(Object.assign({},e),{currentSite:t,loadingGet:!1})),(0,s.on)(o.Rn,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!1,loadingGet:!1})));function c(e,t){return(0,s.UY)({sites:l})(e,t)}const u=(0,s.ZF)("sites"),d=(0,s.P1)(u,e=>e.sites),p=(0,s.P1)(d,e=>e.totalCount),h=(0,s.P1)(d,e=>e.currentSite),f=(0,s.P1)(d,e=>e.lastLazyLoadEvent),g=(0,s.P1)(d,e=>e.loadingGet),b=(0,s.P1)(d,e=>e.loadingGetAll),m=(0,s.P1)(d,e=>e.displayEditDialog),v=(0,s.P1)(d,e=>e.displayNewDialog),{selectAll:y}=a.getSelectors(d)},99147:function(e,t,i){i.d(t,{rF:function(){return s},zD:function(){return o},Ue:function(){return a},Vx:function(){return r},Od:function(){return l},v:function(){return c},ni:function(){return u},T4:function(){return d},Rn:function(){return p},zN:function(){return h},iC:function(){return f},xc:function(){return g},fe:function(){return b}});var n=i(86710);const s=(0,n.PH)("[Sites] Load all by post",(0,n.Ky)()),o=(0,n.PH)("[Sites] Load",(0,n.Ky)()),a=(0,n.PH)("[Sites] Create",(0,n.Ky)()),r=(0,n.PH)("[Sites] Update",(0,n.Ky)()),l=(0,n.PH)("[Sites] Remove",(0,n.Ky)()),c=(0,n.PH)("[Sites] Multi Remove",(0,n.Ky)()),u=(0,n.PH)("[Sites] Load all by post success",(0,n.Ky)()),d=(0,n.PH)("[Sites] Load success",(0,n.Ky)()),p=(0,n.PH)("[Sites] Failure",(0,n.Ky)()),h=(0,n.PH)("[Sites] Open dialog edit"),f=(0,n.PH)("[Sites] Close dialog edit"),g=(0,n.PH)("[Sites] Open dialog new"),b=(0,n.PH)("[Sites] Close dialog new")}}]);
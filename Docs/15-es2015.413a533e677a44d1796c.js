(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{DmGy:function(e,t,s){"use strict";s.r(t),s.d(t,"MemberModule",(function(){return Je}));var i=s("tyNb"),a=s("kt0X"),c=s("snw9"),n=s("LRne"),r=s("wO+i"),l=s("eIep"),o=s("lJxs"),b=s("JIr8"),m=s("bOdf"),d=s("zp1y");const u=Object(a.h)("[Members] Load all by post",Object(a.m)()),h=Object(a.h)("[Members] Load",Object(a.m)()),p=Object(a.h)("[Members] Create",Object(a.m)()),f=Object(a.h)("[Members] Update",Object(a.m)()),g=Object(a.h)("[Members] Remove",Object(a.m)()),O=Object(a.h)("[Members] Multi Remove",Object(a.m)()),S=Object(a.h)("[Members] Save",Object(a.m)()),j=Object(a.h)("[Members] Load all by post success",Object(a.m)()),v=Object(a.h)("[Members] Load success",Object(a.m)()),y=Object(a.h)("[Members] Failure",Object(a.m)()),w=Object(a.h)("[Members] Open dialog edit"),C=Object(a.h)("[Members] Close dialog edit"),M=Object(a.h)("[Members] Open dialog new"),L=Object(a.h)("[Members] Close dialog new");var x=s("EVqC");const T=Object(x.a)({selectId:e=>e.id,sortComparer:!1}),k=T.getInitialState({totalCount:0,currentMember:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1,displayEditDialog:!1,displayNewDialog:!1}),D=Object(a.j)(k,Object(a.l)(M,e=>Object.assign(Object.assign({},e),{displayNewDialog:!0})),Object(a.l)(L,e=>Object.assign(Object.assign({},e),{displayNewDialog:!1})),Object(a.l)(w,e=>Object.assign(Object.assign({},e),{displayEditDialog:!0})),Object(a.l)(C,e=>Object.assign(Object.assign({},e),{displayEditDialog:!1})),Object(a.l)(u,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!0})),Object(a.l)(h,e=>Object.assign(Object.assign({},e),{loadingGet:!0})),Object(a.l)(j,(e,{result:t,event:s})=>{const i=T.setAll(t.data,e);return i.currentMember={},i.totalCount=t.totalCount,i.lastLazyLoadEvent=s,i.loadingGetAll=!1,i}),Object(a.l)(v,(e,{member:t})=>Object.assign(Object.assign({},e),{currentMember:t,loadingGet:!1})),Object(a.l)(y,(e,{})=>Object.assign(Object.assign({},e),{loadingGetAll:!1,loadingGet:!1})));function $(e,t){return Object(a.f)({members:D})(e,t)}const I=Object(a.i)("members"),E=Object(a.k)(I,e=>e.members),N=Object(a.k)(E,e=>e.totalCount),B=Object(a.k)(E,e=>e.currentMember),A=Object(a.k)(E,e=>e.lastLazyLoadEvent),R=Object(a.k)(E,e=>e.loadingGet),z=Object(a.k)(E,e=>e.loadingGetAll),F=Object(a.k)(E,e=>e.displayEditDialog),P=Object(a.k)(E,e=>e.displayNewDialog),{selectAll:G}=T.getSelectors(E);var H=s("dlt+"),J=s("fXoL");let U=(()=>{class e extends H.a{constructor(e){super(e,"members")}getAllBySite(e){return this.http.get(`${H.a.buildRoute("sites")}${e}/members`)}}return e.\u0275fac=function(t){return new(t||e)(J.Xb(J.r))},e.\u0275prov=J.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var V=s("Fx2S");let X=(()=>{class e{constructor(e,t,s,i){this.actions$=e,this.memberDas=t,this.biaMessageService=s,this.store=i,this.loadAllByPost$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(u),Object(r.a)("event"),Object(l.a)(e=>this.memberDas.getListByPost(e).pipe(Object(o.a)(t=>j({result:t,event:e})),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e})))))))),this.load$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(h),Object(r.a)("id"),Object(l.a)(e=>this.memberDas.get(e).pipe(Object(o.a)(e=>v({member:e})),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e})))))))),this.create$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(p),Object(r.a)("member"),Object(m.a)(e=>Object(n.a)(e).pipe(Object(d.a)(this.store.select(A)))),Object(l.a)(([e,t])=>this.memberDas.post(e).pipe(Object(o.a)(()=>(this.biaMessageService.showAddSuccess(),u({event:t}))),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e})))))))),this.update$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(f),Object(r.a)("member"),Object(m.a)(e=>Object(n.a)(e).pipe(Object(d.a)(this.store.select(A)))),Object(l.a)(([e,t])=>this.memberDas.put(e,e.id).pipe(Object(o.a)(()=>(this.biaMessageService.showUpdateSuccess(),u({event:t}))),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e})))))))),this.destroy$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(g),Object(r.a)("id"),Object(m.a)(e=>Object(n.a)(e).pipe(Object(d.a)(this.store.select(A)))),Object(l.a)(([e,t])=>this.memberDas.delete(e).pipe(Object(o.a)(()=>(this.biaMessageService.showDeleteSuccess(),u({event:t}))),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e})))))))),this.multiDestroy$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(O),Object(r.a)("ids"),Object(m.a)(e=>Object(n.a)(e).pipe(Object(d.a)(this.store.select(A)))),Object(l.a)(([e,t])=>this.memberDas.deletes(e).pipe(Object(o.a)(()=>(this.biaMessageService.showDeleteSuccess(),u({event:t}))),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e})))))))),this.save$=Object(c.c)(()=>this.actions$.pipe(Object(c.d)(S),Object(r.a)("members"),Object(m.a)(e=>Object(n.a)(e).pipe(Object(d.a)(this.store.select(A)))),Object(l.a)(([e,t])=>this.memberDas.save(e).pipe(Object(o.a)(()=>(this.biaMessageService.showAddSuccess(),u({event:t}))),Object(b.a)(e=>(this.biaMessageService.showError(),Object(n.a)(y({error:e}))))))))}}return e.\u0275fac=function(t){return new(t||e)(J.Xb(c.a),J.Xb(U),J.Xb(V.a),J.Xb(a.b))},e.\u0275prov=J.Jb({token:e,factory:e.\u0275fac}),e})();var _=s("quSY"),q=s("itXk"),Q=s("Sa1B"),Y=s("VfrA"),K=s("QQar"),W=s("s0Cq"),Z=s("E6Oa"),ee=s("RdrV"),te=s("AYsD"),se=s("Lnda"),ie=s("sYmb"),ae=s("XiUz"),ce=s("ofXK"),ne=s("v8MJ"),re=s("/RsI"),le=s("7zfz"),oe=s("Ifmq"),be=s("3Pt+"),me=s("+07z"),de=s("jIHw");function ue(e,t){if(1&e&&(J.Hc(0),J.ec(1,"translateRoleLabel")),2&e){const e=t.$implicit,s=J.dc();J.Jc(" ",J.gc(1,1,null==e?null:e.value,s.translateService.currentLang)," ")}}function he(e,t){if(1&e&&(J.Hc(0),J.ec(1,"translateRoleLabel")),2&e){const e=t.$implicit,s=J.dc();J.Jc(" ",J.gc(1,1,null==e?null:e.value,s.translateService.currentLang)," ")}}const pe=function(){return{width:"100%"}};let fe=(()=>{class e{constructor(e,t){this.formBuilder=e,this.translateService=t,this.member={},this.save=new J.n,this.cancel=new J.n,this.memberEditFormData={},this.initForm()}ngOnInit(){}ngOnChanges(e){if(this.allRoles&&this.member&&(e.member||e.allRoles)){const e={roles:this.member.roles?this.allRoles.filter(e=>this.member.roles.some(t=>t.roleId===e.id)):[]};this.form.patchValue(Object.assign({},e))}}initForm(){this.form=this.formBuilder.group({roles:[this.memberEditFormData.roles]})}onCancel(){this.form.reset(),this.cancel.next()}onSubmit(){this.form.valid&&(this.updateMember(),this.form.reset())}updateMember(){const e=Object.assign({},this.member),t=this.form.value.roles;e.roles.forEach(e=>{t.some(t=>t.id===e.roleId)||(e.dtoState=oe.a.Deleted)}),t.forEach(t=>{e.roles.some(e=>e.roleId===t.id)||e.roles.push({id:0,memberId:e.id,roleId:t.id,dtoState:oe.a.Added})}),this.save.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(J.Nb(be.b),J.Nb(ie.d))},e.\u0275cmp=J.Hb({type:e,selectors:[["app-member-edit-form"]],inputs:{member:"member",allRoles:"allRoles"},outputs:{save:"save",cancel:"cancel"},features:[J.zb],decls:14,vars:16,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center",1,"app-field-container"],["fxFlex","90"],["formControlName","roles","multiple","multiple","checkbox","checkbox","optionLabel","labelEn",3,"options","showToggleAll"],["pTemplate","item"],["pTemplate","selectedItem"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"ui-button-secondary",3,"label","click"]],template:function(e,t){1&e&&(J.Tb(0,"form",0),J.bc("submit",(function(){return t.onSubmit()})),J.Tb(1,"div",1),J.Tb(2,"div",2),J.Tb(3,"label"),J.Hc(4),J.ec(5,"translate"),J.Sb(),J.Tb(6,"p-listbox",3),J.Fc(7,ue,2,4,"ng-template",4),J.Fc(8,he,2,4,"ng-template",5),J.Sb(),J.Sb(),J.Sb(),J.Tb(9,"div",6),J.Ob(10,"button",7),J.ec(11,"translate"),J.Tb(12,"button",8),J.bc("click",(function(){return t.onCancel()})),J.ec(13,"translate"),J.Sb(),J.Sb(),J.Sb()),2&e&&(J.kc("formGroup",t.form),J.Bb(4),J.Jc("",J.fc(5,9,"member.roles"),":"),J.Bb(2),J.Dc(J.nc(15,pe)),J.kc("options",t.allRoles)("showToggleAll",!1),J.Bb(4),J.lc("label",J.fc(11,11,"bia.save")),J.kc("disabled",!t.form.valid),J.Bb(2),J.lc("label",J.fc(13,13,"bia.cancel")))},directives:[be.p,be.k,ae.d,be.f,ae.c,ae.b,me.a,be.j,be.e,le.e,ae.e,de.b],pipes:[ie.c,te.a],styles:[".app-field-container[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"],changeDetection:0}),e})();var ge=s("y0gQ");function Oe(e,t){if(1&e&&(J.Rb(0),J.Hc(1),J.ec(2,"async"),J.ec(3,"async"),J.Qb()),2&e){const e=J.dc();var s=null;J.Bb(1),J.Kc(" ",null==(s=J.fc(2,2,e.member$))?null:s.userFirstName," ",null==(s=J.fc(3,4,e.member$))?null:s.userLastName,"")}}function Se(e,t){1&e&&J.Ob(0,"bia-spinner",4),2&e&&J.kc("overlay",!0)}const je=function(){return{minWidth:"40vw"}},ve=function(){return{overflow:"auto"}};let ye=(()=>{class e{constructor(e){this.store=e,this.display=!1,this.sub=new _.a,this.displayChange=new J.n}ngOnInit(){this.loading$=this.store.select(R).pipe(),this.allRoles$=this.store.pipe(Object(a.n)(K.a)).pipe(),this.member$=this.store.select(B).pipe(),this.sub.add(this.store.select(F).pipe().subscribe(e=>this.display=e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(e){this.store.dispatch(f({member:e})),this.close()}onCancelled(){this.close()}close(){this.store.dispatch(C())}}return e.\u0275fac=function(t){return new(t||e)(J.Nb(a.b))},e.\u0275cmp=J.Hb({type:e,selectors:[["app-member-edit-dialog"]],outputs:{displayChange:"displayChange"},decls:11,vars:26,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[4,"ngIf"],[3,"member","allRoles","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(e,t){1&e&&(J.Tb(0,"p-dialog",0),J.bc("visibleChange",(function(e){return t.display=e})),J.Tb(1,"p-header"),J.Hc(2),J.ec(3,"translate"),J.Fc(4,Oe,4,6,"ng-container",1),J.ec(5,"async"),J.Sb(),J.Tb(6,"app-member-edit-form",2),J.bc("cancel",(function(){return t.onCancelled()}))("save",(function(e){return t.onSubmitted(e)})),J.ec(7,"async"),J.ec(8,"async"),J.Sb(),J.Fc(9,Se,1,1,"bia-spinner",3),J.ec(10,"async"),J.Sb()),2&e&&(J.Dc(J.nc(24,je)),J.kc("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",J.nc(25,ve)),J.Bb(2),J.Jc(" ",J.fc(3,14,"member.manage")," "),J.Bb(2),J.kc("ngIf",!0!==J.fc(5,16,t.loading$)),J.Bb(2),J.kc("member",J.fc(7,18,t.member$))("allRoles",J.fc(8,20,t.allRoles$)),J.Bb(3),J.kc("ngIf",J.fc(10,22,t.loading$)))},directives:[re.a,le.c,ce.m,fe,ge.a],pipes:[ie.c,ce.b],styles:[""]}),e})();var we=s("jIms"),Ce=s("mCVk"),Me=s("FNYi"),Le=s("V5BG");function xe(e,t){if(1&e&&(J.Hc(0),J.ec(1,"translateRoleLabel")),2&e){const e=t.$implicit,s=J.dc();J.Jc(" ",J.gc(1,1,null==e?null:e.value,s.translateService.currentLang)," ")}}function Te(e,t){if(1&e&&(J.Hc(0),J.ec(1,"translateRoleLabel")),2&e){const e=t.$implicit,s=J.dc();J.Jc(" ",J.gc(1,1,null==e?null:e.value,s.translateService.currentLang)," ")}}const ke=function(){return{width:"100%"}};let De=(()=>{class e{constructor(e,t,s){this.formBuilder=e,this.translateService=t,this.biaMessageService=s,this.searchUsers=new J.n,this.save=new J.n,this.cancel=new J.n,this.memberNewFormData={},this.initForm()}ngOnInit(){}ngOnChanges(e){this.users&&e.users&&(this.users=this.users.sort((e,t)=>e.firstName.localeCompare(t.firstName)))}initForm(){this.form=this.formBuilder.group({users:[this.memberNewFormData.users,be.o.required],roles:[this.memberNewFormData.roles]})}onCancel(){this.form.reset(),this.cancel.next()}onSubmit(){this.form.valid&&(this.createMember(),this.form.reset())}onSearchUsers(e){this.searchUsers.emit(e.query)}onSelect(e){e&&e.siteIds&&e.siteIds.indexOf(this.site.id)>-1&&(this.selecteds.splice(this.selecteds.map(e=>e.id).indexOf(e.id),1),this.biaMessageService.showInfo(this.translateService.instant("biaMsg.userAlreadyAssociatedSite")))}createMember(){const e=new Array;this.form.value.users.forEach(t=>{const s={id:0,userId:t.id,userFirstName:t.firstName,userLastName:t.lastName,userLogin:t.login,siteId:this.site.id,roles:this.rolesToMemberRoles(this.form.value.roles),dtoState:oe.a.Added};e.push(s)}),this.save.emit(e)}rolesToMemberRoles(e){const t=new Array;return e&&e.length>0&&e.forEach(e=>{t.push({id:0,memberId:0,roleId:e.id,dtoState:oe.a.Added})}),t}}return e.\u0275fac=function(t){return new(t||e)(J.Nb(be.b),J.Nb(ie.d),J.Nb(V.a))},e.\u0275cmp=J.Hb({type:e,selectors:[["app-member-new-form"]],inputs:{allRoles:"allRoles",site:"site",users:"users"},outputs:{searchUsers:"searchUsers",save:"save",cancel:"cancel"},features:[J.zb],decls:23,vars:29,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"md-inputfield"],["formControlName","users","placeholder","\xa0","field","displayName",3,"ngModel","multiple","suggestions","size","minLength","inputStyle","ngModelChange","completeMethod","onSelect"],[1,"bia-star-mandatory"],["fxLayout","row","fxLayoutAlign","center",1,"app-field-container"],["fxFlex","90"],["formControlName","roles","multiple","multiple","checkbox","checkbox","optionLabel","label",3,"options","showToggleAll"],["pTemplate","item"],["pTemplate","selectedItem"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"ui-button-secondary",3,"label","click"]],template:function(e,t){1&e&&(J.Tb(0,"form",0),J.bc("submit",(function(){return t.onSubmit()})),J.Tb(1,"div",1),J.Tb(2,"div",2),J.Tb(3,"span",3),J.Tb(4,"p-autoComplete",4),J.bc("ngModelChange",(function(e){return t.selecteds=e}))("completeMethod",(function(e){return t.onSearchUsers(e)}))("onSelect",(function(e){return t.onSelect(e)})),J.Sb(),J.Tb(5,"label"),J.Tb(6,"span",5),J.Hc(7,"*"),J.Sb(),J.Hc(8),J.ec(9,"translate"),J.Sb(),J.Sb(),J.Sb(),J.Sb(),J.Tb(10,"div",6),J.Tb(11,"div",7),J.Tb(12,"label"),J.Hc(13),J.ec(14,"translate"),J.Sb(),J.Tb(15,"p-listbox",8),J.Fc(16,xe,2,4,"ng-template",9),J.Fc(17,Te,2,4,"ng-template",10),J.Sb(),J.Sb(),J.Sb(),J.Tb(18,"div",11),J.Ob(19,"button",12),J.ec(20,"translate"),J.Tb(21,"button",13),J.bc("click",(function(){return t.onCancel()})),J.ec(22,"translate"),J.Sb(),J.Sb(),J.Sb()),2&e&&(J.kc("formGroup",t.form),J.Bb(4),J.Dc(J.nc(26,ke)),J.kc("ngModel",t.selecteds)("multiple",!0)("suggestions",t.users)("size",30)("minLength",2)("inputStyle",J.nc(27,ke)),J.Bb(4),J.Ic(J.fc(9,18,"app.members")),J.Bb(5),J.Jc("",J.fc(14,20,"member.roles"),":"),J.Bb(2),J.Dc(J.nc(28,ke)),J.kc("options",t.allRoles)("showToggleAll",!1),J.Bb(4),J.lc("label",J.fc(20,22,"bia.save")),J.kc("disabled",!t.form.valid),J.Bb(2),J.lc("label",J.fc(22,24,"bia.cancel")))},directives:[be.p,be.k,ae.d,be.f,ae.c,ae.b,Le.a,be.j,be.e,me.a,le.e,ae.e,de.b],pipes:[ie.c,te.a],styles:[".app-field-container[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"],changeDetection:0}),e})();const $e=function(){return{minWidth:"40vw"}},Ie=function(){return{overflow:"auto"}};let Ee=(()=>{class e{constructor(e){this.store=e,this.display=!1,this.sub=new _.a,this.displayChange=new J.n}ngOnInit(){this.allRoles$=this.store.select(K.a).pipe(),this.users$=this.store.select(Ce.a),this.sub.add(this.store.select(P).pipe().subscribe(e=>this.display=e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(e){this.store.dispatch(S({members:e})),this.close()}onCancelled(){this.close()}close(){this.store.dispatch(L())}onSearchUsers(e){this.store.dispatch(Object(Me.b)({filter:e}))}}return e.\u0275fac=function(t){return new(t||e)(J.Nb(a.b))},e.\u0275cmp=J.Hb({type:e,selectors:[["app-member-new-dialog"]],inputs:{site:"site"},outputs:{displayChange:"displayChange"},decls:7,vars:21,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"site","users","allRoles","searchUsers","cancel","save"]],template:function(e,t){1&e&&(J.Tb(0,"p-dialog",0),J.bc("visibleChange",(function(e){return t.display=e})),J.Tb(1,"p-header"),J.Hc(2),J.ec(3,"translate"),J.Sb(),J.Tb(4,"app-member-new-form",1),J.bc("searchUsers",(function(e){return t.onSearchUsers(e)}))("cancel",(function(){return t.onCancelled()}))("save",(function(e){return t.onSubmitted(e)})),J.ec(5,"async"),J.ec(6,"async"),J.Sb(),J.Sb()),2&e&&(J.Dc(J.nc(19,$e)),J.kc("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",J.nc(20,Ie)),J.Bb(2),J.Jc(" ",J.fc(3,13,"member.add")," "),J.Bb(2),J.kc("site",t.site)("users",J.fc(5,15,t.users$))("allRoles",J.fc(6,17,t.allRoles$)))},directives:[re.a,le.c,De],pipes:[ie.c,ce.b],styles:[""]}),e})();function Ne(e,t){if(1&e){const e=J.Ub();J.Tb(0,"bia-table-header",6),J.bc("create",(function(){return J.yc(e),J.dc().onCreate()}))("delete",(function(){return J.yc(e),J.dc().onDelete()})),J.ec(1,"translate"),J.Sb()}if(2&e){const e=J.dc();J.kc("headerTitle",J.fc(1,4,"member.listOfSiteMembers")+(null==e.siteService.currentSite?null:e.siteService.currentSite.title))("canAdd",e.canAdd)("canBack",!0)("selectedElements",e.selectedMembers)}}function Be(e,t){if(1&e&&J.Ob(0,"app-member-new-dialog",7),2&e){const e=J.dc();J.kc("site",e.siteService.currentSite)}}let Ae=(()=>{class e{constructor(e,t,s,i,a){this.store=e,this.authService=t,this.translate=s,this.translateRoleLabelPipe=i,this.siteService=a,this.flex=!0,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=W.b,this.pageSize=this.defaultPageSize,this.sub=new _.a,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.columns=[],this.displayedColumns=this.columns}ngOnInit(){this.initTableConfiguration(),this.setPermissions(),this.initRoles(),this.initMembers(),this.initTotalCount(),this.initLoading()}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onCreate(){this.store.dispatch(M())}onEdit(e){this.store.dispatch(h({id:e})),this.store.dispatch(w())}onDelete(){this.selectedMembers&&this.store.dispatch(O({ids:this.selectedMembers.map(e=>e.id)}))}onSelectedElementsChanged(e){this.selectedMembers=e}onPageSizeChange(e){this.pageSize=e}onLoadLazy(e){if(this.siteService.currentSiteId>0){const t=Object.assign({siteId:+this.siteService.currentSiteId},e);this.store.dispatch(u({event:t}))}}searchGlobalChanged(e){this.globalSearchValue=e}displayedColumnsChanged(e){this.displayedColumns=e}onToggleSearch(){this.showColSearch=!this.showColSearch}toMemberListVM(e,t){return{member:e,id:e.id,displayName:`${e.userLastName} ${e.userFirstName}`,roles:e.roles?this.roles.filter(t=>e.roles.some(e=>e.roleId===t.id)).map(e=>this.translateRoleLabelPipe.transform(e,t)).join(", "):""}}setPermissions(){this.canEdit=this.authService.hasPermission(ee.a.Member_Update),this.canDelete=this.authService.hasPermission(ee.a.Member_Delete),this.canAdd=this.authService.hasPermission(ee.a.Member_Save)}initTableConfiguration(){this.tableConfiguration={columns:[Object.assign(new Y.b("displayName","member.user"),{isSortable:!1,isSearchable:!1}),Object.assign(new Y.b("roles","member.rolesForSite"),{isSortable:!1,isSearchable:!1})]},this.columns=this.tableConfiguration.columns.map(e=>({key:e.field,value:e.header})),this.displayedColumns=[...this.columns]}initLoading(){this.loading$=this.store.select(z)}initTotalCount(){this.totalCount$=this.store.select(N)}initMembers(){this.members$=Object(q.a)([this.store.select(G),Object(n.a)(this.translate.currentLang)]).pipe(Object(o.a)(e=>e[0].map(t=>this.toMemberListVM(t,e[1]))))}initRoles(){this.sub.add(this.store.select(K.a).subscribe(e=>this.roles=e))}}return e.\u0275fac=function(t){return new(t||e)(J.Nb(a.b),J.Nb(Z.a),J.Nb(ie.d),J.Nb(te.a),J.Nb(se.a))},e.\u0275cmp=J.Hb({type:e,selectors:[["app-members-index"]],viewQuery:function(e,t){var s;1&e&&J.Lc(Q.a,!0),2&e&&J.wc(s=J.cc())&&(t.memberListComponent=s.first)},hostVars:2,hostBindings:function(e,t){2&e&&J.Fb("bia-flex",t.flex)},decls:13,vars:28,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canBack","selectedElements","create","delete",4,"ngIf"],[3,"defaultPageSize","length","columns","columnToDisplays","displayedColumnsChange","filter","pageSizeChange","toggleSearch"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canSelectElement","loading","edit","loadLazy","selectedElementsChanged"],[3,"site",4,"ngIf"],[3,"headerTitle","canAdd","canBack","selectedElements","create","delete"],[3,"site"]],template:function(e,t){1&e&&(J.Tb(0,"div",0),J.Tb(1,"div",1),J.Fc(2,Ne,2,6,"bia-table-header",2),J.ec(3,"async"),J.Tb(4,"bia-table-controller",3),J.bc("displayedColumnsChange",(function(e){return t.displayedColumnsChanged(e)}))("filter",(function(e){return t.searchGlobalChanged(e)}))("pageSizeChange",(function(e){return t.onPageSizeChange(e)}))("toggleSearch",(function(){return t.onToggleSearch()})),J.ec(5,"async"),J.Sb(),J.Tb(6,"bia-table",4),J.bc("edit",(function(e){return t.onEdit(e)}))("loadLazy",(function(e){return t.onLoadLazy(e)}))("selectedElementsChanged",(function(e){return t.onSelectedElementsChanged(e)})),J.ec(7,"async"),J.ec(8,"async"),J.ec(9,"async"),J.Sb(),J.Sb(),J.Sb(),J.Ob(10,"app-member-edit-dialog"),J.Fc(11,Be,1,1,"app-member-new-dialog",5),J.ec(12,"async")),2&e&&(J.Bb(2),J.kc("ngIf",!1===J.fc(3,16,t.siteService.loading$)),J.Bb(2),J.kc("defaultPageSize",t.defaultPageSize)("length",J.fc(5,18,t.totalCount$))("columns",t.columns)("columnToDisplays",t.displayedColumns),J.Bb(2),J.kc("elements",J.fc(7,20,t.members$))("totalRecord",J.fc(8,22,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canEdit)("canSelectElement",t.canDelete)("loading",J.fc(9,24,t.loading$)),J.Bb(5),J.kc("ngIf",!1===J.fc(12,26,t.siteService.loading$)))},directives:[ae.d,ae.b,ce.m,ne.a,Q.a,ye,we.a,Ee],pipes:[ce.b,ie.c],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),e})();var Re=s("PCNd"),ze=s("CaOr"),Fe=s("oulN"),Pe=s("+dww"),Ge=s("vuVG");const He=[{path:"",data:{breadcrumb:null,permission:ee.a.Member_List_Access},component:Ae,canActivate:[Pe.a]},{path:"**",redirectTo:""}];let Je=(()=>{class e{}return e.\u0275mod=J.Lb({type:e}),e.\u0275inj=J.Kb({factory:function(t){return new(t||e)},imports:[[Re.a,Fe.a,ze.a,Ge.a,i.f.forChild(He),a.d.forFeature("members",$),c.b.forFeature([X])]]}),e})()}}]);
!function(){"use strict";function e(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(u){a=!0,r=u}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}(self.webpackChunkbiademo=self.webpackChunkbiademo||[]).push([[408],{16249:function(e,t,n){n.d(t,{n:function(){return c}});var i,r=n(8340),o=n(92340),s=n(68307),a=n(37716),c=((i=function(){function e(t){u(this,e),this.authService=t}return l(e,[{key:"canActivate",value:function(e,t){return this.authService.hasPermissionObs(e.data.permission).pipe((0,s.b)(function(e){!0!==e&&(window.location.href=o.N.urlErrorPage+"?num=403")}))}}]),e}()).\u0275fac=function(e){return new(e||i)(a.LFG(r.e))},i.\u0275prov=a.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},9716:function(e,t,n){n.d(t,{P:function(){return c}});var i=n(75319),r=n(41464),o=n(99147),s=n(37716),a=n(86710),c=function(){var e=function(){function e(t){u(this,e),this.store=t,this.sub=new i.w,this.InitSub(),this.loading$=this.store.select(r.gc)}return l(e,[{key:"currentSite",get:function(){var e;return(null===(e=this._currentSite)||void 0===e?void 0:e.id)===this._currentSiteId?this._currentSite:null}},{key:"currentSiteId",get:function(){return this._currentSiteId},set:function(e){this._currentSiteId=Number(e),this.store.dispatch((0,o.zD)({id:e}))}},{key:"InitSub",value:function(){var e=this;this.sub=new i.w,this.sub.add(this.store.select(r.WQ).subscribe(function(t){t&&(e._currentSite=t)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.LFG(a.yh))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},17408:function(e,n,r){r.r(n),r.d(n,{SiteModule:function(){return ke}});var s,a=r(2694),c=r(86710),f=r(91601),d=r(25917),p=r(92996),h=r(43190),g=r(88002),v=r(5304),b=r(94612),y=r(57057),m=r(99147),w=r(74147),S=r(37716),x=((s=function(e){i(n,e);var t=o(n);function n(e){return u(this,n),t.call(this,e,"sites")}return n}(w.Z)).\u0275fac=function(e){return new(e||s)(S.LFG(S.zs3))},s.\u0275prov=S.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s),C=function(){var e=function(e){i(n,e);var t=o(n);function n(e){return u(this,n),t.call(this,e,"sites")}return n}(w.Z);return e.\u0275fac=function(t){return new(t||e)(S.LFG(S.zs3))},e.\u0275prov=S.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Z=r(41464),A=r(42),F=function(){var e=function e(n,i,r,o,s){var a=this;u(this,e),this.actions$=n,this.siteDas=i,this.siteInfoDas=r,this.biaMessageService=o,this.store=s,this.loadAllByPost$=(0,f.GW)(function(){return a.actions$.pipe((0,f.l4)(m.rF),(0,p.j)("event"),(0,h.w)(function(e){return a.siteInfoDas.getListByPost(e).pipe((0,g.U)(function(t){return(0,m.ni)({result:t,event:e})}),(0,v.K)(function(e){return a.biaMessageService.showError(),(0,d.of)((0,m.Rn)({error:e}))}))}))}),this.load$=(0,f.GW)(function(){return a.actions$.pipe((0,f.l4)(m.zD),(0,p.j)("id"),(0,h.w)(function(e){return a.siteDas.get(e).pipe((0,g.U)(function(e){return(0,m.T4)({site:e})}),(0,v.K)(function(e){return a.biaMessageService.showError(),(0,d.of)((0,m.Rn)({error:e}))}))}))}),this.create$=(0,f.GW)(function(){return a.actions$.pipe((0,f.l4)(m.Ue),(0,p.j)("site"),(0,b.b)(function(e){return(0,d.of)(e).pipe((0,y.M)(a.store.select(Z.yG)))}),(0,h.w)(function(e){var n=t(e,2),i=n[0],r=n[1];return a.siteDas.post(i).pipe((0,g.U)(function(){return a.biaMessageService.showAddSuccess(),(0,m.rF)({event:r})}),(0,v.K)(function(e){return a.biaMessageService.showError(),(0,d.of)((0,m.Rn)({error:e}))}))}))}),this.update$=(0,f.GW)(function(){return a.actions$.pipe((0,f.l4)(m.Vx),(0,p.j)("site"),(0,b.b)(function(e){return(0,d.of)(e).pipe((0,y.M)(a.store.select(Z.yG)))}),(0,h.w)(function(e){var n=t(e,2),i=n[0],r=n[1];return a.siteDas.put(i,i.id).pipe((0,g.U)(function(){return a.biaMessageService.showUpdateSuccess(),(0,m.rF)({event:r})}),(0,v.K)(function(e){return a.biaMessageService.showError(),(0,d.of)((0,m.Rn)({error:e}))}))}))}),this.destroy$=(0,f.GW)(function(){return a.actions$.pipe((0,f.l4)(m.Od),(0,p.j)("id"),(0,b.b)(function(e){return(0,d.of)(e).pipe((0,y.M)(a.store.select(Z.yG)))}),(0,h.w)(function(e){var n=t(e,2),i=n[0],r=n[1];return a.siteDas.delete(i).pipe((0,g.U)(function(){return a.biaMessageService.showDeleteSuccess(),(0,m.rF)({event:r})}),(0,v.K)(function(e){return a.biaMessageService.showError(),(0,d.of)((0,m.Rn)({error:e}))}))}))}),this.multiDestroy$=(0,f.GW)(function(){return a.actions$.pipe((0,f.l4)(m.v),(0,p.j)("ids"),(0,b.b)(function(e){return(0,d.of)(e).pipe((0,y.M)(a.store.select(Z.yG)))}),(0,h.w)(function(e){var n=t(e,2),i=n[0],r=n[1];return a.siteDas.deletes(i).pipe((0,g.U)(function(){return a.biaMessageService.showDeleteSuccess(),(0,m.rF)({event:r})}),(0,v.K)(function(e){return a.biaMessageService.showError(),(0,d.of)((0,m.Rn)({error:e}))}))}))})};return e.\u0275fac=function(t){return new(t||e)(S.LFG(f.eX),S.LFG(x),S.LFG(C),S.LFG(A.X),S.LFG(c.yh))},e.\u0275prov=S.Yz7({token:e,factory:e.\u0275fac}),e}(),k=r(79090),O=r(40136),L=r(8340),M=r(29206),T=r(71585),P=r(43590),q=r(35618),_=r(4207),J=r(99287),E=r(96516),z=r(3679),I=r(81780),D=["template"],N=function(){return{width:"100%"}};function U(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"div",1),S.TgZ(1,"button",2),S.NdJ("click",function(){return S.CHM(n),S.oxw().onClose()}),S.ALo(2,"translate"),S.qZA(),S.TgZ(3,"div",3),S.TgZ(4,"h1"),S._uU(5),S.ALo(6,"translate"),S.qZA(),S.qZA(),S.TgZ(7,"div",4),S.TgZ(8,"div",5),S.TgZ(9,"span",6),S.TgZ(10,"p-autoComplete",7),S.NdJ("ngModelChange",function(e){return S.CHM(n),S.oxw().userSelected=e})("completeMethod",function(e){return S.CHM(n),S.oxw().onSearchUsers(e)}),S.qZA(),S.TgZ(11,"label"),S._uU(12),S.ALo(13,"translate"),S.qZA(),S.qZA(),S.qZA(),S.qZA(),S.TgZ(14,"div",8),S.TgZ(15,"button",9),S.NdJ("click",function(){return S.CHM(n),S.oxw().onReset()}),S.ALo(16,"translate"),S.qZA(),S.TgZ(17,"button",10),S.NdJ("click",function(){return S.CHM(n),S.oxw().onFilter()}),S.ALo(18,"translate"),S.qZA(),S.qZA(),S.qZA()}if(2&e){var i=S.oxw();S.s9C("fxFlex",i.fxFlexValue),S.Q6J("hidden",i.hidden),S.xp6(1),S.s9C("pTooltip",S.lcZ(2,15,"msg.showFilters")),S.xp6(4),S.Oqu(S.lcZ(6,17,"bia.filters")),S.xp6(5),S.Akn(S.DdM(25,N)),S.Q6J("multiple",!1)("ngModel",i.userSelected)("suggestions",i.userOptions)("size",30)("minLength",2)("inputStyle",S.DdM(26,N)),S.xp6(2),S.Oqu(S.lcZ(13,19,"site.selectUser")),S.xp6(3),S.s9C("label",S.lcZ(16,21,"bia.reset")),S.xp6(2),S.s9C("label",S.lcZ(18,23,"bia.filter"))}}var j=function(){var e=function(){function e(t){u(this,e),this.viewContainerRef=t,this.hidden=!1,this.closeFilter=new S.vpe,this.searchUsers=new S.vpe,this.filter=new S.vpe}return l(e,[{key:"ngOnInit",value:function(){this.viewContainerRef.createEmbeddedView(this.template)}},{key:"onClose",value:function(){this.closeFilter.emit()}},{key:"onReset",value:function(){this.userSelected={},this.onFilter()}},{key:"onFilter",value:function(){this.filter.emit({userId:this.userSelected?this.userSelected.id:0})}},{key:"onSearchUsers",value:function(e){this.searchUsers.emit(e.query)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.Y36(S.s_b))},e.\u0275cmp=S.Xpm({type:e,selectors:[["app-site-filter"]],viewQuery:function(e,t){var n;(1&e&&S.Gf(D,7),2&e)&&(S.iGM(n=S.CRH())&&(t.template=n.first))},inputs:{fxFlexValue:"fxFlexValue",userOptions:"userOptions",hidden:"hidden"},outputs:{closeFilter:"closeFilter",searchUsers:"searchUsers",filter:"filter"},decls:2,vars:0,consts:[["template",""],[1,"app-search-filter",3,"hidden","fxFlex"],["type","button","icon","pi pi-times","pButton","",1,"p-button-rounded","p-button-text","flat",3,"pTooltip","click"],["fxLayout","row","fxLayoutAlign","stretch center",1,"header"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-filter-container"],[1,"p-float-label"],["field","display",3,"multiple","ngModel","suggestions","size","minLength","inputStyle","ngModelChange","completeMethod"],["fxLayout","row","fxLayoutAlign","space-around"],["pButton","","fxFlex","33",1,"p-button-outlined",3,"label","click"],["pButton","","fxFlex","33",3,"label","click"]],template:function(e,t){1&e&&S.YNc(0,U,19,27,"ng-template",null,0,S.W1O)},directives:[q.yH,_.Hq,J.u,q.xw,q.Wh,E.Qc,z.JJ,z.On],pipes:[I.X$],styles:['h3[_ngcontent-%COMP%]{margin-bottom:0}.app-filter-container[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.app-search-filter[_ngcontent-%COMP%]{margin:-15px 35px -15px -35px}.app-search-filter[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{position:absolute}.pi[_ngcontent-%COMP%]   pi-clear[_ngcontent-%COMP%]{margin-left:12px;margin-right:9px}.header[_ngcontent-%COMP%]{position:relative;top:30px;margin-bottom:15px;margin-left:20px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:"raleway-thin",serif;font-size:36px;font-weight:200;margin:0}']}),e}(),G=r(33013),B=r(81606),Q=r(38583),$=r(83473);function H(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",10),S.NdJ("click",function(){return S.CHM(n),S.oxw(2).toggleFilter()}),S.ALo(1,"translate"),S.qZA()}2&e&&S.s9C("pTooltip",S.lcZ(1,1,"msg.showFilters"))}function Y(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",11),S.NdJ("click",function(){return S.CHM(n),S.oxw(2).toggleFilter()}),S.ALo(1,"translate"),S.qZA()}2&e&&S.s9C("pTooltip",S.lcZ(1,1,"msg.showFilters"))}function V(e,t){if(1&e&&(S.ynx(0),S.YNc(1,H,2,3,"button",8),S.YNc(2,Y,2,3,"button",9),S.BQk()),2&e){var n=S.oxw();S.xp6(1),S.Q6J("ngIf",!1===n.showFilter&&!1===n.haveFilter),S.xp6(1),S.Q6J("ngIf",!1===n.showFilter&&!0===n.haveFilter)}}function R(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",12),S.NdJ("click",function(){return S.CHM(n),S.oxw().onDelete()}),S.ALo(1,"translate"),S.qZA()}if(2&e){var i=S.oxw();S.s9C("label",S.lcZ(1,2,"bia.delete")),S.Q6J("disabled",0===i.nbSelectedElements)}}function W(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",13),S.NdJ("click",function(){return S.CHM(n),S.oxw().edit.emit()}),S.ALo(1,"translate"),S.qZA()}if(2&e){var i=S.oxw();S.s9C("label",S.lcZ(1,2,"site.edit")),S.Q6J("disabled",1!==i.nbSelectedElements)}}function K(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",14),S.NdJ("click",function(){return S.CHM(n),S.oxw().onBack()}),S.ALo(1,"translate"),S.qZA()}2&e&&S.s9C("label",S.lcZ(1,1,"bia.back"))}function X(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",15),S.NdJ("click",function(){return S.CHM(n),S.oxw().exportCSV.emit()}),S.qZA()}}function ee(e,t){if(1&e){var n=S.EpF();S.TgZ(0,"button",16),S.NdJ("click",function(){return S.CHM(n),S.oxw().onCreate()}),S.ALo(1,"translate"),S.qZA()}2&e&&S.s9C("label",S.lcZ(1,1,"bia.add"))}var te=function(){var e,t=function(e){i(n,e);var t=o(n);function n(){var e;return u(this,n),(e=t.apply(this,arguments)).canEdit=!1,e.edit=new S.vpe,e}return n}(B.l);return t.\u0275fac=function(n){return(e||(e=S.n5z(t)))(n||t)},t.\u0275cmp=S.Xpm({type:t,selectors:[["app-site-table-header"]],inputs:{canEdit:"canEdit"},outputs:{edit:"edit"},features:[S._Bn([G.YP]),S.qOj],decls:13,vars:7,consts:[["fxLayout","row","fxLayoutAlign","space-between",1,"header"],["fxLayout","row","fxLayoutGap","8px","fxLayoutAlign","stretch center"],[4,"ngIf"],["pButton","",3,"disabled","label","click",4,"ngIf"],["pButton","","class","p-button-outlined",3,"disabled","label","click",4,"ngIf"],["pButton","","class","p-button-outlined",3,"label","click",4,"ngIf"],["pButton","","class","p-button-outlined","label","CSV",3,"click",4,"ngIf"],["pButton","",3,"label","click",4,"ngIf"],["type","button","icon","pi pi-filter","class","p-button-outlined flat","pButton","",3,"pTooltip","click",4,"ngIf"],["type","button","icon","pi pi-filter","pButton","",3,"pTooltip","click",4,"ngIf"],["type","button","icon","pi pi-filter","pButton","",1,"p-button-outlined","flat",3,"pTooltip","click"],["type","button","icon","pi pi-filter","pButton","",3,"pTooltip","click"],["pButton","",3,"disabled","label","click"],["pButton","",1,"p-button-outlined",3,"disabled","label","click"],["pButton","",1,"p-button-outlined",3,"label","click"],["pButton","","label","CSV",1,"p-button-outlined",3,"click"],["pButton","",3,"label","click"]],template:function(e,t){1&e&&(S.TgZ(0,"div",0),S.TgZ(1,"div",1),S.YNc(2,V,3,2,"ng-container",2),S.YNc(3,R,2,4,"button",3),S.YNc(4,W,2,4,"button",4),S.qZA(),S.TgZ(5,"div",1),S.TgZ(6,"h1"),S._uU(7),S.qZA(),S.qZA(),S.TgZ(8,"div",1),S.YNc(9,K,2,3,"button",5),S.YNc(10,X,1,0,"button",6),S.YNc(11,ee,2,3,"button",7),S.qZA(),S.qZA(),S._UZ(12,"p-confirmDialog")),2&e&&(S.xp6(2),S.Q6J("ngIf",t.showBtnFilter),S.xp6(1),S.Q6J("ngIf",t.canDelete),S.xp6(1),S.Q6J("ngIf",t.canEdit),S.xp6(3),S.Oqu(t.headerTitle),S.xp6(2),S.Q6J("ngIf",t.canBack),S.xp6(1),S.Q6J("ngIf",t.canExportCSV),S.xp6(1),S.Q6J("ngIf",t.canAdd))},directives:[q.xw,q.Wh,q.SQ,Q.O5,$.Q,_.Hq,J.u],pipes:[I.X$],styles:['.header[_ngcontent-%COMP%]{margin-bottom:15px;margin-top:15px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:"raleway-thin",serif;font-size:36px;font-weight:200;margin:0;line-height:24px}',""]}),t}(),ne=r(76743),ie=r(88385),re=r(75319),oe=r(45121),se=r(13928),ae=function(){var e=function(){function e(t){u(this,e),this.formBuilder=t,this.site={},this.save=new S.vpe,this.cancel=new S.vpe,this.initForm()}return l(e,[{key:"ngOnChanges",value:function(e){e.site&&(this.form.reset(),this.site&&this.form.patchValue(Object.assign({},this.site)))}},{key:"initForm",value:function(){this.form=this.formBuilder.group({id:[this.site.id],title:[this.site.title,z.kI.required]})}},{key:"onCancel",value:function(){this.form.reset(),this.cancel.next()}},{key:"onSubmit",value:function(){if(this.form.valid){var e=this.form.value;e.id=e.id>0?e.id:0,this.save.emit(e),this.form.reset()}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.Y36(z.qu))},e.\u0275cmp=S.Xpm({type:e,selectors:[["app-site-form"]],inputs:{site:"site"},outputs:{save:"save",cancel:"cancel"},features:[S.TTD],decls:15,vars:11,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["formControlName","title","type","text","pInputText","","maxlength","255"],[1,"bia-star-mandatory"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-outlined",3,"label","click"]],template:function(e,t){1&e&&(S.TgZ(0,"form",0),S.NdJ("submit",function(){return t.onSubmit()}),S.TgZ(1,"div",1),S.TgZ(2,"div",2),S.TgZ(3,"span",3),S._UZ(4,"input",4),S.TgZ(5,"label"),S.TgZ(6,"span",5),S._uU(7,"*"),S.qZA(),S._uU(8),S.ALo(9,"translate"),S.qZA(),S.qZA(),S.qZA(),S.qZA(),S.TgZ(10,"div",6),S._UZ(11,"button",7),S.ALo(12,"translate"),S.TgZ(13,"button",8),S.NdJ("click",function(){return t.onCancel()}),S.ALo(14,"translate"),S.qZA(),S.qZA(),S.qZA()),2&e&&(S.Q6J("formGroup",t.form),S.xp6(8),S.Oqu(S.lcZ(9,5,"site.title")),S.xp6(3),S.s9C("label",S.lcZ(12,7,"bia.save")),S.Q6J("disabled",!t.form.valid),S.xp6(2),S.s9C("label",S.lcZ(14,9,"bia.cancel")))},directives:[z._Y,z.JL,q.xw,z.sg,q.Wh,q.yH,z.Fj,z.JJ,z.u,se.o,z.nD,q.SQ,_.Hq],pipes:[I.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e}(),ue=r(79373);function ce(e,t){1&e&&S._UZ(0,"bia-spinner",3),2&e&&S.Q6J("overlay",!0)}var le=function(){return{minWidth:"50vw"}},fe=function(){return{overflow:"auto"}},de=function(){var e=function(){function e(t){u(this,e),this.store=t,this.display=!1,this.sub=new re.w,this.displayChange=new S.vpe}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading$=this.store.select(Z.gc),this.site$=this.store.select(Z.WQ),this.sub.add(this.store.select(Z.de).subscribe(function(t){return e.display=t}))}},{key:"ngOnDestroy",value:function(){this.sub&&this.sub.unsubscribe()}},{key:"onSubmitted",value:function(e){this.store.dispatch((0,m.Vx)({site:e})),this.close()}},{key:"onCancelled",value:function(){this.close()}},{key:"close",value:function(){this.store.dispatch((0,m.iC)())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.Y36(c.yh))},e.\u0275cmp=S.Xpm({type:e,selectors:[["app-site-edit-dialog"]],outputs:{displayChange:"displayChange"},decls:8,vars:20,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"site","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(e,t){1&e&&(S.TgZ(0,"p-dialog",0),S.NdJ("visibleChange",function(e){return t.display=e}),S.TgZ(1,"p-header"),S._uU(2),S.ALo(3,"translate"),S.qZA(),S.TgZ(4,"app-site-form",1),S.NdJ("cancel",function(){return t.onCancelled()})("save",function(e){return t.onSubmitted(e)}),S.ALo(5,"async"),S.qZA(),S.YNc(6,ce,1,1,"bia-spinner",2),S.ALo(7,"async"),S.qZA()),2&e&&(S.Akn(S.DdM(18,le)),S.Q6J("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",S.DdM(19,fe)),S.xp6(2),S.hij(" ",S.lcZ(3,12,"site.edit")," "),S.xp6(2),S.Q6J("site",S.lcZ(5,14,t.site$)),S.xp6(2),S.Q6J("ngIf",S.lcZ(7,16,t.loading$)))},directives:[oe.V,G.h4,ae,Q.O5,ue.O],pipes:[I.X$,Q.Ov],styles:[""]}),e}(),pe=function(){return{minWidth:"50vw"}},he=function(){return{overflow:"auto"}},ge=function(){var e=function(){function e(t){u(this,e),this.store=t,this.display=!1,this.sub=new re.w,this.displayChange=new S.vpe}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.sub.add(this.store.select(Z.HM).subscribe(function(t){return e.display=t}))}},{key:"ngOnDestroy",value:function(){this.sub&&this.sub.unsubscribe()}},{key:"onSubmitted",value:function(e){this.store.dispatch((0,m.Ue)({site:e})),this.close()}},{key:"onCancelled",value:function(){this.site={},this.close()}},{key:"close",value:function(){this.store.dispatch((0,m.fe)())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.Y36(c.yh))},e.\u0275cmp=S.Xpm({type:e,selectors:[["app-site-new-dialog"]],outputs:{displayChange:"displayChange"},decls:5,vars:15,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","contentStyle","visibleChange"],[3,"site","cancel","save"]],template:function(e,t){1&e&&(S.TgZ(0,"p-dialog",0),S.NdJ("visibleChange",function(e){return t.display=e}),S.TgZ(1,"p-header"),S._uU(2),S.ALo(3,"translate"),S.qZA(),S.TgZ(4,"app-site-form",1),S.NdJ("cancel",function(){return t.onCancelled()})("save",function(e){return t.onSubmitted(e)}),S.qZA(),S.qZA()),2&e&&(S.Akn(S.DdM(13,pe)),S.Q6J("focusOnShow",!1)("visible",t.display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("contentStyle",S.DdM(14,he)),S.xp6(2),S.hij(" ",S.lcZ(3,11,"site.add")," "),S.xp6(2),S.Q6J("site",t.site))},directives:[oe.V,G.h4,ae],pipes:[I.X$],styles:[""]}),e}(),ve=function(){var e=function(){function e(t,n,i,r){u(this,e),this.store=t,this.authService=n,this.router=i,this.route=r,this.flex=!0,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=O.L8,this.pageSize=this.defaultPageSize,this.showFilter=!1,this.haveFilter=!1,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.canManageMembers=!1}return l(e,[{key:"ngOnInit",value:function(){this.initTableConfiguration(),this.setPermissions(),this.initUsers(),this.initSites(),this.initTotalCount(),this.initLoading()}},{key:"onCreate",value:function(){this.store.dispatch((0,m.xc)())}},{key:"onEdit",value:function(){this.selectedSites&&1===this.selectedSites.length&&(this.store.dispatch((0,m.zD)({id:this.selectedSites[0].id})),this.store.dispatch((0,m.zN)()))}},{key:"onDelete",value:function(){this.selectedSites&&this.store.dispatch((0,m.v)({ids:this.selectedSites.map(function(e){return e.id})}))}},{key:"onSelectedElementsChanged",value:function(e){this.selectedSites=e}},{key:"onManageMember",value:function(e){e&&e>0&&this.router.navigate(["/sites",e,"members"])}},{key:"onPageSizeChange",value:function(e){this.pageSize=e}},{key:"onLoadLazy",value:function(e){this.lastLazyLoadEvent=e;var t=Object.assign({userId:this.advancedFilter&&this.advancedFilter.userId>0?this.advancedFilter.userId:0},e);this.store.dispatch((0,m.rF)({event:t}))}},{key:"onSearchUsers",value:function(e){this.store.dispatch((0,T.Cq)({filter:e}))}},{key:"onFilter",value:function(e){this.advancedFilter=e,this.haveFilter=this.advancedFilter&&this.advancedFilter.userId>0,this.onLoadLazy(this.lastLazyLoadEvent)}},{key:"searchGlobalChanged",value:function(e){this.globalSearchValue=e}},{key:"displayedColumnsChanged",value:function(e){this.displayedColumns=e}},{key:"onCloseFilter",value:function(){this.showFilter=!1}},{key:"onOpenFilter",value:function(){this.showFilter=!0}},{key:"onToggleSearch",value:function(){this.showColSearch=!this.showColSearch}},{key:"toSiteListVM",value:function(e){return{id:e.id,title:e.title,siteAdmin:e.siteAdmins?e.siteAdmins.map(function(e){return"".concat(e.userLastName," ").concat(e.userFirstName)}).join(", "):""}}},{key:"onViewChange",value:function(e){this.updateAdvancedFilterByView(e),this.viewPreference=e}},{key:"updateAdvancedFilterByView",value:function(e){var t={},n=!1;if(e&&e!==O.cp){var i=JSON.parse(e);i&&i.advancedFilter&&(t=i.advancedFilter,n=this.advancedFilter&&this.advancedFilter.userId>0)}this.advancedFilter=t,this.haveFilter=n}},{key:"setPermissions",value:function(){this.canEdit=this.authService.hasPermission(M.y.Site_Update),this.canDelete=this.authService.hasPermission(M.y.Site_Delete),this.canAdd=this.authService.hasPermission(M.y.Site_Create),this.canManageMembers=this.authService.hasPermission(M.y.Member_List_Access)}},{key:"initTableConfiguration",value:function(){this.tableConfiguration={columns:[new k.ML("title","site.title"),Object.assign(new k.ML("siteAdmin","site.admins"),{})]},this.columns=this.tableConfiguration.columns.map(function(e){return{key:e.field,value:e.header}}),this.displayedColumns=this.columns}},{key:"initLoading",value:function(){this.loading$=this.store.select(Z.JV)}},{key:"initTotalCount",value:function(){this.totalCount$=this.store.select(Z.Gz)}},{key:"initSites",value:function(){var e=this;this.sites$=this.store.select(Z.FN).pipe((0,g.U)(function(t){return t.map(function(t){return e.toSiteListVM(t)})}))}},{key:"initUsers",value:function(){this.userOptions$=this.store.select(P.yp)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.Y36(c.yh),S.Y36(L.e),S.Y36(a.F0),S.Y36(a.gz))},e.\u0275cmp=S.Xpm({type:e,selectors:[["app-sites-index"]],hostVars:2,hostBindings:function(e,t){2&e&&S.ekj("bia-flex",t.flex)},decls:15,vars:38,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],[3,"hidden","fxFlexValue","userOptions","searchUsers","filter","closeFilter"],["fxFlex","100"],[3,"headerTitle","haveFilter","showFilter","showBtnFilter","canAdd","canEdit","selectedElements","create","openFilter","delete","edit"],[3,"defaultPageSize","length","columns","columnToDisplays","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canSelectElement","loading","viewPreference","advancedFilter","edit","loadLazy","selectedElementsChanged"]],template:function(e,t){1&e&&(S.TgZ(0,"div"),S.TgZ(1,"div",0),S.TgZ(2,"app-site-filter",1),S.NdJ("searchUsers",function(e){return t.onSearchUsers(e)})("filter",function(e){return t.onFilter(e)})("closeFilter",function(){return t.onCloseFilter()}),S.ALo(3,"async"),S.qZA(),S.TgZ(4,"div",2),S.TgZ(5,"app-site-table-header",3),S.NdJ("create",function(){return t.onCreate()})("openFilter",function(){return t.onOpenFilter()})("delete",function(){return t.onDelete()})("edit",function(){return t.onEdit()}),S.ALo(6,"translate"),S.qZA(),S.TgZ(7,"bia-table-controller",4),S.NdJ("displayedColumnsChange",function(e){return t.displayedColumnsChanged(e)})("filter",function(e){return t.searchGlobalChanged(e)})("pageSizeChange",function(e){return t.onPageSizeChange(e)})("toggleSearch",function(){return t.onToggleSearch()})("viewChange",function(e){return t.onViewChange(e)}),S.ALo(8,"async"),S.qZA(),S.TgZ(9,"bia-table",5),S.NdJ("edit",function(e){return t.onManageMember(e)})("loadLazy",function(e){return t.onLoadLazy(e)})("selectedElementsChanged",function(e){return t.onSelectedElementsChanged(e)}),S.ALo(10,"async"),S.ALo(11,"async"),S.ALo(12,"async"),S.qZA(),S.qZA(),S.qZA(),S._UZ(13,"app-site-edit-dialog"),S._UZ(14,"app-site-new-dialog"),S.qZA()),2&e&&(S.xp6(2),S.Q6J("hidden",!t.showFilter)("fxFlexValue",25)("userOptions",S.lcZ(3,26,t.userOptions$)),S.xp6(3),S.Q6J("headerTitle",S.lcZ(6,28,"site.listOf"))("haveFilter",t.haveFilter)("showFilter",t.showFilter)("showBtnFilter",!0)("canAdd",t.canAdd)("canEdit",t.canEdit)("selectedElements",t.selectedSites),S.xp6(2),S.Q6J("defaultPageSize",t.defaultPageSize)("length",S.lcZ(8,30,t.totalCount$))("columns",t.columns)("columnToDisplays",t.displayedColumns),S.xp6(2),S.Q6J("elements",S.lcZ(10,32,t.sites$))("totalRecord",S.lcZ(11,34,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canManageMembers)("canSelectElement",t.canDelete)("loading",S.lcZ(12,36,t.loading$))("viewPreference",t.viewPreference)("advancedFilter",t.advancedFilter))},directives:[q.xw,j,q.yH,te,ne.B,ie.$,de,ge],pipes:[Q.Ov,I.X$],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),e}(),be=r(84594),ye=r(16249),me=r(49277),we=r(9716),Se=r(30466),xe=r(28049);function Ce(e,t){1&e&&S._UZ(0,"bia-spinner",1),2&e&&S.Q6J("overlay",!0)}var Ze=function(){var e=function(){function e(t,n,i,r){u(this,e),this.store=t,this.route=n,this.siteService=i,this.layoutService=r,this.sub=new re.w}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.siteService.currentSiteId=this.route.snapshot.params.siteId,this.sub.add(this.store.select(Z.WQ).subscribe(function(t){(null==t?void 0:t.title)&&(e.route.data.pipe((0,xe.P)()).subscribe(function(e){e.breadcrumb=t.title}),e.layoutService.refreshBreadcrumb())}))}},{key:"ngOnDestroy",value:function(){this.sub&&this.sub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.Y36(c.yh),S.Y36(a.gz),S.Y36(we.P),S.Y36(Se.N))},e.\u0275cmp=S.Xpm({type:e,selectors:[["ng-component"]],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(e,t){1&e&&(S._UZ(0,"router-outlet"),S.YNc(1,Ce,1,1,"bia-spinner",0),S.ALo(2,"async")),2&e&&(S.xp6(1),S.Q6J("ngIf",S.lcZ(2,1,t.siteService.loading$)))},directives:[a.lC,Q.O5,ue.O],pipes:[Q.Ov],styles:[""]}),e}(),Ae=r(62439),Fe=[{path:"",data:{breadcrumb:null,permission:M.y.Site_List_Access},component:ve,canActivate:[ye.n]},{path:":siteId",data:{breadcrumb:"",canNavigate:!1},component:Ze,canActivate:[ye.n],children:[{path:"members",data:{breadcrumb:"app.members",canNavigate:!0,permission:M.y.Member_List_Access},loadChildren:function(){return r.e(883).then(r.bind(r,79883)).then(function(e){return e.MemberModule})}}]},{path:"**",redirectTo:""}],ke=function(){var e=function e(){u(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.oAB({type:e}),e.\u0275inj=S.cJS({imports:[[be.m,Ae.U,me.a,a.Bz.forChild(Fe),c.Aw.forFeature("sites",Z.ll),f.sQ.forFeature([F])]]}),e}()},41464:function(t,n,i){i.d(n,{FN:function(){return w},WQ:function(){return h},de:function(){return y},HM:function(){return m},yG:function(){return g},gc:function(){return v},JV:function(){return b},Gz:function(){return p},ll:function(){return l}});var r=i(80273),o=i(86710),s=i(99147),a=(0,r.H)({selectId:function(e){return e.id},sortComparer:!1}),u=a.getInitialState({totalCount:0,currentSite:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1,displayEditDialog:!1,displayNewDialog:!1}),c=(0,o.Lq)(u,(0,o.on)(s.xc,function(e){return Object.assign(Object.assign({},e),{displayNewDialog:!0})}),(0,o.on)(s.fe,function(e){return Object.assign(Object.assign({},e),{displayNewDialog:!1})}),(0,o.on)(s.zN,function(e){return Object.assign(Object.assign({},e),{displayEditDialog:!0})}),(0,o.on)(s.iC,function(e){return Object.assign(Object.assign({},e),{displayEditDialog:!1})}),(0,o.on)(s.rF,function(t,n){return e(n),Object.assign(Object.assign({},t),{loadingGetAll:!0})}),(0,o.on)(s.zD,function(e){return Object.assign(Object.assign({},e),{loadingGet:!0})}),(0,o.on)(s.ni,function(e,t){var n=t.result,i=t.event,r=a.setAll(n.data,e);return r.currentSite={},r.totalCount=n.totalCount,r.lastLazyLoadEvent=i,r.loadingGetAll=!1,r}),(0,o.on)(s.T4,function(e,t){var n=t.site;return Object.assign(Object.assign({},e),{currentSite:n,loadingGet:!1})}),(0,o.on)(s.Rn,function(t,n){return e(n),Object.assign(Object.assign({},t),{loadingGetAll:!1,loadingGet:!1})}));function l(e,t){return(0,o.UY)({sites:c})(e,t)}var f=(0,o.ZF)("sites"),d=(0,o.P1)(f,function(e){return e.sites}),p=(0,o.P1)(d,function(e){return e.totalCount}),h=(0,o.P1)(d,function(e){return e.currentSite}),g=(0,o.P1)(d,function(e){return e.lastLazyLoadEvent}),v=(0,o.P1)(d,function(e){return e.loadingGet}),b=(0,o.P1)(d,function(e){return e.loadingGetAll}),y=(0,o.P1)(d,function(e){return e.displayEditDialog}),m=(0,o.P1)(d,function(e){return e.displayNewDialog}),w=a.getSelectors(d).selectAll},99147:function(e,t,n){n.d(t,{rF:function(){return r},zD:function(){return o},Ue:function(){return s},Vx:function(){return a},Od:function(){return u},v:function(){return c},ni:function(){return l},T4:function(){return f},Rn:function(){return d},zN:function(){return p},iC:function(){return h},xc:function(){return g},fe:function(){return v}});var i=n(86710),r=(0,i.PH)("[Sites] Load all by post",(0,i.Ky)()),o=(0,i.PH)("[Sites] Load",(0,i.Ky)()),s=(0,i.PH)("[Sites] Create",(0,i.Ky)()),a=(0,i.PH)("[Sites] Update",(0,i.Ky)()),u=(0,i.PH)("[Sites] Remove",(0,i.Ky)()),c=(0,i.PH)("[Sites] Multi Remove",(0,i.Ky)()),l=(0,i.PH)("[Sites] Load all by post success",(0,i.Ky)()),f=(0,i.PH)("[Sites] Load success",(0,i.Ky)()),d=(0,i.PH)("[Sites] Failure",(0,i.Ky)()),p=(0,i.PH)("[Sites] Open dialog edit"),h=(0,i.PH)("[Sites] Close dialog edit"),g=(0,i.PH)("[Sites] Open dialog new"),v=(0,i.PH)("[Sites] Close dialog new")}}])}();
<div [formGroup]="form">
  @if (field.specificInput === true) {
    <ng-container
      *ngTemplateOutlet="
        specificInputTemplate;
        context: { field: field, form: form }
      "></ng-container>
  }
  @if (field.specificInput !== true) {
    @switch (field.type) {
      @case ('OneToMany') {
        <p-select
          #select
          class="bia-table-input-select"
          placeholder="&nbsp;"
          [formControlName]="field.field"
          [options]="getOptionDto(field.field)"
          optionLabel="display"
          dataKey="id"
          showClear="true"
          [autofocus]="focusByDefault"
          (onChange)="onChange()"
          appendTo="body"
          [editable]="field.isEditableChoice"
          scrollHeight="50vh"
          (mousedown)="onMouseDown(select, $event)"></p-select>
      }
      @case ('ManyToMany') {
        <p-multiSelect
          #multiselect
          class="bia-table-input-multiselect"
          placeholder="&nbsp;"
          [formControlName]="field.field"
          [options]="getOptionDto(field.field)"
          optionLabel="display"
          datakey="id"
          [autofocus]="focusByDefault"
          (onChange)="onChange()"
          (onPanelShow)="onComplexInput(true)"
          (onPanelHide)="onPanelHide(multiselect)"
          appendTo="body"
          scrollHeight="50vh"
          (mousedown)="onMouseDown(multiselect, $event)"></p-multiSelect>
      }
      @case ('Boolean') {
        <div class="flex">
          <p-checkbox
            #checkbox
            class="bia-table-input-checkbox"
            [binary]="true"
            [formControlName]="field.field"
            [autofocus]="focusByDefault"
            (onChange)="onChange()"
            (mousedown)="onMouseDown(checkbox, $event)"></p-checkbox>
          @if (field.isRequired) {
            <span class="bia-star-mandatory">*</span>
          }
        </div>
      }
      @case ('Number') {
        @if (
          getDisplayNumberFormat(field.displayFormat);
          as displayNumberFormat
        ) {
          <p-inputNumber
            #inputnumber
            class="bia-table-input-number"
            [formControlName]="field.field"
            (onInput)="onChange()"
            [mode]="displayNumberFormat.mode"
            [currency]="displayNumberFormat.currency"
            [minFractionDigits]="displayNumberFormat.minFractionDigits"
            [maxFractionDigits]="displayNumberFormat.maxFractionDigits"
            [min]="displayNumberFormat.min"
            [max]="displayNumberFormat.max"
            [locale]="displayNumberFormat.autoLocale || 'en-US'"
            [autofocus]="focusByDefault"
            (mousedown)="onMouseDown(inputnumber, $event)" />
        }
      }
      @case ('Date') {
        <p-date-picker
          #datepicker
          class="bia-table-input-date"
          biaLocale
          [formControlName]="field.field"
          placeholder="&nbsp;"
          [showButtonBar]="true"
          (onShow)="onComplexInput(true)"
          (onSelect)="onChange()"
          (onClearClick)="onChange()"
          (onClose)="onComplexInput(false)"
          appendTo="body"
          (onInput)="onChange()"
          [inputStyle]="{ width: '100%' }"
          [dateFormat]="
            getDisplayDateFormat(field.displayFormat)?.autoPrimeDateFormat ??
            'yy-mm-dd'
          "
          [autofocus]="focusByDefault"
          [view]="
            getDateView(
              getDisplayDateFormat(field.displayFormat)?.autoPrimeDateFormat ??
                'yy-mm-dd'
            )
          "
          (mousedown)="onMouseDown(datepicker, $event)"></p-date-picker>
      }
      @case ('Time') {
        <p-date-picker
          #datepicker
          class="bia-table-input-time"
          biaLocale
          [formControlName]="field.field"
          placeholder="&nbsp;"
          (onShow)="onComplexInput(true)"
          (onSelect)="onChange()"
          (onClearClick)="onChange()"
          (onClose)="onComplexInput(false)"
          appendTo="body"
          (onInput)="onChange()"
          [inputStyle]="{ width: '100%' }"
          [showTime]="true"
          [timeOnly]="true"
          [dateFormat]="
            getDisplayDateFormat(field.displayFormat)?.autoPrimeDateFormat ??
            'yy-mm-dd'
          "
          [hourFormat]="'24'"
          [autofocus]="focusByDefault"
          (mousedown)="onMouseDown(datepicker, $event)"></p-date-picker>
        <!-- [hourFormat]="field.displayFormat.autoHourFormat?field.displayFormat.autoHourFormat:24" not work for 12 (PrimeNG 13)-->
      }
      @case ('TimeOnly') {
        <p-date-picker
          #datepicker
          class="bia-table-input-timeonly"
          biaLocale
          [formControlName]="field.field"
          placeholder="&nbsp;"
          (onShow)="onComplexInput(true)"
          (onSelect)="onChange()"
          (onClearClick)="onChange()"
          (onClose)="onComplexInput(false)"
          appendTo="body"
          (onInput)="onChange()"
          [inputStyle]="{ width: '100%' }"
          [showTime]="true"
          dataType="string"
          [timeOnly]="true"
          [hourFormat]="'24'"
          [autofocus]="focusByDefault"
          (mousedown)="onMouseDown(datepicker, $event)"></p-date-picker>
        <!-- [hourFormat]="field.displayFormat.autoHourFormat?field.displayFormat.autoHourFormat:24" not work for 12 (PrimeNG 13)-->
      }
      @case ('TimeSecOnly') {
        <p-date-picker
          #datepicker
          class="bia-table-input-timeseconly"
          biaLocale
          [formControlName]="field.field"
          placeholder="&nbsp;"
          (onShow)="onComplexInput(true)"
          (onSelect)="onChange()"
          (onInput)="onChange()"
          (onClearClick)="onChange()"
          (onClose)="onComplexInput(false)"
          appendTo="body"
          [inputStyle]="{ width: '100%' }"
          [showTime]="true"
          showSeconds="true"
          dataType="string"
          [timeOnly]="true"
          [hourFormat]="'24'"
          [autofocus]="focusByDefault"
          (mousedown)="onMouseDown(datepicker, $event)"></p-date-picker>
        <!-- [hourFormat]="field.displayFormat.autoHourFormat?field.displayFormat.autoHourFormat:24" not work for 12 (PrimeNG 13)-->
      }
      @case ('DateTime') {
        <p-date-picker
          #datepicker
          class="bia-table-input-datetime"
          biaLocale
          [formControlName]="field.field.toString()"
          placeholder="&nbsp;"
          [showButtonBar]="true"
          (onShow)="onComplexInput(true)"
          (onSelect)="onChange()"
          (onClearClick)="onChange()"
          (onClose)="onComplexInput(false)"
          appendTo="body"
          (onInput)="onChange()"
          [inputStyle]="{ width: '100%' }"
          [showTime]="true"
          [dateFormat]="
            getDisplayDateFormat(field.displayFormat)?.autoPrimeDateFormat ??
            'yy-mm-dd'
          "
          [hourFormat]="
            getDisplayDateFormat(
              field.displayFormat
            )?.autoHourFormat?.toString() ?? '24'
          "
          [autofocus]="focusByDefault"
          [showSeconds]="
            showSeconds(
              getDisplayDateFormat(field.displayFormat)?.autoFormatDate ?? ''
            )
          "
          [hideOnDateTimeSelect]="false"
          (mousedown)="onMouseDown(datepicker, $event)"></p-date-picker>
      }
      @default {
        <input
          #input
          class="bia-table-input"
          pInputText
          type="text"
          [maxlength]="field.maxlength"
          [formControlName]="field.field.toString()"
          [pAutoFocus]="focusByDefault"
          (change)="onChange()"
          (mousedown)="onMouseDown(input, $event)" />
      }
    }
  }
  @if (field.isRequired && field.type !== 'Boolean') {
    <span class="bia-star-mandatory">*</span>
  }
</div>

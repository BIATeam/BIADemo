@if (field.isSearchable === true) {
  <p-floatlabel variant="on">
    <div class="flex flex-row">
      <div class="app-field-container flex-1" style="max-width: 18px">
        @if (!isArraySimple(field) && showColumnFilter) {
          @if (options) {
            <p-columnFilter
              [field]="field.field"
              matchMode="in"
              display="menu"
              [showMatchModes]="false"
              [showOperator]="field.type === propType.OneToMany ? false : true"
              [showAddButton]="field.type === propType.OneToMany ? false : true"
              [maxConstraints]="field.maxConstraints">
              <ng-template
                pTemplate="filter"
                let-value
                let-filterConstraint="filterConstraint"
                let-filter="filterCallback">
                <p-multiSelect
                  #ms
                  [options]="options"
                  optionLabel="display"
                  [optionValue]="field.filterWithDisplay ? 'display' : 'id'"
                  [(ngModel)]="filterConstraint.value"
                  (onChange)="onMultiSelectChange(filterConstraint)">
                  <ng-template let-option pTemplate="item">
                    <div class="inline-block vertical-align-middle">
                      <span class="ml-1 mt-1">{{ option.display }}</span>
                    </div>
                  </ng-template>
                  <ng-template #footer>
                    <div class="p-2 flex justify-content-between gap-5">
                      <p-button
                        [label]="'bia.close' | translate"
                        size="small"
                        variant="outlined"
                        (onClick)="ms.hide()">
                      </p-button>
                      <p-button
                        [label]="'primeng.apply' | translate"
                        size="small"
                        (onClick)="filter(filterConstraint.value); ms.hide()">
                      </p-button>
                    </div>
                  </ng-template>
                </p-multiSelect>
              </ng-template>
            </p-columnFilter>
          } @else {
            <p-columnFilter
              [type]="columnFilterType"
              [locale]="getDisplayNumberFormat(field.displayFormat)?.autoLocale"
              [minFractionDigits]="
                getDisplayNumberFormat(field.displayFormat)?.minFractionDigits
              "
              [maxFractionDigits]="
                getDisplayNumberFormat(field.displayFormat)?.maxFractionDigits
              "
              [currency]="
                getDisplayNumberFormat(field.displayFormat)?.mode === 'currency'
                  ? getDisplayNumberFormat(field.displayFormat)?.currency
                  : undefined
              "
              [currencyDisplay]="
                getDisplayNumberFormat(field.displayFormat)?.currencyDisplay
              "
              [matchModeOptions]="matchModeOptions"
              [field]="field.field"
              display="menu"
              [hideOnClear]="true"
              [maxConstraints]="field.maxConstraints">
              <ng-template
                pTemplate="filter"
                let-filterConstraint="filterConstraint"
                let-filterTemplate="filterTemplate"
                let-minFractionDigits="minFractionDigits"
                let-maxFractionDigits="maxFractionDigits"
                let-prefix="prefix"
                let-suffix="suffix"
                let-locale="locale"
                let-localeMatcher="localeMatcher"
                let-currency="currency"
                let-currencyDisplay="currencyDisplay"
                let-useGrouping="useGrouping">
                @if (
                  columnFilterType === 'date' &&
                  filterConstraint?.matchMode !== 'empty' &&
                  filterConstraint?.matchMode !== 'notEmpty' &&
                  filterConstraint?.matchMode !== 'today' &&
                  filterConstraint?.matchMode !== 'beforeToday' &&
                  filterConstraint?.matchMode !== 'afterToday'
                ) {
                  <p-date-picker
                    [ngModel]="filterConstraint?.value"
                    (ngModelChange)="
                      filterConstraint.value = $event
                    "></p-date-picker>
                } @else if (columnFilterType === 'boolean') {
                  <p-checkbox
                    [binary]="true"
                    [indeterminate]="filterConstraint?.value === null"
                    [ngModel]="filterConstraint?.value"
                    (ngModelChange)="
                      filterConstraint.value = $event
                    "></p-checkbox>
                } @else if (
                  filterConstraint?.matchMode !== 'empty' &&
                  filterConstraint?.matchMode !== 'notEmpty' &&
                  filterConstraint?.matchMode !== 'today' &&
                  filterConstraint?.matchMode !== 'beforeToday' &&
                  filterConstraint?.matchMode !== 'afterToday'
                ) {
                  <p-columnFilterFormElement
                    [type]="columnFilterType"
                    [field]="field.field"
                    [filterConstraint]="filterConstraint"
                    [filterTemplate]="filterTemplate"
                    [minFractionDigits]="minFractionDigits"
                    [maxFractionDigits]="maxFractionDigits"
                    [prefix]="prefix"
                    [suffix]="suffix"
                    [locale]="locale"
                    [localeMatcher]="localeMatcher"
                    [currency]="currency"
                    [currencyDisplay]="currencyDisplay"
                    [useGrouping]="useGrouping"></p-columnFilterFormElement>
                }
              </ng-template>
            </p-columnFilter>
          }
        }
      </div>
      <div class="app-field-container flex-1 flex align-items-center">
        @if (isArrayFilter(field); as filterArray) {
          <bia-table-filter-recap
            [filterArray]="filterArray"
            [columnFilterType]="columnFilterType"
            [field]="field"
            [options]="options"></bia-table-filter-recap>
        }
        @if (!isArrayFilter(field) && columnFilterType !== 'boolean') {
          @if (columnFilterType !== 'boolean') {
            <input
              pInputText
              class="input-search"
              type="{{ field.type === propType.Number ? 'number' : 'text' }}"
              placeholder="{{
                field.searchPlaceholder !== undefined
                  ? field.searchPlaceholder
                  : field.isDate === true
                    ? ('bia.dateIso8601' | translate)
                    : ''
              }}"
              (input)="setSimpleFilter($event.target, field)"
              [value]="isSimpleFilter(table.filters[field.field])?.value ?? ''"
              [ngClass]="{
                'p-state-filled':
                  isSimpleFilter(table.filters[field.field])?.value !== '',
              }" />
          }
        }
      </div>
    </div>
  </p-floatlabel>
}

<div>
  <div>
    <bia-table-header
      [headerTitle]="'plane.listOf' | translate"
      [canAdd]="canAdd && !useCalcMode"
      [canDelete]="canDelete"
      [canExportCSV]="true"
      (create)="onCreate()"
      (exportCSV)="onExportCSV()"
      (delete)="onDelete()"
    [selectedElements]="selectedPlanes"></bia-table-header>
    <bia-table-controller
      [defaultPageSize]="defaultPageSize"
      [columns]="columns"
      [columnToDisplays]="displayedColumns"
      (displayedColumnsChange)="displayedColumnsChanged($event)"
      (filter)="searchGlobalChanged($event)"
      (clearFilters)="onClearFilters()"
      (toggleSearch)="onToggleSearch()"
      (viewChange)="onViewChange($event)"
      [tableStateKey]="tableStateKey"
      [tableState]="tableState"
      [useViewTeamWithTypeId]="useViewTeamWithTypeId"
    [hasColumnFilter]="hasColumnFilter"></bia-table-controller>
    @if (!useCalcMode) {
      <bia-table
        [elements]="(planes$ | async) ?? []"
        [totalRecord]="(totalCount$ | async) ?? 0"
        [columnToDisplays]="displayedColumns"
        [pageSize]="pageSize"
        (pageSizeChange)="onPageSizeChange($event)"
        [configuration]="tableConfiguration"
        [(showColSearch)]="showColSearch"
        [globalSearchValue]="globalSearchValue"
        [canClickRow]="canEdit"
        [canSelectElement]="canDelete"
        [loading]="(loading$ | async) ?? false"
        (clickRowId)="onEdit($event)"
        (loadLazy)="onLoadLazy($event)"
        [viewPreference]="viewPreference"
        [tableStateKey]="tableStateKey"
        (selectedElementsChanged)="onSelectedElementsChanged($event)"
        [sortFieldValue]="sortFieldValue"
      (stateSave)="onStateSave($event)"></bia-table>
    }
    @if (useCalcMode) {
      <app-plane-table
        [elements]="(planes$ | async) ?? []"
        [dictOptionDtos]="(planeOptionsService.dictOptionDtos$ | async) ?? []"
        [totalRecord]="(totalCount$ | async) ?? 0"
        [columnToDisplays]="displayedColumns"
        [pageSize]="pageSize"
        (pageSizeChange)="onPageSizeChange($event)"
        [configuration]="tableConfiguration"
        [(showColSearch)]="showColSearch"
        [globalSearchValue]="globalSearchValue"
        [canEdit]="canEdit"
        [canAdd]="canAdd"
        [canSelectElement]="canDelete"
        [loading]="(loading$ | async) ?? false"
        (loadLazy)="onLoadLazy($event)"
        [viewPreference]="viewPreference"
        [tableStateKey]="tableStateKey"
        (selectedElementsChanged)="onSelectedElementsChanged($event)"
        [sortFieldValue]="sortFieldValue"
        (stateSave)="onStateSave($event)"
      (save)="onSave($event)"></app-plane-table>
    }
  </div>
</div>
